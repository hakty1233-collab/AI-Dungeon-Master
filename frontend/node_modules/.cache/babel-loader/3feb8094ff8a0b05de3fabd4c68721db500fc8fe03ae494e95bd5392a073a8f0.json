{"ast":null,"code":"import { create } from \"zustand\";\nexport const useCampaignStore = create(set => ({\n  campaign: null,\n  party: [],\n  lastResponse: \"\",\n  voiceMode: true,\n  micListening: false,\n  // Set campaign and normalize history\n  setCampaign: campaign => {\n    var _campaign$history, _campaign$history$sli;\n    return set({\n      campaign: {\n        ...campaign,\n        history: (campaign.history || []).map((entry, idx) => ({\n          role: entry.role || \"DM\",\n          content: entry.content || entry.narration || `DM message #${idx + 1}`\n        }))\n      },\n      party: campaign.party || [],\n      lastResponse: ((_campaign$history = campaign.history) === null || _campaign$history === void 0 ? void 0 : (_campaign$history$sli = _campaign$history.slice(-1)[0]) === null || _campaign$history$sli === void 0 ? void 0 : _campaign$history$sli.content) || \"The adventure begins...\"\n    });\n  },\n  // Update campaign with DM response\n  updateFromDM: ({\n    aiResponse,\n    campaignState\n  }) => set({\n    campaign: {\n      ...campaignState,\n      history: (campaignState.history || []).map((entry, idx) => ({\n        role: entry.role || \"DM\",\n        content: entry.content || entry.narration || `DM message #${idx + 1}`\n      }))\n    },\n    lastResponse: aiResponse,\n    party: campaignState.party || []\n  }),\n  toggleMic: () => set(state => ({\n    micListening: !state.micListening\n  })),\n  toggleVoice: () => set(state => ({\n    voiceMode: !state.voiceMode\n  }))\n}));","map":{"version":3,"names":["create","useCampaignStore","set","campaign","party","lastResponse","voiceMode","micListening","setCampaign","_campaign$history","_campaign$history$sli","history","map","entry","idx","role","content","narration","slice","updateFromDM","aiResponse","campaignState","toggleMic","state","toggleVoice"],"sources":["C:/Users/Hakty/Desktop/AI-Dungeon-Master/frontend/src/state/campaignStore.js"],"sourcesContent":["import { create } from \"zustand\";\n\nexport const useCampaignStore = create((set) => ({\n  campaign: null,\n  party: [],\n  lastResponse: \"\",\n  voiceMode: true,\n  micListening: false,\n\n  // Set campaign and normalize history\n  setCampaign: (campaign) =>\n    set({\n      campaign: {\n        ...campaign,\n        history: (campaign.history || []).map((entry, idx) => ({\n          role: entry.role || \"DM\",\n          content: entry.content || entry.narration || `DM message #${idx + 1}`,\n        })),\n      },\n      party: campaign.party || [],\n      lastResponse:\n        (campaign.history?.slice(-1)[0]?.content) || \"The adventure begins...\",\n    }),\n\n  // Update campaign with DM response\n  updateFromDM: ({ aiResponse, campaignState }) =>\n    set({\n      campaign: {\n        ...campaignState,\n        history: (campaignState.history || []).map((entry, idx) => ({\n          role: entry.role || \"DM\",\n          content: entry.content || entry.narration || `DM message #${idx + 1}`,\n        })),\n      },\n      lastResponse: aiResponse,\n      party: campaignState.party || [],\n    }),\n\n  toggleMic: () => set((state) => ({ micListening: !state.micListening })),\n  toggleVoice: () => set((state) => ({ voiceMode: !state.voiceMode })),\n}));\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,SAAS;AAEhC,OAAO,MAAMC,gBAAgB,GAAGD,MAAM,CAAEE,GAAG,KAAM;EAC/CC,QAAQ,EAAE,IAAI;EACdC,KAAK,EAAE,EAAE;EACTC,YAAY,EAAE,EAAE;EAChBC,SAAS,EAAE,IAAI;EACfC,YAAY,EAAE,KAAK;EAEnB;EACAC,WAAW,EAAGL,QAAQ;IAAA,IAAAM,iBAAA,EAAAC,qBAAA;IAAA,OACpBR,GAAG,CAAC;MACFC,QAAQ,EAAE;QACR,GAAGA,QAAQ;QACXQ,OAAO,EAAE,CAACR,QAAQ,CAACQ,OAAO,IAAI,EAAE,EAAEC,GAAG,CAAC,CAACC,KAAK,EAAEC,GAAG,MAAM;UACrDC,IAAI,EAAEF,KAAK,CAACE,IAAI,IAAI,IAAI;UACxBC,OAAO,EAAEH,KAAK,CAACG,OAAO,IAAIH,KAAK,CAACI,SAAS,IAAI,eAAeH,GAAG,GAAG,CAAC;QACrE,CAAC,CAAC;MACJ,CAAC;MACDV,KAAK,EAAED,QAAQ,CAACC,KAAK,IAAI,EAAE;MAC3BC,YAAY,EACV,EAAAI,iBAAA,GAACN,QAAQ,CAACQ,OAAO,cAAAF,iBAAA,wBAAAC,qBAAA,GAAhBD,iBAAA,CAAkBS,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,cAAAR,qBAAA,uBAA9BA,qBAAA,CAAgCM,OAAO,KAAK;IACjD,CAAC,CAAC;EAAA;EAEJ;EACAG,YAAY,EAAEA,CAAC;IAAEC,UAAU;IAAEC;EAAc,CAAC,KAC1CnB,GAAG,CAAC;IACFC,QAAQ,EAAE;MACR,GAAGkB,aAAa;MAChBV,OAAO,EAAE,CAACU,aAAa,CAACV,OAAO,IAAI,EAAE,EAAEC,GAAG,CAAC,CAACC,KAAK,EAAEC,GAAG,MAAM;QAC1DC,IAAI,EAAEF,KAAK,CAACE,IAAI,IAAI,IAAI;QACxBC,OAAO,EAAEH,KAAK,CAACG,OAAO,IAAIH,KAAK,CAACI,SAAS,IAAI,eAAeH,GAAG,GAAG,CAAC;MACrE,CAAC,CAAC;IACJ,CAAC;IACDT,YAAY,EAAEe,UAAU;IACxBhB,KAAK,EAAEiB,aAAa,CAACjB,KAAK,IAAI;EAChC,CAAC,CAAC;EAEJkB,SAAS,EAAEA,CAAA,KAAMpB,GAAG,CAAEqB,KAAK,KAAM;IAAEhB,YAAY,EAAE,CAACgB,KAAK,CAAChB;EAAa,CAAC,CAAC,CAAC;EACxEiB,WAAW,EAAEA,CAAA,KAAMtB,GAAG,CAAEqB,KAAK,KAAM;IAAEjB,SAAS,EAAE,CAACiB,KAAK,CAACjB;EAAU,CAAC,CAAC;AACrE,CAAC,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}