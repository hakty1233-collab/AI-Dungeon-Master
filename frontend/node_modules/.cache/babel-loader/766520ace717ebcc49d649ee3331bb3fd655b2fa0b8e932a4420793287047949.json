{"ast":null,"code":"// frontend/src/utils/statusEffectSystem.js\n\n/**\n * D&D 5e Status Effects System\n * Handles conditions, durations, and their mechanical effects\n */\n\n// Status effect types\nexport const STATUS_EFFECTS = {\n  // D&D 5e Conditions\n  BLINDED: 'blinded',\n  CHARMED: 'charmed',\n  DEAFENED: 'deafened',\n  FRIGHTENED: 'frightened',\n  GRAPPLED: 'grappled',\n  INCAPACITATED: 'incapacitated',\n  INVISIBLE: 'invisible',\n  PARALYZED: 'paralyzed',\n  PETRIFIED: 'petrified',\n  POISONED: 'poisoned',\n  PRONE: 'prone',\n  RESTRAINED: 'restrained',\n  STUNNED: 'stunned',\n  UNCONSCIOUS: 'unconscious',\n  EXHAUSTION: 'exhaustion',\n  // Additional common effects\n  CONCENTRATING: 'concentrating',\n  BLESSED: 'blessed',\n  BANED: 'baned',\n  HASTED: 'hasted',\n  SLOWED: 'slowed',\n  RAGING: 'raging',\n  DODGING: 'dodging',\n  HIDING: 'hiding',\n  INVISIBLE: 'invisible',\n  FLYING: 'flying',\n  BURNING: 'burning',\n  BLEEDING: 'bleeding'\n};\n\n// Duration types\nexport const DURATION_TYPES = {\n  INSTANT: 'instant',\n  // Happens immediately, no duration\n  ROUNDS: 'rounds',\n  // Lasts X combat rounds\n  MINUTES: 'minutes',\n  // Lasts X minutes\n  HOURS: 'hours',\n  // Lasts X hours\n  SAVE_ENDS: 'save_ends',\n  // Lasts until successful save\n  CONCENTRATION: 'concentration',\n  // Lasts while concentrating\n  PERMANENT: 'permanent',\n  // Lasts until removed\n  END_OF_TURN: 'end_of_turn',\n  // Ends at end of target's turn\n  START_OF_TURN: 'start_of_turn' // Ends at start of target's turn\n};\n\n// Status effect definitions with mechanical effects\nexport const STATUS_EFFECT_DEFINITIONS = {\n  [STATUS_EFFECTS.BLINDED]: {\n    name: 'Blinded',\n    icon: 'ðŸ‘ï¸',\n    color: '#666',\n    description: 'Cannot see. Attacks have disadvantage. Attacks against have advantage.',\n    effects: {\n      attackDisadvantage: true,\n      attackedWithAdvantage: true,\n      autoFailAbilityChecks: ['sight-based']\n    },\n    canStack: false,\n    removedBy: ['cure', 'dispel', 'lesser_restoration']\n  },\n  [STATUS_EFFECTS.CHARMED]: {\n    name: 'Charmed',\n    icon: 'ðŸ’–',\n    color: '#E91E63',\n    description: 'Cannot attack charmer. Charmer has advantage on social checks.',\n    effects: {\n      cannotAttackCharmer: true,\n      charmerHasAdvantage: true\n    },\n    canStack: false,\n    removedBy: ['damage', 'calm_emotions', 'dispel']\n  },\n  [STATUS_EFFECTS.FRIGHTENED]: {\n    name: 'Frightened',\n    icon: 'ðŸ˜±',\n    color: '#9C27B0',\n    description: 'Disadvantage on ability checks and attacks while source is in sight. Cannot move closer to source.',\n    effects: {\n      attackDisadvantage: true,\n      abilityCheckDisadvantage: true,\n      cannotApproachSource: true\n    },\n    canStack: false,\n    removedBy: ['calm_emotions', 'dispel']\n  },\n  [STATUS_EFFECTS.GRAPPLED]: {\n    name: 'Grappled',\n    icon: 'ðŸ¤¼',\n    color: '#FF9800',\n    description: 'Speed becomes 0. Cannot benefit from speed bonuses.',\n    effects: {\n      speedReduction: 'zero',\n      noSpeedBonus: true\n    },\n    canStack: false,\n    removedBy: ['escape', 'forced_movement', 'incapacitated']\n  },\n  [STATUS_EFFECTS.INCAPACITATED]: {\n    name: 'Incapacitated',\n    icon: 'ðŸ˜µ',\n    color: '#795548',\n    description: 'Cannot take actions or reactions.',\n    effects: {\n      cannotAct: true,\n      cannotReact: true,\n      dropsConcentration: true\n    },\n    canStack: false,\n    removedBy: ['cure', 'time']\n  },\n  [STATUS_EFFECTS.INVISIBLE]: {\n    name: 'Invisible',\n    icon: 'ðŸ‘»',\n    color: '#00BCD4',\n    description: 'Impossible to see without special sense. Attacks have advantage. Attacks against have disadvantage.',\n    effects: {\n      attackAdvantage: true,\n      attackedWithDisadvantage: true,\n      canHide: true\n    },\n    canStack: false,\n    removedBy: ['dispel', 'attack', 'cast_spell']\n  },\n  [STATUS_EFFECTS.PARALYZED]: {\n    name: 'Paralyzed',\n    icon: 'ðŸ¥¶',\n    color: '#2196F3',\n    description: 'Incapacitated. Cannot move or speak. Auto-fail STR/DEX saves. Attacks have advantage. Hits within 5ft are critical.',\n    effects: {\n      cannotAct: true,\n      cannotMove: true,\n      cannotSpeak: true,\n      autoFailSaves: ['STR', 'DEX'],\n      attackedWithAdvantage: true,\n      nearbyHitsAreCritical: true,\n      dropsConcentration: true\n    },\n    canStack: false,\n    removedBy: ['lesser_restoration', 'dispel']\n  },\n  [STATUS_EFFECTS.PETRIFIED]: {\n    name: 'Petrified',\n    icon: 'ðŸ—¿',\n    color: '#607D8B',\n    description: 'Turned to stone. Incapacitated. Cannot move or speak. Resistant to all damage. Immune to poison and disease.',\n    effects: {\n      cannotAct: true,\n      cannotMove: true,\n      cannotSpeak: true,\n      resistAllDamage: true,\n      immunePoison: true,\n      immuneDisease: true,\n      dropsConcentration: true\n    },\n    canStack: false,\n    removedBy: ['greater_restoration', 'wish']\n  },\n  [STATUS_EFFECTS.POISONED]: {\n    name: 'Poisoned',\n    icon: 'ðŸ¤¢',\n    color: '#8BC34A',\n    description: 'Disadvantage on attack rolls and ability checks.',\n    effects: {\n      attackDisadvantage: true,\n      abilityCheckDisadvantage: true\n    },\n    canStack: false,\n    removedBy: ['lesser_restoration', 'antitoxin', 'time']\n  },\n  [STATUS_EFFECTS.PRONE]: {\n    name: 'Prone',\n    icon: 'ðŸ¤•',\n    color: '#795548',\n    description: 'Only crawl or stand up. Disadvantage on attacks. Melee attacks against have advantage, ranged have disadvantage.',\n    effects: {\n      attackDisadvantage: true,\n      meleeAttackedWithAdvantage: true,\n      rangedAttackedWithDisadvantage: true,\n      movementCost: 'half'\n    },\n    canStack: false,\n    removedBy: ['stand_up']\n  },\n  [STATUS_EFFECTS.RESTRAINED]: {\n    name: 'Restrained',\n    icon: 'â›“ï¸',\n    color: '#9E9E9E',\n    description: 'Speed becomes 0. Attacks have disadvantage. Attacks against have advantage. Disadvantage on DEX saves.',\n    effects: {\n      speedReduction: 'zero',\n      attackDisadvantage: true,\n      attackedWithAdvantage: true,\n      savingThrowDisadvantage: ['DEX']\n    },\n    canStack: false,\n    removedBy: ['escape', 'dispel']\n  },\n  [STATUS_EFFECTS.STUNNED]: {\n    name: 'Stunned',\n    icon: 'ðŸ˜µâ€ðŸ’«',\n    color: '#FFC107',\n    description: 'Incapacitated. Cannot move. Can only speak falteringly. Auto-fail STR/DEX saves. Attacks against have advantage.',\n    effects: {\n      cannotAct: true,\n      cannotMove: true,\n      limitedSpeech: true,\n      autoFailSaves: ['STR', 'DEX'],\n      attackedWithAdvantage: true,\n      dropsConcentration: true\n    },\n    canStack: false,\n    removedBy: ['time', 'dispel']\n  },\n  [STATUS_EFFECTS.UNCONSCIOUS]: {\n    name: 'Unconscious',\n    icon: 'ðŸ’¤',\n    color: '#424242',\n    description: 'Incapacitated. Cannot move or speak. Unaware of surroundings. Drop everything. Prone. Auto-fail STR/DEX saves. Attacks have advantage. Hits within 5ft are critical.',\n    effects: {\n      cannotAct: true,\n      cannotMove: true,\n      cannotSpeak: true,\n      unaware: true,\n      dropItems: true,\n      prone: true,\n      autoFailSaves: ['STR', 'DEX'],\n      attackedWithAdvantage: true,\n      nearbyHitsAreCritical: true,\n      dropsConcentration: true\n    },\n    canStack: false,\n    removedBy: ['damage', 'help_action', 'time']\n  },\n  [STATUS_EFFECTS.EXHAUSTION]: {\n    name: 'Exhaustion',\n    icon: 'ðŸ¥±',\n    color: '#616161',\n    description: 'Cumulative levels of exhaustion. Level 1: Disadvantage on ability checks. Level 6: Death.',\n    effects: {\n      stackable: true,\n      maxStacks: 6,\n      level1: 'Disadvantage on ability checks',\n      level2: 'Speed halved',\n      level3: 'Disadvantage on attacks and saves',\n      level4: 'HP maximum halved',\n      level5: 'Speed reduced to 0',\n      level6: 'Death'\n    },\n    canStack: true,\n    removedBy: ['long_rest', 'greater_restoration']\n  },\n  // Spell effects\n  [STATUS_EFFECTS.CONCENTRATING]: {\n    name: 'Concentrating',\n    icon: 'ðŸ§˜',\n    color: '#9C27B0',\n    description: 'Maintaining a spell through concentration. Breaks on damage (DC 10 or half damage CON save) or incapacitation.',\n    effects: {\n      maintainingSpell: true,\n      breaksOnDamage: true,\n      breaksOnIncapacitated: true\n    },\n    canStack: false,\n    removedBy: ['damage', 'incapacitated', 'death']\n  },\n  [STATUS_EFFECTS.BLESSED]: {\n    name: 'Blessed',\n    icon: 'âœ¨',\n    color: '#FFD700',\n    description: 'Add 1d4 to attack rolls and saving throws.',\n    effects: {\n      attackBonus: '1d4',\n      saveBonus: '1d4'\n    },\n    canStack: false,\n    removedBy: ['dispel', 'duration']\n  },\n  [STATUS_EFFECTS.BANED]: {\n    name: 'Baned',\n    icon: 'ðŸ’€',\n    color: '#D32F2F',\n    description: 'Subtract 1d4 from attack rolls and saving throws.',\n    effects: {\n      attackPenalty: '1d4',\n      savePenalty: '1d4'\n    },\n    canStack: false,\n    removedBy: ['dispel', 'duration']\n  },\n  [STATUS_EFFECTS.HASTED]: {\n    name: 'Hasted',\n    icon: 'âš¡',\n    color: '#00BCD4',\n    description: 'Double speed. +2 AC. Advantage on DEX saves. Extra action each turn.',\n    effects: {\n      speedMultiplier: 2,\n      acBonus: 2,\n      savingThrowAdvantage: ['DEX'],\n      extraAction: true\n    },\n    canStack: false,\n    removedBy: ['dispel', 'duration']\n  },\n  [STATUS_EFFECTS.SLOWED]: {\n    name: 'Slowed',\n    icon: 'ðŸŒ',\n    color: '#795548',\n    description: 'Speed halved. -2 AC. Disadvantage on DEX saves. Cannot take reactions.',\n    effects: {\n      speedMultiplier: 0.5,\n      acPenalty: 2,\n      savingThrowDisadvantage: ['DEX'],\n      cannotReact: true\n    },\n    canStack: false,\n    removedBy: ['dispel', 'duration']\n  },\n  [STATUS_EFFECTS.RAGING]: {\n    name: 'Raging',\n    icon: 'ðŸ˜¡',\n    color: '#D32F2F',\n    description: 'Advantage on STR checks/saves. Bonus damage. Resistance to physical damage.',\n    effects: {\n      abilityCheckAdvantage: ['STR'],\n      savingThrowAdvantage: ['STR'],\n      damageBonus: 2,\n      resistPhysicalDamage: true,\n      cannotCastSpells: true\n    },\n    canStack: false,\n    removedBy: ['duration', 'unconscious']\n  },\n  [STATUS_EFFECTS.DODGING]: {\n    name: 'Dodging',\n    icon: 'ðŸ¤º',\n    color: '#4CAF50',\n    description: 'Attacks against you have disadvantage. You have advantage on DEX saves.',\n    effects: {\n      attackedWithDisadvantage: true,\n      savingThrowAdvantage: ['DEX']\n    },\n    canStack: false,\n    removedBy: ['end_of_turn']\n  },\n  [STATUS_EFFECTS.BURNING]: {\n    name: 'Burning',\n    icon: 'ðŸ”¥',\n    color: '#FF5722',\n    description: 'Takes fire damage at the start of each turn.',\n    effects: {\n      damagePerTurn: '1d6',\n      damageType: 'fire'\n    },\n    canStack: true,\n    removedBy: ['water', 'action', 'damage']\n  },\n  [STATUS_EFFECTS.BLEEDING]: {\n    name: 'Bleeding',\n    icon: 'ðŸ©¸',\n    color: '#D32F2F',\n    description: 'Takes damage at the start of each turn. Disadvantage on CON saves.',\n    effects: {\n      damagePerTurn: '1d4',\n      damageType: 'slashing',\n      savingThrowDisadvantage: ['CON']\n    },\n    canStack: true,\n    removedBy: ['healing', 'medicine_check']\n  }\n};\n\n/**\n * Create a status effect instance\n */\nexport function createStatusEffect({\n  type,\n  duration = 1,\n  durationType = DURATION_TYPES.ROUNDS,\n  source = null,\n  saveDC = null,\n  saveAbility = null,\n  spellName = null,\n  stackCount = 1\n}) {\n  const definition = STATUS_EFFECT_DEFINITIONS[type];\n  if (!definition) {\n    console.error('Unknown status effect:', type);\n    return null;\n  }\n  return {\n    id: `${type}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n    type,\n    ...definition,\n    duration,\n    durationType,\n    remainingDuration: duration,\n    source,\n    // Who/what applied this effect\n    saveDC,\n    // DC for saves to end effect\n    saveAbility,\n    // Which ability to save with\n    spellName,\n    // If from a spell\n    stackCount: definition.canStack ? stackCount : 1,\n    appliedAt: Date.now()\n  };\n}\n\n/**\n * Apply status effect to a combatant/character\n */\nexport function applyStatusEffect(character, statusEffect) {\n  const conditions = character.conditions || [];\n\n  // Check if effect already exists\n  const existingIndex = conditions.findIndex(c => c.type === statusEffect.type);\n  if (existingIndex !== -1) {\n    const existing = conditions[existingIndex];\n\n    // If stackable, increase stack count\n    if (existing.canStack) {\n      var _existing$effects;\n      const maxStacks = ((_existing$effects = existing.effects) === null || _existing$effects === void 0 ? void 0 : _existing$effects.maxStacks) || 10;\n      const newStackCount = Math.min(maxStacks, existing.stackCount + statusEffect.stackCount);\n      conditions[existingIndex] = {\n        ...existing,\n        stackCount: newStackCount,\n        remainingDuration: Math.max(existing.remainingDuration, statusEffect.remainingDuration)\n      };\n    } else {\n      // Replace with new effect if duration is longer\n      if (statusEffect.remainingDuration > existing.remainingDuration) {\n        conditions[existingIndex] = statusEffect;\n      }\n    }\n  } else {\n    // Add new effect\n    conditions.push(statusEffect);\n  }\n  return {\n    ...character,\n    conditions: [...conditions]\n  };\n}\n\n/**\n * Remove status effect from character\n */\nexport function removeStatusEffect(character, effectId) {\n  return {\n    ...character,\n    conditions: (character.conditions || []).filter(c => c.id !== effectId)\n  };\n}\n\n/**\n * Remove all status effects of a type\n */\nexport function removeStatusEffectByType(character, effectType) {\n  return {\n    ...character,\n    conditions: (character.conditions || []).filter(c => c.type !== effectType)\n  };\n}\n\n/**\n * Process turn-based status effects (damage, duration reduction)\n */\nexport function processStatusEffectsOnTurnStart(character) {\n  let updatedCharacter = {\n    ...character\n  };\n  const conditions = [...(character.conditions || [])];\n  const toRemove = [];\n  let damageLog = [];\n  conditions.forEach((effect, index) => {\n    var _effect$effects;\n    // Process damage-over-time effects\n    if ((_effect$effects = effect.effects) !== null && _effect$effects !== void 0 && _effect$effects.damagePerTurn) {\n      const damage = rollDamage(effect.effects.damagePerTurn);\n      updatedCharacter = {\n        ...updatedCharacter,\n        hp: Math.max(0, updatedCharacter.hp - damage)\n      };\n      damageLog.push({\n        effect: effect.name,\n        damage,\n        damageType: effect.effects.damageType || 'untyped'\n      });\n    }\n\n    // Reduce duration\n    if (effect.durationType === DURATION_TYPES.ROUNDS || effect.durationType === DURATION_TYPES.START_OF_TURN) {\n      effect.remainingDuration -= 1;\n      if (effect.remainingDuration <= 0) {\n        toRemove.push(effect.id);\n      }\n    }\n  });\n\n  // Remove expired effects\n  updatedCharacter.conditions = conditions.filter(e => !toRemove.includes(e.id));\n  return {\n    character: updatedCharacter,\n    damageLog,\n    removedEffects: toRemove\n  };\n}\n\n/**\n * Check if character has specific status effect\n */\nexport function hasStatusEffect(character, effectType) {\n  return (character.conditions || []).some(c => c.type === effectType);\n}\n\n/**\n * Get all active status effects\n */\nexport function getActiveStatusEffects(character) {\n  return character.conditions || [];\n}\n\n/**\n * Make saving throw to resist or end status effect\n */\nexport function makeStatusSave(character, effect, abilityModifier) {\n  const d20 = Math.floor(Math.random() * 20) + 1;\n  const total = d20 + abilityModifier;\n  const success = total >= effect.saveDC;\n  return {\n    d20,\n    total,\n    success,\n    dc: effect.saveDC,\n    ability: effect.saveAbility\n  };\n}\n\n/**\n * Check concentration when taking damage\n */\nexport function checkConcentration(character, damage) {\n  var _character$abilities, _character$proficienc, _character$proficienc2;\n  const concentrationEffect = (character.conditions || []).find(c => c.type === STATUS_EFFECTS.CONCENTRATING);\n  if (!concentrationEffect) {\n    return {\n      maintainsConcentration: true\n    };\n  }\n\n  // DC is 10 or half damage, whichever is higher\n  const dc = Math.max(10, Math.floor(damage / 2));\n\n  // CON save\n  const conModifier = Math.floor((((_character$abilities = character.abilities) === null || _character$abilities === void 0 ? void 0 : _character$abilities.CON) - 10) / 2) || 0;\n  const profBonus = character.level ? Math.floor((character.level - 1) / 4) + 2 : 2;\n  const isProficient = (_character$proficienc = character.proficiencies) === null || _character$proficienc === void 0 ? void 0 : (_character$proficienc2 = _character$proficienc.savingThrows) === null || _character$proficienc2 === void 0 ? void 0 : _character$proficienc2.includes('CON');\n  const saveModifier = conModifier + (isProficient ? profBonus : 0);\n  const result = makeStatusSave(character, {\n    saveDC: dc,\n    saveAbility: 'CON'\n  }, saveModifier);\n  return {\n    ...result,\n    maintainsConcentration: result.success,\n    concentrationBroken: !result.success,\n    spellName: concentrationEffect.spellName\n  };\n}\n\n/**\n * Helper to roll damage dice\n */\nfunction rollDamage(diceString) {\n  const match = diceString.match(/(\\d+)d(\\d+)([+-]\\d+)?/);\n  if (!match) return parseInt(diceString) || 0;\n  const [, numDice, dieSize, modifier] = match;\n  let total = 0;\n  for (let i = 0; i < parseInt(numDice); i++) {\n    total += Math.floor(Math.random() * parseInt(dieSize)) + 1;\n  }\n  if (modifier) {\n    total += parseInt(modifier);\n  }\n  return total;\n}\n\n/**\n * Get attack roll advantage/disadvantage based on status effects\n */\nexport function getAttackModifiers(attacker, defender) {\n  const attackerEffects = getActiveStatusEffects(attacker);\n  const defenderEffects = getActiveStatusEffects(defender);\n  let advantage = false;\n  let disadvantage = false;\n\n  // Attacker effects\n  attackerEffects.forEach(effect => {\n    var _effect$effects2, _effect$effects3;\n    if ((_effect$effects2 = effect.effects) !== null && _effect$effects2 !== void 0 && _effect$effects2.attackAdvantage) advantage = true;\n    if ((_effect$effects3 = effect.effects) !== null && _effect$effects3 !== void 0 && _effect$effects3.attackDisadvantage) disadvantage = true;\n  });\n\n  // Defender effects\n  defenderEffects.forEach(effect => {\n    var _effect$effects4, _effect$effects5;\n    if ((_effect$effects4 = effect.effects) !== null && _effect$effects4 !== void 0 && _effect$effects4.attackedWithAdvantage) advantage = true;\n    if ((_effect$effects5 = effect.effects) !== null && _effect$effects5 !== void 0 && _effect$effects5.attackedWithDisadvantage) disadvantage = true;\n  });\n\n  // Advantage and disadvantage cancel out\n  if (advantage && disadvantage) {\n    return {\n      advantage: false,\n      disadvantage: false,\n      normal: true\n    };\n  }\n  return {\n    advantage,\n    disadvantage,\n    normal: !advantage && !disadvantage\n  };\n}\n\n/**\n * Apply exhaustion level\n */\nexport function applyExhaustion(character, levels = 1) {\n  const currentExhaustion = character.exhaustion || 0;\n  const newExhaustion = Math.min(6, currentExhaustion + levels);\n  if (newExhaustion >= 6) {\n    return {\n      ...character,\n      exhaustion: 6,\n      hp: 0,\n      isDead: true\n    };\n  }\n  return {\n    ...character,\n    exhaustion: newExhaustion\n  };\n}\n\n/**\n * Remove exhaustion level\n */\nexport function removeExhaustion(character, levels = 1) {\n  const currentExhaustion = character.exhaustion || 0;\n  const newExhaustion = Math.max(0, currentExhaustion - levels);\n  return {\n    ...character,\n    exhaustion: newExhaustion\n  };\n}","map":{"version":3,"names":["STATUS_EFFECTS","BLINDED","CHARMED","DEAFENED","FRIGHTENED","GRAPPLED","INCAPACITATED","INVISIBLE","PARALYZED","PETRIFIED","POISONED","PRONE","RESTRAINED","STUNNED","UNCONSCIOUS","EXHAUSTION","CONCENTRATING","BLESSED","BANED","HASTED","SLOWED","RAGING","DODGING","HIDING","FLYING","BURNING","BLEEDING","DURATION_TYPES","INSTANT","ROUNDS","MINUTES","HOURS","SAVE_ENDS","CONCENTRATION","PERMANENT","END_OF_TURN","START_OF_TURN","STATUS_EFFECT_DEFINITIONS","name","icon","color","description","effects","attackDisadvantage","attackedWithAdvantage","autoFailAbilityChecks","canStack","removedBy","cannotAttackCharmer","charmerHasAdvantage","abilityCheckDisadvantage","cannotApproachSource","speedReduction","noSpeedBonus","cannotAct","cannotReact","dropsConcentration","attackAdvantage","attackedWithDisadvantage","canHide","cannotMove","cannotSpeak","autoFailSaves","nearbyHitsAreCritical","resistAllDamage","immunePoison","immuneDisease","meleeAttackedWithAdvantage","rangedAttackedWithDisadvantage","movementCost","savingThrowDisadvantage","limitedSpeech","unaware","dropItems","prone","stackable","maxStacks","level1","level2","level3","level4","level5","level6","maintainingSpell","breaksOnDamage","breaksOnIncapacitated","attackBonus","saveBonus","attackPenalty","savePenalty","speedMultiplier","acBonus","savingThrowAdvantage","extraAction","acPenalty","abilityCheckAdvantage","damageBonus","resistPhysicalDamage","cannotCastSpells","damagePerTurn","damageType","createStatusEffect","type","duration","durationType","source","saveDC","saveAbility","spellName","stackCount","definition","console","error","id","Date","now","Math","random","toString","substr","remainingDuration","appliedAt","applyStatusEffect","character","statusEffect","conditions","existingIndex","findIndex","c","existing","_existing$effects","newStackCount","min","max","push","removeStatusEffect","effectId","filter","removeStatusEffectByType","effectType","processStatusEffectsOnTurnStart","updatedCharacter","toRemove","damageLog","forEach","effect","index","_effect$effects","damage","rollDamage","hp","e","includes","removedEffects","hasStatusEffect","some","getActiveStatusEffects","makeStatusSave","abilityModifier","d20","floor","total","success","dc","ability","checkConcentration","_character$abilities","_character$proficienc","_character$proficienc2","concentrationEffect","find","maintainsConcentration","conModifier","abilities","CON","profBonus","level","isProficient","proficiencies","savingThrows","saveModifier","result","concentrationBroken","diceString","match","parseInt","numDice","dieSize","modifier","i","getAttackModifiers","attacker","defender","attackerEffects","defenderEffects","advantage","disadvantage","_effect$effects2","_effect$effects3","_effect$effects4","_effect$effects5","normal","applyExhaustion","levels","currentExhaustion","exhaustion","newExhaustion","isDead","removeExhaustion"],"sources":["C:/Users/Hakty/Desktop/AI-Dungeon-Master/frontend/src/utils/statusEffectSystem.js"],"sourcesContent":["// frontend/src/utils/statusEffectSystem.js\n\n/**\n * D&D 5e Status Effects System\n * Handles conditions, durations, and their mechanical effects\n */\n\n// Status effect types\nexport const STATUS_EFFECTS = {\n  // D&D 5e Conditions\n  BLINDED: 'blinded',\n  CHARMED: 'charmed',\n  DEAFENED: 'deafened',\n  FRIGHTENED: 'frightened',\n  GRAPPLED: 'grappled',\n  INCAPACITATED: 'incapacitated',\n  INVISIBLE: 'invisible',\n  PARALYZED: 'paralyzed',\n  PETRIFIED: 'petrified',\n  POISONED: 'poisoned',\n  PRONE: 'prone',\n  RESTRAINED: 'restrained',\n  STUNNED: 'stunned',\n  UNCONSCIOUS: 'unconscious',\n  EXHAUSTION: 'exhaustion',\n  \n  // Additional common effects\n  CONCENTRATING: 'concentrating',\n  BLESSED: 'blessed',\n  BANED: 'baned',\n  HASTED: 'hasted',\n  SLOWED: 'slowed',\n  RAGING: 'raging',\n  DODGING: 'dodging',\n  HIDING: 'hiding',\n  INVISIBLE: 'invisible',\n  FLYING: 'flying',\n  BURNING: 'burning',\n  BLEEDING: 'bleeding',\n};\n\n// Duration types\nexport const DURATION_TYPES = {\n  INSTANT: 'instant',           // Happens immediately, no duration\n  ROUNDS: 'rounds',             // Lasts X combat rounds\n  MINUTES: 'minutes',           // Lasts X minutes\n  HOURS: 'hours',               // Lasts X hours\n  SAVE_ENDS: 'save_ends',       // Lasts until successful save\n  CONCENTRATION: 'concentration', // Lasts while concentrating\n  PERMANENT: 'permanent',        // Lasts until removed\n  END_OF_TURN: 'end_of_turn',   // Ends at end of target's turn\n  START_OF_TURN: 'start_of_turn', // Ends at start of target's turn\n};\n\n// Status effect definitions with mechanical effects\nexport const STATUS_EFFECT_DEFINITIONS = {\n  [STATUS_EFFECTS.BLINDED]: {\n    name: 'Blinded',\n    icon: 'ðŸ‘ï¸',\n    color: '#666',\n    description: 'Cannot see. Attacks have disadvantage. Attacks against have advantage.',\n    effects: {\n      attackDisadvantage: true,\n      attackedWithAdvantage: true,\n      autoFailAbilityChecks: ['sight-based']\n    },\n    canStack: false,\n    removedBy: ['cure', 'dispel', 'lesser_restoration'],\n  },\n\n  [STATUS_EFFECTS.CHARMED]: {\n    name: 'Charmed',\n    icon: 'ðŸ’–',\n    color: '#E91E63',\n    description: 'Cannot attack charmer. Charmer has advantage on social checks.',\n    effects: {\n      cannotAttackCharmer: true,\n      charmerHasAdvantage: true\n    },\n    canStack: false,\n    removedBy: ['damage', 'calm_emotions', 'dispel'],\n  },\n\n  [STATUS_EFFECTS.FRIGHTENED]: {\n    name: 'Frightened',\n    icon: 'ðŸ˜±',\n    color: '#9C27B0',\n    description: 'Disadvantage on ability checks and attacks while source is in sight. Cannot move closer to source.',\n    effects: {\n      attackDisadvantage: true,\n      abilityCheckDisadvantage: true,\n      cannotApproachSource: true\n    },\n    canStack: false,\n    removedBy: ['calm_emotions', 'dispel'],\n  },\n\n  [STATUS_EFFECTS.GRAPPLED]: {\n    name: 'Grappled',\n    icon: 'ðŸ¤¼',\n    color: '#FF9800',\n    description: 'Speed becomes 0. Cannot benefit from speed bonuses.',\n    effects: {\n      speedReduction: 'zero',\n      noSpeedBonus: true\n    },\n    canStack: false,\n    removedBy: ['escape', 'forced_movement', 'incapacitated'],\n  },\n\n  [STATUS_EFFECTS.INCAPACITATED]: {\n    name: 'Incapacitated',\n    icon: 'ðŸ˜µ',\n    color: '#795548',\n    description: 'Cannot take actions or reactions.',\n    effects: {\n      cannotAct: true,\n      cannotReact: true,\n      dropsConcentration: true\n    },\n    canStack: false,\n    removedBy: ['cure', 'time'],\n  },\n\n  [STATUS_EFFECTS.INVISIBLE]: {\n    name: 'Invisible',\n    icon: 'ðŸ‘»',\n    color: '#00BCD4',\n    description: 'Impossible to see without special sense. Attacks have advantage. Attacks against have disadvantage.',\n    effects: {\n      attackAdvantage: true,\n      attackedWithDisadvantage: true,\n      canHide: true\n    },\n    canStack: false,\n    removedBy: ['dispel', 'attack', 'cast_spell'],\n  },\n\n  [STATUS_EFFECTS.PARALYZED]: {\n    name: 'Paralyzed',\n    icon: 'ðŸ¥¶',\n    color: '#2196F3',\n    description: 'Incapacitated. Cannot move or speak. Auto-fail STR/DEX saves. Attacks have advantage. Hits within 5ft are critical.',\n    effects: {\n      cannotAct: true,\n      cannotMove: true,\n      cannotSpeak: true,\n      autoFailSaves: ['STR', 'DEX'],\n      attackedWithAdvantage: true,\n      nearbyHitsAreCritical: true,\n      dropsConcentration: true\n    },\n    canStack: false,\n    removedBy: ['lesser_restoration', 'dispel'],\n  },\n\n  [STATUS_EFFECTS.PETRIFIED]: {\n    name: 'Petrified',\n    icon: 'ðŸ—¿',\n    color: '#607D8B',\n    description: 'Turned to stone. Incapacitated. Cannot move or speak. Resistant to all damage. Immune to poison and disease.',\n    effects: {\n      cannotAct: true,\n      cannotMove: true,\n      cannotSpeak: true,\n      resistAllDamage: true,\n      immunePoison: true,\n      immuneDisease: true,\n      dropsConcentration: true\n    },\n    canStack: false,\n    removedBy: ['greater_restoration', 'wish'],\n  },\n\n  [STATUS_EFFECTS.POISONED]: {\n    name: 'Poisoned',\n    icon: 'ðŸ¤¢',\n    color: '#8BC34A',\n    description: 'Disadvantage on attack rolls and ability checks.',\n    effects: {\n      attackDisadvantage: true,\n      abilityCheckDisadvantage: true\n    },\n    canStack: false,\n    removedBy: ['lesser_restoration', 'antitoxin', 'time'],\n  },\n\n  [STATUS_EFFECTS.PRONE]: {\n    name: 'Prone',\n    icon: 'ðŸ¤•',\n    color: '#795548',\n    description: 'Only crawl or stand up. Disadvantage on attacks. Melee attacks against have advantage, ranged have disadvantage.',\n    effects: {\n      attackDisadvantage: true,\n      meleeAttackedWithAdvantage: true,\n      rangedAttackedWithDisadvantage: true,\n      movementCost: 'half'\n    },\n    canStack: false,\n    removedBy: ['stand_up'],\n  },\n\n  [STATUS_EFFECTS.RESTRAINED]: {\n    name: 'Restrained',\n    icon: 'â›“ï¸',\n    color: '#9E9E9E',\n    description: 'Speed becomes 0. Attacks have disadvantage. Attacks against have advantage. Disadvantage on DEX saves.',\n    effects: {\n      speedReduction: 'zero',\n      attackDisadvantage: true,\n      attackedWithAdvantage: true,\n      savingThrowDisadvantage: ['DEX']\n    },\n    canStack: false,\n    removedBy: ['escape', 'dispel'],\n  },\n\n  [STATUS_EFFECTS.STUNNED]: {\n    name: 'Stunned',\n    icon: 'ðŸ˜µâ€ðŸ’«',\n    color: '#FFC107',\n    description: 'Incapacitated. Cannot move. Can only speak falteringly. Auto-fail STR/DEX saves. Attacks against have advantage.',\n    effects: {\n      cannotAct: true,\n      cannotMove: true,\n      limitedSpeech: true,\n      autoFailSaves: ['STR', 'DEX'],\n      attackedWithAdvantage: true,\n      dropsConcentration: true\n    },\n    canStack: false,\n    removedBy: ['time', 'dispel'],\n  },\n\n  [STATUS_EFFECTS.UNCONSCIOUS]: {\n    name: 'Unconscious',\n    icon: 'ðŸ’¤',\n    color: '#424242',\n    description: 'Incapacitated. Cannot move or speak. Unaware of surroundings. Drop everything. Prone. Auto-fail STR/DEX saves. Attacks have advantage. Hits within 5ft are critical.',\n    effects: {\n      cannotAct: true,\n      cannotMove: true,\n      cannotSpeak: true,\n      unaware: true,\n      dropItems: true,\n      prone: true,\n      autoFailSaves: ['STR', 'DEX'],\n      attackedWithAdvantage: true,\n      nearbyHitsAreCritical: true,\n      dropsConcentration: true\n    },\n    canStack: false,\n    removedBy: ['damage', 'help_action', 'time'],\n  },\n\n  [STATUS_EFFECTS.EXHAUSTION]: {\n    name: 'Exhaustion',\n    icon: 'ðŸ¥±',\n    color: '#616161',\n    description: 'Cumulative levels of exhaustion. Level 1: Disadvantage on ability checks. Level 6: Death.',\n    effects: {\n      stackable: true,\n      maxStacks: 6,\n      level1: 'Disadvantage on ability checks',\n      level2: 'Speed halved',\n      level3: 'Disadvantage on attacks and saves',\n      level4: 'HP maximum halved',\n      level5: 'Speed reduced to 0',\n      level6: 'Death'\n    },\n    canStack: true,\n    removedBy: ['long_rest', 'greater_restoration'],\n  },\n\n  // Spell effects\n  [STATUS_EFFECTS.CONCENTRATING]: {\n    name: 'Concentrating',\n    icon: 'ðŸ§˜',\n    color: '#9C27B0',\n    description: 'Maintaining a spell through concentration. Breaks on damage (DC 10 or half damage CON save) or incapacitation.',\n    effects: {\n      maintainingSpell: true,\n      breaksOnDamage: true,\n      breaksOnIncapacitated: true\n    },\n    canStack: false,\n    removedBy: ['damage', 'incapacitated', 'death'],\n  },\n\n  [STATUS_EFFECTS.BLESSED]: {\n    name: 'Blessed',\n    icon: 'âœ¨',\n    color: '#FFD700',\n    description: 'Add 1d4 to attack rolls and saving throws.',\n    effects: {\n      attackBonus: '1d4',\n      saveBonus: '1d4'\n    },\n    canStack: false,\n    removedBy: ['dispel', 'duration'],\n  },\n\n  [STATUS_EFFECTS.BANED]: {\n    name: 'Baned',\n    icon: 'ðŸ’€',\n    color: '#D32F2F',\n    description: 'Subtract 1d4 from attack rolls and saving throws.',\n    effects: {\n      attackPenalty: '1d4',\n      savePenalty: '1d4'\n    },\n    canStack: false,\n    removedBy: ['dispel', 'duration'],\n  },\n\n  [STATUS_EFFECTS.HASTED]: {\n    name: 'Hasted',\n    icon: 'âš¡',\n    color: '#00BCD4',\n    description: 'Double speed. +2 AC. Advantage on DEX saves. Extra action each turn.',\n    effects: {\n      speedMultiplier: 2,\n      acBonus: 2,\n      savingThrowAdvantage: ['DEX'],\n      extraAction: true\n    },\n    canStack: false,\n    removedBy: ['dispel', 'duration'],\n  },\n\n  [STATUS_EFFECTS.SLOWED]: {\n    name: 'Slowed',\n    icon: 'ðŸŒ',\n    color: '#795548',\n    description: 'Speed halved. -2 AC. Disadvantage on DEX saves. Cannot take reactions.',\n    effects: {\n      speedMultiplier: 0.5,\n      acPenalty: 2,\n      savingThrowDisadvantage: ['DEX'],\n      cannotReact: true\n    },\n    canStack: false,\n    removedBy: ['dispel', 'duration'],\n  },\n\n  [STATUS_EFFECTS.RAGING]: {\n    name: 'Raging',\n    icon: 'ðŸ˜¡',\n    color: '#D32F2F',\n    description: 'Advantage on STR checks/saves. Bonus damage. Resistance to physical damage.',\n    effects: {\n      abilityCheckAdvantage: ['STR'],\n      savingThrowAdvantage: ['STR'],\n      damageBonus: 2,\n      resistPhysicalDamage: true,\n      cannotCastSpells: true\n    },\n    canStack: false,\n    removedBy: ['duration', 'unconscious'],\n  },\n\n  [STATUS_EFFECTS.DODGING]: {\n    name: 'Dodging',\n    icon: 'ðŸ¤º',\n    color: '#4CAF50',\n    description: 'Attacks against you have disadvantage. You have advantage on DEX saves.',\n    effects: {\n      attackedWithDisadvantage: true,\n      savingThrowAdvantage: ['DEX']\n    },\n    canStack: false,\n    removedBy: ['end_of_turn'],\n  },\n\n  [STATUS_EFFECTS.BURNING]: {\n    name: 'Burning',\n    icon: 'ðŸ”¥',\n    color: '#FF5722',\n    description: 'Takes fire damage at the start of each turn.',\n    effects: {\n      damagePerTurn: '1d6',\n      damageType: 'fire'\n    },\n    canStack: true,\n    removedBy: ['water', 'action', 'damage'],\n  },\n\n  [STATUS_EFFECTS.BLEEDING]: {\n    name: 'Bleeding',\n    icon: 'ðŸ©¸',\n    color: '#D32F2F',\n    description: 'Takes damage at the start of each turn. Disadvantage on CON saves.',\n    effects: {\n      damagePerTurn: '1d4',\n      damageType: 'slashing',\n      savingThrowDisadvantage: ['CON']\n    },\n    canStack: true,\n    removedBy: ['healing', 'medicine_check'],\n  },\n};\n\n/**\n * Create a status effect instance\n */\nexport function createStatusEffect({\n  type,\n  duration = 1,\n  durationType = DURATION_TYPES.ROUNDS,\n  source = null,\n  saveDC = null,\n  saveAbility = null,\n  spellName = null,\n  stackCount = 1\n}) {\n  const definition = STATUS_EFFECT_DEFINITIONS[type];\n  \n  if (!definition) {\n    console.error('Unknown status effect:', type);\n    return null;\n  }\n\n  return {\n    id: `${type}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n    type,\n    ...definition,\n    duration,\n    durationType,\n    remainingDuration: duration,\n    source, // Who/what applied this effect\n    saveDC, // DC for saves to end effect\n    saveAbility, // Which ability to save with\n    spellName, // If from a spell\n    stackCount: definition.canStack ? stackCount : 1,\n    appliedAt: Date.now(),\n  };\n}\n\n/**\n * Apply status effect to a combatant/character\n */\nexport function applyStatusEffect(character, statusEffect) {\n  const conditions = character.conditions || [];\n  \n  // Check if effect already exists\n  const existingIndex = conditions.findIndex(c => c.type === statusEffect.type);\n  \n  if (existingIndex !== -1) {\n    const existing = conditions[existingIndex];\n    \n    // If stackable, increase stack count\n    if (existing.canStack) {\n      const maxStacks = existing.effects?.maxStacks || 10;\n      const newStackCount = Math.min(maxStacks, existing.stackCount + statusEffect.stackCount);\n      \n      conditions[existingIndex] = {\n        ...existing,\n        stackCount: newStackCount,\n        remainingDuration: Math.max(existing.remainingDuration, statusEffect.remainingDuration)\n      };\n    } else {\n      // Replace with new effect if duration is longer\n      if (statusEffect.remainingDuration > existing.remainingDuration) {\n        conditions[existingIndex] = statusEffect;\n      }\n    }\n  } else {\n    // Add new effect\n    conditions.push(statusEffect);\n  }\n\n  return {\n    ...character,\n    conditions: [...conditions]\n  };\n}\n\n/**\n * Remove status effect from character\n */\nexport function removeStatusEffect(character, effectId) {\n  return {\n    ...character,\n    conditions: (character.conditions || []).filter(c => c.id !== effectId)\n  };\n}\n\n/**\n * Remove all status effects of a type\n */\nexport function removeStatusEffectByType(character, effectType) {\n  return {\n    ...character,\n    conditions: (character.conditions || []).filter(c => c.type !== effectType)\n  };\n}\n\n/**\n * Process turn-based status effects (damage, duration reduction)\n */\nexport function processStatusEffectsOnTurnStart(character) {\n  let updatedCharacter = { ...character };\n  const conditions = [...(character.conditions || [])];\n  const toRemove = [];\n  let damageLog = [];\n\n  conditions.forEach((effect, index) => {\n    // Process damage-over-time effects\n    if (effect.effects?.damagePerTurn) {\n      const damage = rollDamage(effect.effects.damagePerTurn);\n      updatedCharacter = {\n        ...updatedCharacter,\n        hp: Math.max(0, updatedCharacter.hp - damage)\n      };\n      damageLog.push({\n        effect: effect.name,\n        damage,\n        damageType: effect.effects.damageType || 'untyped'\n      });\n    }\n\n    // Reduce duration\n    if (effect.durationType === DURATION_TYPES.ROUNDS ||\n        effect.durationType === DURATION_TYPES.START_OF_TURN) {\n      effect.remainingDuration -= 1;\n      \n      if (effect.remainingDuration <= 0) {\n        toRemove.push(effect.id);\n      }\n    }\n  });\n\n  // Remove expired effects\n  updatedCharacter.conditions = conditions.filter(e => !toRemove.includes(e.id));\n\n  return {\n    character: updatedCharacter,\n    damageLog,\n    removedEffects: toRemove\n  };\n}\n\n/**\n * Check if character has specific status effect\n */\nexport function hasStatusEffect(character, effectType) {\n  return (character.conditions || []).some(c => c.type === effectType);\n}\n\n/**\n * Get all active status effects\n */\nexport function getActiveStatusEffects(character) {\n  return character.conditions || [];\n}\n\n/**\n * Make saving throw to resist or end status effect\n */\nexport function makeStatusSave(character, effect, abilityModifier) {\n  const d20 = Math.floor(Math.random() * 20) + 1;\n  const total = d20 + abilityModifier;\n  const success = total >= effect.saveDC;\n\n  return {\n    d20,\n    total,\n    success,\n    dc: effect.saveDC,\n    ability: effect.saveAbility\n  };\n}\n\n/**\n * Check concentration when taking damage\n */\nexport function checkConcentration(character, damage) {\n  const concentrationEffect = (character.conditions || []).find(\n    c => c.type === STATUS_EFFECTS.CONCENTRATING\n  );\n\n  if (!concentrationEffect) {\n    return { maintainsConcentration: true };\n  }\n\n  // DC is 10 or half damage, whichever is higher\n  const dc = Math.max(10, Math.floor(damage / 2));\n  \n  // CON save\n  const conModifier = Math.floor((character.abilities?.CON - 10) / 2) || 0;\n  const profBonus = character.level ? Math.floor((character.level - 1) / 4) + 2 : 2;\n  const isProficient = character.proficiencies?.savingThrows?.includes('CON');\n  \n  const saveModifier = conModifier + (isProficient ? profBonus : 0);\n  const result = makeStatusSave(character, { saveDC: dc, saveAbility: 'CON' }, saveModifier);\n\n  return {\n    ...result,\n    maintainsConcentration: result.success,\n    concentrationBroken: !result.success,\n    spellName: concentrationEffect.spellName\n  };\n}\n\n/**\n * Helper to roll damage dice\n */\nfunction rollDamage(diceString) {\n  const match = diceString.match(/(\\d+)d(\\d+)([+-]\\d+)?/);\n  if (!match) return parseInt(diceString) || 0;\n  \n  const [, numDice, dieSize, modifier] = match;\n  let total = 0;\n  \n  for (let i = 0; i < parseInt(numDice); i++) {\n    total += Math.floor(Math.random() * parseInt(dieSize)) + 1;\n  }\n  \n  if (modifier) {\n    total += parseInt(modifier);\n  }\n  \n  return total;\n}\n\n/**\n * Get attack roll advantage/disadvantage based on status effects\n */\nexport function getAttackModifiers(attacker, defender) {\n  const attackerEffects = getActiveStatusEffects(attacker);\n  const defenderEffects = getActiveStatusEffects(defender);\n  \n  let advantage = false;\n  let disadvantage = false;\n  \n  // Attacker effects\n  attackerEffects.forEach(effect => {\n    if (effect.effects?.attackAdvantage) advantage = true;\n    if (effect.effects?.attackDisadvantage) disadvantage = true;\n  });\n  \n  // Defender effects\n  defenderEffects.forEach(effect => {\n    if (effect.effects?.attackedWithAdvantage) advantage = true;\n    if (effect.effects?.attackedWithDisadvantage) disadvantage = true;\n  });\n  \n  // Advantage and disadvantage cancel out\n  if (advantage && disadvantage) {\n    return { advantage: false, disadvantage: false, normal: true };\n  }\n  \n  return { advantage, disadvantage, normal: !advantage && !disadvantage };\n}\n\n/**\n * Apply exhaustion level\n */\nexport function applyExhaustion(character, levels = 1) {\n  const currentExhaustion = character.exhaustion || 0;\n  const newExhaustion = Math.min(6, currentExhaustion + levels);\n  \n  if (newExhaustion >= 6) {\n    return {\n      ...character,\n      exhaustion: 6,\n      hp: 0,\n      isDead: true\n    };\n  }\n  \n  return {\n    ...character,\n    exhaustion: newExhaustion\n  };\n}\n\n/**\n * Remove exhaustion level\n */\nexport function removeExhaustion(character, levels = 1) {\n  const currentExhaustion = character.exhaustion || 0;\n  const newExhaustion = Math.max(0, currentExhaustion - levels);\n  \n  return {\n    ...character,\n    exhaustion: newExhaustion\n  };\n}"],"mappings":"AAAA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,OAAO,MAAMA,cAAc,GAAG;EAC5B;EACAC,OAAO,EAAE,SAAS;EAClBC,OAAO,EAAE,SAAS;EAClBC,QAAQ,EAAE,UAAU;EACpBC,UAAU,EAAE,YAAY;EACxBC,QAAQ,EAAE,UAAU;EACpBC,aAAa,EAAE,eAAe;EAC9BC,SAAS,EAAE,WAAW;EACtBC,SAAS,EAAE,WAAW;EACtBC,SAAS,EAAE,WAAW;EACtBC,QAAQ,EAAE,UAAU;EACpBC,KAAK,EAAE,OAAO;EACdC,UAAU,EAAE,YAAY;EACxBC,OAAO,EAAE,SAAS;EAClBC,WAAW,EAAE,aAAa;EAC1BC,UAAU,EAAE,YAAY;EAExB;EACAC,aAAa,EAAE,eAAe;EAC9BC,OAAO,EAAE,SAAS;EAClBC,KAAK,EAAE,OAAO;EACdC,MAAM,EAAE,QAAQ;EAChBC,MAAM,EAAE,QAAQ;EAChBC,MAAM,EAAE,QAAQ;EAChBC,OAAO,EAAE,SAAS;EAClBC,MAAM,EAAE,QAAQ;EAChBhB,SAAS,EAAE,WAAW;EACtBiB,MAAM,EAAE,QAAQ;EAChBC,OAAO,EAAE,SAAS;EAClBC,QAAQ,EAAE;AACZ,CAAC;;AAED;AACA,OAAO,MAAMC,cAAc,GAAG;EAC5BC,OAAO,EAAE,SAAS;EAAY;EAC9BC,MAAM,EAAE,QAAQ;EAAc;EAC9BC,OAAO,EAAE,SAAS;EAAY;EAC9BC,KAAK,EAAE,OAAO;EAAgB;EAC9BC,SAAS,EAAE,WAAW;EAAQ;EAC9BC,aAAa,EAAE,eAAe;EAAE;EAChCC,SAAS,EAAE,WAAW;EAAS;EAC/BC,WAAW,EAAE,aAAa;EAAI;EAC9BC,aAAa,EAAE,eAAe,CAAE;AAClC,CAAC;;AAED;AACA,OAAO,MAAMC,yBAAyB,GAAG;EACvC,CAACrC,cAAc,CAACC,OAAO,GAAG;IACxBqC,IAAI,EAAE,SAAS;IACfC,IAAI,EAAE,KAAK;IACXC,KAAK,EAAE,MAAM;IACbC,WAAW,EAAE,wEAAwE;IACrFC,OAAO,EAAE;MACPC,kBAAkB,EAAE,IAAI;MACxBC,qBAAqB,EAAE,IAAI;MAC3BC,qBAAqB,EAAE,CAAC,aAAa;IACvC,CAAC;IACDC,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,MAAM,EAAE,QAAQ,EAAE,oBAAoB;EACpD,CAAC;EAED,CAAC/C,cAAc,CAACE,OAAO,GAAG;IACxBoC,IAAI,EAAE,SAAS;IACfC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,gEAAgE;IAC7EC,OAAO,EAAE;MACPM,mBAAmB,EAAE,IAAI;MACzBC,mBAAmB,EAAE;IACvB,CAAC;IACDH,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,QAAQ,EAAE,eAAe,EAAE,QAAQ;EACjD,CAAC;EAED,CAAC/C,cAAc,CAACI,UAAU,GAAG;IAC3BkC,IAAI,EAAE,YAAY;IAClBC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,oGAAoG;IACjHC,OAAO,EAAE;MACPC,kBAAkB,EAAE,IAAI;MACxBO,wBAAwB,EAAE,IAAI;MAC9BC,oBAAoB,EAAE;IACxB,CAAC;IACDL,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,eAAe,EAAE,QAAQ;EACvC,CAAC;EAED,CAAC/C,cAAc,CAACK,QAAQ,GAAG;IACzBiC,IAAI,EAAE,UAAU;IAChBC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,qDAAqD;IAClEC,OAAO,EAAE;MACPU,cAAc,EAAE,MAAM;MACtBC,YAAY,EAAE;IAChB,CAAC;IACDP,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,QAAQ,EAAE,iBAAiB,EAAE,eAAe;EAC1D,CAAC;EAED,CAAC/C,cAAc,CAACM,aAAa,GAAG;IAC9BgC,IAAI,EAAE,eAAe;IACrBC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,mCAAmC;IAChDC,OAAO,EAAE;MACPY,SAAS,EAAE,IAAI;MACfC,WAAW,EAAE,IAAI;MACjBC,kBAAkB,EAAE;IACtB,CAAC;IACDV,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,MAAM,EAAE,MAAM;EAC5B,CAAC;EAED,CAAC/C,cAAc,CAACO,SAAS,GAAG;IAC1B+B,IAAI,EAAE,WAAW;IACjBC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,qGAAqG;IAClHC,OAAO,EAAE;MACPe,eAAe,EAAE,IAAI;MACrBC,wBAAwB,EAAE,IAAI;MAC9BC,OAAO,EAAE;IACX,CAAC;IACDb,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,QAAQ,EAAE,QAAQ,EAAE,YAAY;EAC9C,CAAC;EAED,CAAC/C,cAAc,CAACQ,SAAS,GAAG;IAC1B8B,IAAI,EAAE,WAAW;IACjBC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,qHAAqH;IAClIC,OAAO,EAAE;MACPY,SAAS,EAAE,IAAI;MACfM,UAAU,EAAE,IAAI;MAChBC,WAAW,EAAE,IAAI;MACjBC,aAAa,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;MAC7BlB,qBAAqB,EAAE,IAAI;MAC3BmB,qBAAqB,EAAE,IAAI;MAC3BP,kBAAkB,EAAE;IACtB,CAAC;IACDV,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,oBAAoB,EAAE,QAAQ;EAC5C,CAAC;EAED,CAAC/C,cAAc,CAACS,SAAS,GAAG;IAC1B6B,IAAI,EAAE,WAAW;IACjBC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,8GAA8G;IAC3HC,OAAO,EAAE;MACPY,SAAS,EAAE,IAAI;MACfM,UAAU,EAAE,IAAI;MAChBC,WAAW,EAAE,IAAI;MACjBG,eAAe,EAAE,IAAI;MACrBC,YAAY,EAAE,IAAI;MAClBC,aAAa,EAAE,IAAI;MACnBV,kBAAkB,EAAE;IACtB,CAAC;IACDV,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,qBAAqB,EAAE,MAAM;EAC3C,CAAC;EAED,CAAC/C,cAAc,CAACU,QAAQ,GAAG;IACzB4B,IAAI,EAAE,UAAU;IAChBC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,kDAAkD;IAC/DC,OAAO,EAAE;MACPC,kBAAkB,EAAE,IAAI;MACxBO,wBAAwB,EAAE;IAC5B,CAAC;IACDJ,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,oBAAoB,EAAE,WAAW,EAAE,MAAM;EACvD,CAAC;EAED,CAAC/C,cAAc,CAACW,KAAK,GAAG;IACtB2B,IAAI,EAAE,OAAO;IACbC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,kHAAkH;IAC/HC,OAAO,EAAE;MACPC,kBAAkB,EAAE,IAAI;MACxBwB,0BAA0B,EAAE,IAAI;MAChCC,8BAA8B,EAAE,IAAI;MACpCC,YAAY,EAAE;IAChB,CAAC;IACDvB,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,UAAU;EACxB,CAAC;EAED,CAAC/C,cAAc,CAACY,UAAU,GAAG;IAC3B0B,IAAI,EAAE,YAAY;IAClBC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,wGAAwG;IACrHC,OAAO,EAAE;MACPU,cAAc,EAAE,MAAM;MACtBT,kBAAkB,EAAE,IAAI;MACxBC,qBAAqB,EAAE,IAAI;MAC3B0B,uBAAuB,EAAE,CAAC,KAAK;IACjC,CAAC;IACDxB,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,QAAQ,EAAE,QAAQ;EAChC,CAAC;EAED,CAAC/C,cAAc,CAACa,OAAO,GAAG;IACxByB,IAAI,EAAE,SAAS;IACfC,IAAI,EAAE,OAAO;IACbC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,kHAAkH;IAC/HC,OAAO,EAAE;MACPY,SAAS,EAAE,IAAI;MACfM,UAAU,EAAE,IAAI;MAChBW,aAAa,EAAE,IAAI;MACnBT,aAAa,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;MAC7BlB,qBAAqB,EAAE,IAAI;MAC3BY,kBAAkB,EAAE;IACtB,CAAC;IACDV,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,MAAM,EAAE,QAAQ;EAC9B,CAAC;EAED,CAAC/C,cAAc,CAACc,WAAW,GAAG;IAC5BwB,IAAI,EAAE,aAAa;IACnBC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,sKAAsK;IACnLC,OAAO,EAAE;MACPY,SAAS,EAAE,IAAI;MACfM,UAAU,EAAE,IAAI;MAChBC,WAAW,EAAE,IAAI;MACjBW,OAAO,EAAE,IAAI;MACbC,SAAS,EAAE,IAAI;MACfC,KAAK,EAAE,IAAI;MACXZ,aAAa,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;MAC7BlB,qBAAqB,EAAE,IAAI;MAC3BmB,qBAAqB,EAAE,IAAI;MAC3BP,kBAAkB,EAAE;IACtB,CAAC;IACDV,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,QAAQ,EAAE,aAAa,EAAE,MAAM;EAC7C,CAAC;EAED,CAAC/C,cAAc,CAACe,UAAU,GAAG;IAC3BuB,IAAI,EAAE,YAAY;IAClBC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,2FAA2F;IACxGC,OAAO,EAAE;MACPiC,SAAS,EAAE,IAAI;MACfC,SAAS,EAAE,CAAC;MACZC,MAAM,EAAE,gCAAgC;MACxCC,MAAM,EAAE,cAAc;MACtBC,MAAM,EAAE,mCAAmC;MAC3CC,MAAM,EAAE,mBAAmB;MAC3BC,MAAM,EAAE,oBAAoB;MAC5BC,MAAM,EAAE;IACV,CAAC;IACDpC,QAAQ,EAAE,IAAI;IACdC,SAAS,EAAE,CAAC,WAAW,EAAE,qBAAqB;EAChD,CAAC;EAED;EACA,CAAC/C,cAAc,CAACgB,aAAa,GAAG;IAC9BsB,IAAI,EAAE,eAAe;IACrBC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,gHAAgH;IAC7HC,OAAO,EAAE;MACPyC,gBAAgB,EAAE,IAAI;MACtBC,cAAc,EAAE,IAAI;MACpBC,qBAAqB,EAAE;IACzB,CAAC;IACDvC,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,QAAQ,EAAE,eAAe,EAAE,OAAO;EAChD,CAAC;EAED,CAAC/C,cAAc,CAACiB,OAAO,GAAG;IACxBqB,IAAI,EAAE,SAAS;IACfC,IAAI,EAAE,GAAG;IACTC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,4CAA4C;IACzDC,OAAO,EAAE;MACP4C,WAAW,EAAE,KAAK;MAClBC,SAAS,EAAE;IACb,CAAC;IACDzC,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,QAAQ,EAAE,UAAU;EAClC,CAAC;EAED,CAAC/C,cAAc,CAACkB,KAAK,GAAG;IACtBoB,IAAI,EAAE,OAAO;IACbC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,mDAAmD;IAChEC,OAAO,EAAE;MACP8C,aAAa,EAAE,KAAK;MACpBC,WAAW,EAAE;IACf,CAAC;IACD3C,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,QAAQ,EAAE,UAAU;EAClC,CAAC;EAED,CAAC/C,cAAc,CAACmB,MAAM,GAAG;IACvBmB,IAAI,EAAE,QAAQ;IACdC,IAAI,EAAE,GAAG;IACTC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,sEAAsE;IACnFC,OAAO,EAAE;MACPgD,eAAe,EAAE,CAAC;MAClBC,OAAO,EAAE,CAAC;MACVC,oBAAoB,EAAE,CAAC,KAAK,CAAC;MAC7BC,WAAW,EAAE;IACf,CAAC;IACD/C,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,QAAQ,EAAE,UAAU;EAClC,CAAC;EAED,CAAC/C,cAAc,CAACoB,MAAM,GAAG;IACvBkB,IAAI,EAAE,QAAQ;IACdC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,wEAAwE;IACrFC,OAAO,EAAE;MACPgD,eAAe,EAAE,GAAG;MACpBI,SAAS,EAAE,CAAC;MACZxB,uBAAuB,EAAE,CAAC,KAAK,CAAC;MAChCf,WAAW,EAAE;IACf,CAAC;IACDT,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,QAAQ,EAAE,UAAU;EAClC,CAAC;EAED,CAAC/C,cAAc,CAACqB,MAAM,GAAG;IACvBiB,IAAI,EAAE,QAAQ;IACdC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,6EAA6E;IAC1FC,OAAO,EAAE;MACPqD,qBAAqB,EAAE,CAAC,KAAK,CAAC;MAC9BH,oBAAoB,EAAE,CAAC,KAAK,CAAC;MAC7BI,WAAW,EAAE,CAAC;MACdC,oBAAoB,EAAE,IAAI;MAC1BC,gBAAgB,EAAE;IACpB,CAAC;IACDpD,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,UAAU,EAAE,aAAa;EACvC,CAAC;EAED,CAAC/C,cAAc,CAACsB,OAAO,GAAG;IACxBgB,IAAI,EAAE,SAAS;IACfC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,yEAAyE;IACtFC,OAAO,EAAE;MACPgB,wBAAwB,EAAE,IAAI;MAC9BkC,oBAAoB,EAAE,CAAC,KAAK;IAC9B,CAAC;IACD9C,QAAQ,EAAE,KAAK;IACfC,SAAS,EAAE,CAAC,aAAa;EAC3B,CAAC;EAED,CAAC/C,cAAc,CAACyB,OAAO,GAAG;IACxBa,IAAI,EAAE,SAAS;IACfC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,8CAA8C;IAC3DC,OAAO,EAAE;MACPyD,aAAa,EAAE,KAAK;MACpBC,UAAU,EAAE;IACd,CAAC;IACDtD,QAAQ,EAAE,IAAI;IACdC,SAAS,EAAE,CAAC,OAAO,EAAE,QAAQ,EAAE,QAAQ;EACzC,CAAC;EAED,CAAC/C,cAAc,CAAC0B,QAAQ,GAAG;IACzBY,IAAI,EAAE,UAAU;IAChBC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,SAAS;IAChBC,WAAW,EAAE,oEAAoE;IACjFC,OAAO,EAAE;MACPyD,aAAa,EAAE,KAAK;MACpBC,UAAU,EAAE,UAAU;MACtB9B,uBAAuB,EAAE,CAAC,KAAK;IACjC,CAAC;IACDxB,QAAQ,EAAE,IAAI;IACdC,SAAS,EAAE,CAAC,SAAS,EAAE,gBAAgB;EACzC;AACF,CAAC;;AAED;AACA;AACA;AACA,OAAO,SAASsD,kBAAkBA,CAAC;EACjCC,IAAI;EACJC,QAAQ,GAAG,CAAC;EACZC,YAAY,GAAG7E,cAAc,CAACE,MAAM;EACpC4E,MAAM,GAAG,IAAI;EACbC,MAAM,GAAG,IAAI;EACbC,WAAW,GAAG,IAAI;EAClBC,SAAS,GAAG,IAAI;EAChBC,UAAU,GAAG;AACf,CAAC,EAAE;EACD,MAAMC,UAAU,GAAGzE,yBAAyB,CAACiE,IAAI,CAAC;EAElD,IAAI,CAACQ,UAAU,EAAE;IACfC,OAAO,CAACC,KAAK,CAAC,wBAAwB,EAAEV,IAAI,CAAC;IAC7C,OAAO,IAAI;EACb;EAEA,OAAO;IACLW,EAAE,EAAE,GAAGX,IAAI,IAAIY,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;IACtEjB,IAAI;IACJ,GAAGQ,UAAU;IACbP,QAAQ;IACRC,YAAY;IACZgB,iBAAiB,EAAEjB,QAAQ;IAC3BE,MAAM;IAAE;IACRC,MAAM;IAAE;IACRC,WAAW;IAAE;IACbC,SAAS;IAAE;IACXC,UAAU,EAAEC,UAAU,CAAChE,QAAQ,GAAG+D,UAAU,GAAG,CAAC;IAChDY,SAAS,EAAEP,IAAI,CAACC,GAAG,CAAC;EACtB,CAAC;AACH;;AAEA;AACA;AACA;AACA,OAAO,SAASO,iBAAiBA,CAACC,SAAS,EAAEC,YAAY,EAAE;EACzD,MAAMC,UAAU,GAAGF,SAAS,CAACE,UAAU,IAAI,EAAE;;EAE7C;EACA,MAAMC,aAAa,GAAGD,UAAU,CAACE,SAAS,CAACC,CAAC,IAAIA,CAAC,CAAC1B,IAAI,KAAKsB,YAAY,CAACtB,IAAI,CAAC;EAE7E,IAAIwB,aAAa,KAAK,CAAC,CAAC,EAAE;IACxB,MAAMG,QAAQ,GAAGJ,UAAU,CAACC,aAAa,CAAC;;IAE1C;IACA,IAAIG,QAAQ,CAACnF,QAAQ,EAAE;MAAA,IAAAoF,iBAAA;MACrB,MAAMtD,SAAS,GAAG,EAAAsD,iBAAA,GAAAD,QAAQ,CAACvF,OAAO,cAAAwF,iBAAA,uBAAhBA,iBAAA,CAAkBtD,SAAS,KAAI,EAAE;MACnD,MAAMuD,aAAa,GAAGf,IAAI,CAACgB,GAAG,CAACxD,SAAS,EAAEqD,QAAQ,CAACpB,UAAU,GAAGe,YAAY,CAACf,UAAU,CAAC;MAExFgB,UAAU,CAACC,aAAa,CAAC,GAAG;QAC1B,GAAGG,QAAQ;QACXpB,UAAU,EAAEsB,aAAa;QACzBX,iBAAiB,EAAEJ,IAAI,CAACiB,GAAG,CAACJ,QAAQ,CAACT,iBAAiB,EAAEI,YAAY,CAACJ,iBAAiB;MACxF,CAAC;IACH,CAAC,MAAM;MACL;MACA,IAAII,YAAY,CAACJ,iBAAiB,GAAGS,QAAQ,CAACT,iBAAiB,EAAE;QAC/DK,UAAU,CAACC,aAAa,CAAC,GAAGF,YAAY;MAC1C;IACF;EACF,CAAC,MAAM;IACL;IACAC,UAAU,CAACS,IAAI,CAACV,YAAY,CAAC;EAC/B;EAEA,OAAO;IACL,GAAGD,SAAS;IACZE,UAAU,EAAE,CAAC,GAAGA,UAAU;EAC5B,CAAC;AACH;;AAEA;AACA;AACA;AACA,OAAO,SAASU,kBAAkBA,CAACZ,SAAS,EAAEa,QAAQ,EAAE;EACtD,OAAO;IACL,GAAGb,SAAS;IACZE,UAAU,EAAE,CAACF,SAAS,CAACE,UAAU,IAAI,EAAE,EAAEY,MAAM,CAACT,CAAC,IAAIA,CAAC,CAACf,EAAE,KAAKuB,QAAQ;EACxE,CAAC;AACH;;AAEA;AACA;AACA;AACA,OAAO,SAASE,wBAAwBA,CAACf,SAAS,EAAEgB,UAAU,EAAE;EAC9D,OAAO;IACL,GAAGhB,SAAS;IACZE,UAAU,EAAE,CAACF,SAAS,CAACE,UAAU,IAAI,EAAE,EAAEY,MAAM,CAACT,CAAC,IAAIA,CAAC,CAAC1B,IAAI,KAAKqC,UAAU;EAC5E,CAAC;AACH;;AAEA;AACA;AACA;AACA,OAAO,SAASC,+BAA+BA,CAACjB,SAAS,EAAE;EACzD,IAAIkB,gBAAgB,GAAG;IAAE,GAAGlB;EAAU,CAAC;EACvC,MAAME,UAAU,GAAG,CAAC,IAAIF,SAAS,CAACE,UAAU,IAAI,EAAE,CAAC,CAAC;EACpD,MAAMiB,QAAQ,GAAG,EAAE;EACnB,IAAIC,SAAS,GAAG,EAAE;EAElBlB,UAAU,CAACmB,OAAO,CAAC,CAACC,MAAM,EAAEC,KAAK,KAAK;IAAA,IAAAC,eAAA;IACpC;IACA,KAAAA,eAAA,GAAIF,MAAM,CAACvG,OAAO,cAAAyG,eAAA,eAAdA,eAAA,CAAgBhD,aAAa,EAAE;MACjC,MAAMiD,MAAM,GAAGC,UAAU,CAACJ,MAAM,CAACvG,OAAO,CAACyD,aAAa,CAAC;MACvD0C,gBAAgB,GAAG;QACjB,GAAGA,gBAAgB;QACnBS,EAAE,EAAElC,IAAI,CAACiB,GAAG,CAAC,CAAC,EAAEQ,gBAAgB,CAACS,EAAE,GAAGF,MAAM;MAC9C,CAAC;MACDL,SAAS,CAACT,IAAI,CAAC;QACbW,MAAM,EAAEA,MAAM,CAAC3G,IAAI;QACnB8G,MAAM;QACNhD,UAAU,EAAE6C,MAAM,CAACvG,OAAO,CAAC0D,UAAU,IAAI;MAC3C,CAAC,CAAC;IACJ;;IAEA;IACA,IAAI6C,MAAM,CAACzC,YAAY,KAAK7E,cAAc,CAACE,MAAM,IAC7CoH,MAAM,CAACzC,YAAY,KAAK7E,cAAc,CAACS,aAAa,EAAE;MACxD6G,MAAM,CAACzB,iBAAiB,IAAI,CAAC;MAE7B,IAAIyB,MAAM,CAACzB,iBAAiB,IAAI,CAAC,EAAE;QACjCsB,QAAQ,CAACR,IAAI,CAACW,MAAM,CAAChC,EAAE,CAAC;MAC1B;IACF;EACF,CAAC,CAAC;;EAEF;EACA4B,gBAAgB,CAAChB,UAAU,GAAGA,UAAU,CAACY,MAAM,CAACc,CAAC,IAAI,CAACT,QAAQ,CAACU,QAAQ,CAACD,CAAC,CAACtC,EAAE,CAAC,CAAC;EAE9E,OAAO;IACLU,SAAS,EAAEkB,gBAAgB;IAC3BE,SAAS;IACTU,cAAc,EAAEX;EAClB,CAAC;AACH;;AAEA;AACA;AACA;AACA,OAAO,SAASY,eAAeA,CAAC/B,SAAS,EAAEgB,UAAU,EAAE;EACrD,OAAO,CAAChB,SAAS,CAACE,UAAU,IAAI,EAAE,EAAE8B,IAAI,CAAC3B,CAAC,IAAIA,CAAC,CAAC1B,IAAI,KAAKqC,UAAU,CAAC;AACtE;;AAEA;AACA;AACA;AACA,OAAO,SAASiB,sBAAsBA,CAACjC,SAAS,EAAE;EAChD,OAAOA,SAAS,CAACE,UAAU,IAAI,EAAE;AACnC;;AAEA;AACA;AACA;AACA,OAAO,SAASgC,cAAcA,CAAClC,SAAS,EAAEsB,MAAM,EAAEa,eAAe,EAAE;EACjE,MAAMC,GAAG,GAAG3C,IAAI,CAAC4C,KAAK,CAAC5C,IAAI,CAACC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC;EAC9C,MAAM4C,KAAK,GAAGF,GAAG,GAAGD,eAAe;EACnC,MAAMI,OAAO,GAAGD,KAAK,IAAIhB,MAAM,CAACvC,MAAM;EAEtC,OAAO;IACLqD,GAAG;IACHE,KAAK;IACLC,OAAO;IACPC,EAAE,EAAElB,MAAM,CAACvC,MAAM;IACjB0D,OAAO,EAAEnB,MAAM,CAACtC;EAClB,CAAC;AACH;;AAEA;AACA;AACA;AACA,OAAO,SAAS0D,kBAAkBA,CAAC1C,SAAS,EAAEyB,MAAM,EAAE;EAAA,IAAAkB,oBAAA,EAAAC,qBAAA,EAAAC,sBAAA;EACpD,MAAMC,mBAAmB,GAAG,CAAC9C,SAAS,CAACE,UAAU,IAAI,EAAE,EAAE6C,IAAI,CAC3D1C,CAAC,IAAIA,CAAC,CAAC1B,IAAI,KAAKtG,cAAc,CAACgB,aACjC,CAAC;EAED,IAAI,CAACyJ,mBAAmB,EAAE;IACxB,OAAO;MAAEE,sBAAsB,EAAE;IAAK,CAAC;EACzC;;EAEA;EACA,MAAMR,EAAE,GAAG/C,IAAI,CAACiB,GAAG,CAAC,EAAE,EAAEjB,IAAI,CAAC4C,KAAK,CAACZ,MAAM,GAAG,CAAC,CAAC,CAAC;;EAE/C;EACA,MAAMwB,WAAW,GAAGxD,IAAI,CAAC4C,KAAK,CAAC,CAAC,EAAAM,oBAAA,GAAA3C,SAAS,CAACkD,SAAS,cAAAP,oBAAA,uBAAnBA,oBAAA,CAAqBQ,GAAG,IAAG,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC;EACxE,MAAMC,SAAS,GAAGpD,SAAS,CAACqD,KAAK,GAAG5D,IAAI,CAAC4C,KAAK,CAAC,CAACrC,SAAS,CAACqD,KAAK,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC;EACjF,MAAMC,YAAY,IAAAV,qBAAA,GAAG5C,SAAS,CAACuD,aAAa,cAAAX,qBAAA,wBAAAC,sBAAA,GAAvBD,qBAAA,CAAyBY,YAAY,cAAAX,sBAAA,uBAArCA,sBAAA,CAAuChB,QAAQ,CAAC,KAAK,CAAC;EAE3E,MAAM4B,YAAY,GAAGR,WAAW,IAAIK,YAAY,GAAGF,SAAS,GAAG,CAAC,CAAC;EACjE,MAAMM,MAAM,GAAGxB,cAAc,CAAClC,SAAS,EAAE;IAAEjB,MAAM,EAAEyD,EAAE;IAAExD,WAAW,EAAE;EAAM,CAAC,EAAEyE,YAAY,CAAC;EAE1F,OAAO;IACL,GAAGC,MAAM;IACTV,sBAAsB,EAAEU,MAAM,CAACnB,OAAO;IACtCoB,mBAAmB,EAAE,CAACD,MAAM,CAACnB,OAAO;IACpCtD,SAAS,EAAE6D,mBAAmB,CAAC7D;EACjC,CAAC;AACH;;AAEA;AACA;AACA;AACA,SAASyC,UAAUA,CAACkC,UAAU,EAAE;EAC9B,MAAMC,KAAK,GAAGD,UAAU,CAACC,KAAK,CAAC,uBAAuB,CAAC;EACvD,IAAI,CAACA,KAAK,EAAE,OAAOC,QAAQ,CAACF,UAAU,CAAC,IAAI,CAAC;EAE5C,MAAM,GAAGG,OAAO,EAAEC,OAAO,EAAEC,QAAQ,CAAC,GAAGJ,KAAK;EAC5C,IAAIvB,KAAK,GAAG,CAAC;EAEb,KAAK,IAAI4B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGJ,QAAQ,CAACC,OAAO,CAAC,EAAEG,CAAC,EAAE,EAAE;IAC1C5B,KAAK,IAAI7C,IAAI,CAAC4C,KAAK,CAAC5C,IAAI,CAACC,MAAM,CAAC,CAAC,GAAGoE,QAAQ,CAACE,OAAO,CAAC,CAAC,GAAG,CAAC;EAC5D;EAEA,IAAIC,QAAQ,EAAE;IACZ3B,KAAK,IAAIwB,QAAQ,CAACG,QAAQ,CAAC;EAC7B;EAEA,OAAO3B,KAAK;AACd;;AAEA;AACA;AACA;AACA,OAAO,SAAS6B,kBAAkBA,CAACC,QAAQ,EAAEC,QAAQ,EAAE;EACrD,MAAMC,eAAe,GAAGrC,sBAAsB,CAACmC,QAAQ,CAAC;EACxD,MAAMG,eAAe,GAAGtC,sBAAsB,CAACoC,QAAQ,CAAC;EAExD,IAAIG,SAAS,GAAG,KAAK;EACrB,IAAIC,YAAY,GAAG,KAAK;;EAExB;EACAH,eAAe,CAACjD,OAAO,CAACC,MAAM,IAAI;IAAA,IAAAoD,gBAAA,EAAAC,gBAAA;IAChC,KAAAD,gBAAA,GAAIpD,MAAM,CAACvG,OAAO,cAAA2J,gBAAA,eAAdA,gBAAA,CAAgB5I,eAAe,EAAE0I,SAAS,GAAG,IAAI;IACrD,KAAAG,gBAAA,GAAIrD,MAAM,CAACvG,OAAO,cAAA4J,gBAAA,eAAdA,gBAAA,CAAgB3J,kBAAkB,EAAEyJ,YAAY,GAAG,IAAI;EAC7D,CAAC,CAAC;;EAEF;EACAF,eAAe,CAAClD,OAAO,CAACC,MAAM,IAAI;IAAA,IAAAsD,gBAAA,EAAAC,gBAAA;IAChC,KAAAD,gBAAA,GAAItD,MAAM,CAACvG,OAAO,cAAA6J,gBAAA,eAAdA,gBAAA,CAAgB3J,qBAAqB,EAAEuJ,SAAS,GAAG,IAAI;IAC3D,KAAAK,gBAAA,GAAIvD,MAAM,CAACvG,OAAO,cAAA8J,gBAAA,eAAdA,gBAAA,CAAgB9I,wBAAwB,EAAE0I,YAAY,GAAG,IAAI;EACnE,CAAC,CAAC;;EAEF;EACA,IAAID,SAAS,IAAIC,YAAY,EAAE;IAC7B,OAAO;MAAED,SAAS,EAAE,KAAK;MAAEC,YAAY,EAAE,KAAK;MAAEK,MAAM,EAAE;IAAK,CAAC;EAChE;EAEA,OAAO;IAAEN,SAAS;IAAEC,YAAY;IAAEK,MAAM,EAAE,CAACN,SAAS,IAAI,CAACC;EAAa,CAAC;AACzE;;AAEA;AACA;AACA;AACA,OAAO,SAASM,eAAeA,CAAC/E,SAAS,EAAEgF,MAAM,GAAG,CAAC,EAAE;EACrD,MAAMC,iBAAiB,GAAGjF,SAAS,CAACkF,UAAU,IAAI,CAAC;EACnD,MAAMC,aAAa,GAAG1F,IAAI,CAACgB,GAAG,CAAC,CAAC,EAAEwE,iBAAiB,GAAGD,MAAM,CAAC;EAE7D,IAAIG,aAAa,IAAI,CAAC,EAAE;IACtB,OAAO;MACL,GAAGnF,SAAS;MACZkF,UAAU,EAAE,CAAC;MACbvD,EAAE,EAAE,CAAC;MACLyD,MAAM,EAAE;IACV,CAAC;EACH;EAEA,OAAO;IACL,GAAGpF,SAAS;IACZkF,UAAU,EAAEC;EACd,CAAC;AACH;;AAEA;AACA;AACA;AACA,OAAO,SAASE,gBAAgBA,CAACrF,SAAS,EAAEgF,MAAM,GAAG,CAAC,EAAE;EACtD,MAAMC,iBAAiB,GAAGjF,SAAS,CAACkF,UAAU,IAAI,CAAC;EACnD,MAAMC,aAAa,GAAG1F,IAAI,CAACiB,GAAG,CAAC,CAAC,EAAEuE,iBAAiB,GAAGD,MAAM,CAAC;EAE7D,OAAO;IACL,GAAGhF,SAAS;IACZkF,UAAU,EAAEC;EACd,CAAC;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}