{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Hakty\\\\Desktop\\\\AI-Dungeon-Master\\\\frontend\\\\src\\\\components\\\\CombatTracker.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// frontend/src/components/CombatTracker.jsx - WITH SPELL DAMAGE + CONCENTRATION TRACKING\nimport { useState } from 'react';\nimport { executeAttack, nextTurn, checkCombatEnd, getCurrentCombatant, updateCombatant, applyDamage } from '../utils/combatSystem';\nimport { SPELL_DATABASE, getSpellSlots, canCastSpell, castSpell, shortRest, getSpellAttackBonus, getSpellSaveDC, calculateSpellDamage, rollSpellDamage, SPELLCASTING_CLASSES, isWarlockPactMagic, getWarlockPactSlots } from '../utils/spellSystem';\nimport { createStatusEffect, applyStatusEffect, STATUS_EFFECTS, DURATION_TYPES } from '../utils/statusEffectSystem';\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  HELPERS\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction rollD20() {\n  return Math.floor(Math.random() * 20) + 1;\n}\n\n/** Spells that require concentration */\nconst CONCENTRATION_SPELLS = new Set(['bless', 'bane', 'faerie_fire', 'fog_cloud', 'guiding_bolt', 'hold_person', 'invisibility', 'magic_weapon', 'mirror_image', 'misty_step', 'prayer_of_healing', 'silence', 'spider_climb', 'spiritual_weapon', 'arcane_eye', 'banishment', 'black_tentacles', 'confusion', 'conjure_animals', 'conjure_woodland_beings', 'control_water', 'dimension_door', 'dominate_beast', 'evards_black_tentacles', 'faithful_hound', 'fire_shield', 'freedom_of_movement', 'giant_insect', 'greater_invisibility', 'guardian_of_faith', 'hallucinatory_terrain', 'ice_storm', 'locate_creature', 'phantasmal_killer', 'polymorph', 'resilient_sphere', 'stone_skin', 'wall_of_fire', 'animate_objects', 'antilife_shell', 'arcane_hand', 'cloudkill', 'conjure_elemental', 'contact_other_plane', 'control_winds', 'danse_macabre', 'dawn', 'destructive_wave', 'dominate_person', 'far_step', 'grappling_vine', 'haste', 'hold_monster', 'insect_plague', 'legend_lore', 'maelstrom', 'mass_cure_wounds', 'mislead', 'modify_memory', 'passwall', 'planar_binding', 'seeming', 'synaptic_static', 'teleportation_circle', 'wall_of_force', 'wall_of_stone', 'wind_walk', 'witch_bolt', 'call_lightning', 'conjure_barrage', 'conjure_volley', 'sleet_storm', 'slow', 'speak_with_dead', 'summon_lesser_demons', 'thunder_step', 'tidal_wave', 'vitriolic_sphere', 'web', 'wind_wall', 'wrathful_smite', 'locate_object', 'darkvision', 'enhance_ability', 'enlarge_reduce', 'flame_blade', 'heat_metal', 'hold_person', 'levitate', 'melf_acid_arrow', 'mind_spike', 'moonbeam', 'pass_without_trace', 'protection_from_energy', 'rope_trick', 'see_invisibility', 'shatter', 'blindness_deafness', 'blur', 'crown_of_madness', 'darkness', 'detect_thoughts', 'enthrall', 'flaming_sphere', 'gust_of_wind', 'hold_person', 'magic_mouth', 'maximilian_earthen_grasp', 'mirror_image', 'nystul_magic_aura', 'phantasmal_force', 'ray_of_enfeeblement', 'shadow_blade']);\n\n/** Conditions that break concentration */\nconst CONCENTRATION_BREAKING_CONDITIONS = new Set([STATUS_EFFECTS.INCAPACITATED, STATUS_EFFECTS.STUNNED, STATUS_EFFECTS.PARALYZED, STATUS_EFFECTS.UNCONSCIOUS, STATUS_EFFECTS.PETRIFIED]);\n\n/** Map spell types that apply status effects */\nconst SPELL_STATUS_EFFECTS = {\n  hold_person: {\n    type: STATUS_EFFECTS.PARALYZED,\n    duration: 10,\n    durationType: DURATION_TYPES.SAVE_ENDS,\n    saveDC: null\n  },\n  sleep: {\n    type: STATUS_EFFECTS.UNCONSCIOUS,\n    duration: 1,\n    durationType: DURATION_TYPES.MINUTES\n  },\n  haste: {\n    type: STATUS_EFFECTS.HASTED,\n    duration: 10,\n    durationType: DURATION_TYPES.ROUNDS\n  },\n  invisibility: {\n    type: STATUS_EFFECTS.INVISIBLE,\n    duration: 60,\n    durationType: DURATION_TYPES.MINUTES\n  },\n  greater_invisibility: {\n    type: STATUS_EFFECTS.INVISIBLE,\n    duration: 10,\n    durationType: DURATION_TYPES.ROUNDS\n  }\n};\n\n/** Colour band per spell level */\nfunction spellLevelColor(level) {\n  const c = ['#4CAF50', '#2196F3', '#03A9F4', '#00BCD4', '#009688', '#8BC34A', '#CDDC39', '#FFEB3B', '#FFC107', '#FF9800'];\n  return c[level] || '#888';\n}\n\n/** Get accessible spells for combat (cantrips + prepared/known) */\nfunction getCombatSpells(character) {\n  var _character$spells, _character$spells2, _character$spells3;\n  const cantrips = (((_character$spells = character.spells) === null || _character$spells === void 0 ? void 0 : _character$spells.cantrips) || []).map(k => ({\n    key: k,\n    ...SPELL_DATABASE[k]\n  })).filter(s => s.name);\n  const prepared = (((_character$spells2 = character.spells) === null || _character$spells2 === void 0 ? void 0 : _character$spells2.prepared) || []).map(k => ({\n    key: k,\n    ...SPELL_DATABASE[k]\n  })).filter(s => s.name);\n  const known = (((_character$spells3 = character.spells) === null || _character$spells3 === void 0 ? void 0 : _character$spells3.known) || []).map(k => ({\n    key: k,\n    ...SPELL_DATABASE[k]\n  })).filter(s => s.name);\n  const all = [...cantrips];\n  [...prepared, ...known].forEach(s => {\n    if (!all.find(a => a.key === s.key)) all.push(s);\n  });\n  return all.filter(s => s.damage || s.healing || SPELL_STATUS_EFFECTS[s.key] || ['shield', 'misty_step', 'counterspell', 'fly', 'haste', 'hold_person', 'sleep', 'invisibility', 'greater_invisibility', 'spiritual_weapon'].includes(s.key));\n}\n\n/** Check if a spell requires concentration */\nfunction isConcentrationSpell(spell) {\n  return spell.concentration === true || CONCENTRATION_SPELLS.has(spell.key);\n}\n\n/** Roll a concentration saving throw. Returns { passed, roll, dc } */\nfunction rollConcentrationCheck(damageTaken) {\n  const dc = Math.max(10, Math.floor(damageTaken / 2));\n  const roll = rollD20();\n  return {\n    passed: roll >= dc,\n    roll,\n    dc\n  };\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  CONCENTRATION WARNING MODAL\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nfunction ConcentrationWarningModal({\n  currentSpell,\n  newSpell,\n  onDropAndCast,\n  onCancel\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: 'fixed',\n      inset: 0,\n      backgroundColor: 'rgba(0,0,0,0.85)',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      zIndex: 2000\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#1a0a2e',\n        border: '2px solid #9C27B0',\n        borderRadius: '12px',\n        padding: '24px',\n        maxWidth: '400px',\n        width: '90%',\n        boxShadow: '0 0 30px rgba(156,39,176,0.5)'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: '24px',\n          textAlign: 'center',\n          marginBottom: '12px'\n        },\n        children: \"\\uD83D\\uDD2E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          margin: '0 0 12px 0',\n          color: '#CE93D8',\n          textAlign: 'center'\n        },\n        children: \"Concentration Conflict\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: '#ccc',\n          fontSize: '14px',\n          textAlign: 'center',\n          marginBottom: '8px'\n        },\n        children: [\"You are already concentrating on \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          style: {\n            color: '#CE93D8'\n          },\n          children: currentSpell\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 44\n        }, this), \".\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: '#aaa',\n          fontSize: '13px',\n          textAlign: 'center',\n          marginBottom: '20px'\n        },\n        children: [\"Casting \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          style: {\n            color: '#CE93D8'\n          },\n          children: newSpell\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 19\n        }, this), \" will end your current concentration. Do you want to drop \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: currentSpell\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 31\n        }, this), \" and cast \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: newSpell\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 72\n        }, this), \"?\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: '10px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onDropAndCast,\n          style: {\n            flex: 1,\n            padding: '10px',\n            backgroundColor: '#6A1B9A',\n            color: 'white',\n            border: 'none',\n            borderRadius: '8px',\n            cursor: 'pointer',\n            fontWeight: 'bold',\n            fontSize: '14px'\n          },\n          children: \"Drop & Cast\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onCancel,\n          style: {\n            flex: 1,\n            padding: '10px',\n            backgroundColor: '#333',\n            color: '#aaa',\n            border: '1px solid #555',\n            borderRadius: '8px',\n            cursor: 'pointer',\n            fontSize: '14px'\n          },\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 128,\n    columnNumber: 5\n  }, this);\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  SPELL CAST PANEL (sub-component)\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n_c = ConcentrationWarningModal;\nfunction SpellCastPanel({\n  caster,\n  combatSpells,\n  selectedTarget,\n  onSpellResult,\n  onClose\n}) {\n  _s();\n  var _caster$spellSlots;\n  const [selectedSpell, setSelectedSpell] = useState(null);\n  const [upcastLevel, setUpcastLevel] = useState(null);\n  const [castResult, setCastResult] = useState(null);\n  const [concWarning, setConcWarning] = useState(null); // { currentSpell, newSpell, pendingCast }\n\n  const currentSlots = ((_caster$spellSlots = caster.spellSlots) === null || _caster$spellSlots === void 0 ? void 0 : _caster$spellSlots.current) || getSpellSlots(caster);\n  const spellAttack = getSpellAttackBonus(caster);\n  const spellSaveDC = getSpellSaveDC(caster);\n  const isWarlock = isWarlockPactMagic(caster);\n  const pactSlotInfo = isWarlock ? getWarlockPactSlots(caster) : null;\n  // For Warlocks, remaining pact slots live at index (pactLevel - 1)\n  const pactSlotsLeft = isWarlock ? currentSlots[pactSlotInfo.slotLevel - 1] || 0 : null;\n\n  // Current concentration spell on this caster\n  const activeConc = caster.concentrationSpell || null;\n  const executeCast = (spell, slotLevel) => {\n    const castOutcome = castSpell(caster, spell, slotLevel > 0 ? slotLevel : null);\n    if (!castOutcome.success) {\n      alert(castOutcome.message);\n      return;\n    }\n    const updatedCaster = castOutcome.character;\n\n    // Track concentration on character\n    const isConc = isConcentrationSpell(spell);\n    if (isConc) {\n      updatedCaster.concentrationSpell = spell.name;\n    }\n    let result = {\n      spellName: spell.name,\n      casterName: caster.name,\n      targetName: (selectedTarget === null || selectedTarget === void 0 ? void 0 : selectedTarget.name) || 'ally',\n      slotLevel,\n      updatedCaster,\n      damage: 0,\n      healing: 0,\n      hit: null,\n      critical: false,\n      statusApplied: null,\n      isConcentration: isConc,\n      droppedConcentration: activeConc,\n      log: ''\n    };\n\n    // â”€â”€ DAMAGE spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    if (spell.damage && selectedTarget) {\n      if (spell.key === 'magic_missile') {\n        const dmgStr = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.damage;\n        const rolled = rollSpellDamage(dmgStr);\n        result.damage = rolled.total;\n        result.hit = true;\n        result.log = `âœ¨ ${caster.name} fires Magic Missile at ${selectedTarget.name} for ${rolled.total} force damage! (auto-hit)`;\n      } else if (spell.key === 'sacred_flame') {\n        const saveRoll = rollD20();\n        const targetSave = selectedTarget.dex ? Math.floor((selectedTarget.dex - 10) / 2) : 0;\n        const saved = saveRoll + targetSave >= spellSaveDC;\n        if (!saved) {\n          const dmgStr = calculateSpellDamage(spell, caster.level) || spell.damage;\n          const rolled = rollSpellDamage(dmgStr);\n          result.damage = rolled.total;\n          result.hit = true;\n          result.log = `ðŸ”¥ Sacred Flame hits ${selectedTarget.name} for ${rolled.total} radiant damage! (DEX save ${saveRoll} failed vs DC ${spellSaveDC})`;\n        } else {\n          result.hit = false;\n          result.log = `ðŸ”¥ ${selectedTarget.name} saves against Sacred Flame! (rolled ${saveRoll} vs DC ${spellSaveDC})`;\n        }\n      } else if (['fireball', 'lightning_bolt', 'thunderwave', 'burning_hands', 'ice_storm', 'cone_of_cold', 'chain_lightning', 'disintegrate', 'finger_of_death', 'meteor_swarm'].includes(spell.key)) {\n        const saveRoll = rollD20();\n        const targetDex = selectedTarget.dex ? Math.floor((selectedTarget.dex - 10) / 2) : 0;\n        const saved = saveRoll + targetDex >= spellSaveDC;\n        const dmgStr = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.damage;\n        const rolled = rollSpellDamage(dmgStr);\n        result.damage = saved ? Math.floor(rolled.total / 2) : rolled.total;\n        result.hit = true;\n        result.log = saved ? `ðŸ’¥ ${caster.name} casts ${spell.name}! ${selectedTarget.name} saves (${saveRoll} vs DC ${spellSaveDC}) â€” takes ${result.damage} ${spell.damageType} damage (half).` : `ðŸ’¥ ${caster.name} casts ${spell.name}! ${selectedTarget.name} fails save (${saveRoll} vs DC ${spellSaveDC}) â€” takes ${result.damage} ${spell.damageType} damage!`;\n      } else {\n        const d20 = rollD20();\n        const total = d20 + spellAttack;\n        const crit = d20 === 20;\n        const hit = crit || total >= (selectedTarget.ac || selectedTarget.armorClass || 12);\n        if (hit) {\n          const dmgStr = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.damage;\n          const rolled = rollSpellDamage(crit ? dmgStr.replace(/(\\d+)d/, (_, n) => `${parseInt(n) * 2}d`) : dmgStr);\n          result.damage = rolled.total;\n          result.hit = true;\n          result.critical = crit;\n          result.log = crit ? `ðŸ’¥ CRITICAL! ${caster.name}'s ${spell.name} hits ${selectedTarget.name} for ${rolled.total} ${spell.damageType} damage!` : `âœ¨ ${caster.name}'s ${spell.name} hits ${selectedTarget.name} for ${rolled.total} ${spell.damageType} damage! (rolled ${total} vs AC ${selectedTarget.ac || selectedTarget.armorClass || '?'})`;\n        } else {\n          result.hit = false;\n          result.log = `âŒ ${caster.name}'s ${spell.name} misses ${selectedTarget.name}! (rolled ${total} vs AC ${selectedTarget.ac || selectedTarget.armorClass || '?'})`;\n        }\n      }\n    }\n    // â”€â”€ HEALING spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    else if (spell.healing) {\n      const dmgStr = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.healing;\n      const rolled = rollSpellDamage(dmgStr);\n      const scAbil = {\n        Cleric: 'WIS',\n        Druid: 'WIS',\n        Paladin: 'CHA',\n        Bard: 'CHA',\n        Ranger: 'WIS'\n      };\n      const abilKey = scAbil[caster.class] || 'INT';\n      const mod = caster.abilities ? Math.floor((caster.abilities[abilKey] - 10) / 2) : 0;\n      result.healing = rolled.total + mod;\n      result.log = `ðŸ’š ${caster.name} casts ${spell.name} and heals for ${result.healing} HP!`;\n    }\n    // â”€â”€ STATUS EFFECT spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    else if (SPELL_STATUS_EFFECTS[spell.key]) {\n      var _effectDef$saveDC;\n      const effectDef = SPELL_STATUS_EFFECTS[spell.key];\n      const dc = (_effectDef$saveDC = effectDef.saveDC) !== null && _effectDef$saveDC !== void 0 ? _effectDef$saveDC : spellSaveDC;\n      result.statusApplied = {\n        ...effectDef,\n        saveDC: dc,\n        spellName: spell.name\n      };\n      result.log = `ðŸŒ€ ${caster.name} casts ${spell.name}${selectedTarget ? ` on ${selectedTarget.name}` : ''}!`;\n    }\n    // â”€â”€ UTILITY spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    else {\n      result.log = `âœ¨ ${caster.name} casts ${spell.name}!`;\n    }\n\n    // Append concentration note\n    if (isConc) {\n      result.log += ` [Concentrating]`;\n      if (activeConc) result.log = `[Dropped ${activeConc}] ` + result.log;\n    }\n    setCastResult(result);\n    onSpellResult(result);\n  };\n  const handleCast = () => {\n    if (!selectedSpell) return;\n    const spell = selectedSpell;\n    const slotLevel = upcastLevel !== null && upcastLevel !== void 0 ? upcastLevel : spell.level || 0;\n\n    // Check concentration conflict\n    if (isConcentrationSpell(spell) && activeConc && activeConc !== spell.name) {\n      setConcWarning({\n        currentSpell: activeConc,\n        newSpell: spell.name,\n        pendingCast: () => executeCast(spell, slotLevel)\n      });\n      return;\n    }\n    executeCast(spell, slotLevel);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [concWarning && /*#__PURE__*/_jsxDEV(ConcentrationWarningModal, {\n      currentSpell: concWarning.currentSpell,\n      newSpell: concWarning.newSpell,\n      onDropAndCast: () => {\n        concWarning.pendingCast();\n        setConcWarning(null);\n      },\n      onCancel: () => setConcWarning(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#12012a',\n        border: '2px solid #9C27B0',\n        borderRadius: '10px',\n        padding: '15px',\n        marginTop: '10px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          marginBottom: '12px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          style: {\n            margin: 0,\n            color: '#CE93D8'\n          },\n          children: \"\\u2728 Cast a Spell\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          style: {\n            background: 'none',\n            border: 'none',\n            color: '#888',\n            cursor: 'pointer',\n            fontSize: '18px'\n          },\n          children: \"\\u2715\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 371,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 9\n      }, this), activeConc && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '6px 10px',\n          backgroundColor: 'rgba(156,39,176,0.15)',\n          border: '1px solid #9C27B0',\n          borderRadius: '6px',\n          marginBottom: '10px',\n          fontSize: '12px',\n          color: '#CE93D8',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '6px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uD83D\\uDD2E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"Concentrating on \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: activeConc\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 36\n          }, this), \" \\u2014 casting another concentration spell will end this.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: '12px',\n          color: '#888',\n          marginBottom: '10px'\n        },\n        children: [\"Spell Attack: \", /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            color: '#CE93D8'\n          },\n          children: [\"+\", spellAttack]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 25\n        }, this), \" \\xA0|\\xA0 Save DC: \", /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            color: '#CE93D8'\n          },\n          children: spellSaveDC\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 20\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 9\n      }, this), isWarlock ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          gap: '10px',\n          marginBottom: '12px',\n          padding: '8px 12px',\n          backgroundColor: pactSlotsLeft > 0 ? '#1a0a2e' : '#1a1a1a',\n          border: `2px solid ${pactSlotsLeft > 0 ? '#9C27B0' : '#333'}`,\n          borderRadius: '8px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            fontSize: '18px'\n          },\n          children: \"\\uD83D\\uDD2E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 410,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '13px',\n              fontWeight: 'bold',\n              color: pactSlotsLeft > 0 ? '#CE93D8' : '#555'\n            },\n            children: [\"Pact Magic Slots \\u2014 Level \", pactSlotInfo.slotLevel]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 412,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '11px',\n              color: '#888'\n            },\n            children: [pactSlotsLeft, \" / \", pactSlotInfo.slotCount, \" remaining\", pactSlotsLeft === 0 && ' â€” Short rest to recover!']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 415,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '4px',\n            marginLeft: 'auto'\n          },\n          children: Array.from({\n            length: pactSlotInfo.slotCount\n          }).map((_, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '12px',\n              height: '12px',\n              borderRadius: '50%',\n              backgroundColor: i < pactSlotsLeft ? '#9C27B0' : '#333',\n              border: '1px solid #555'\n            }\n          }, i, false, {\n            fileName: _jsxFileName,\n            lineNumber: 423,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: '6px',\n          flexWrap: 'wrap',\n          marginBottom: '12px'\n        },\n        children: getSpellSlots(caster).map((max, i) => {\n          if (max === 0) return null;\n          const cur = currentSlots[i] || 0;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              padding: '4px 8px',\n              backgroundColor: cur > 0 ? '#1a0a2e' : '#1a1a1a',\n              border: `1px solid ${cur > 0 ? spellLevelColor(i + 1) : '#333'}`,\n              borderRadius: '4px',\n              fontSize: '11px',\n              color: cur > 0 ? spellLevelColor(i + 1) : '#555'\n            },\n            children: [\"L\", i + 1, \": \", cur, \"/\", max]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 439,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: 'repeat(auto-fill, minmax(160px, 1fr))',\n          gap: '8px',\n          marginBottom: '12px',\n          maxHeight: '200px',\n          overflowY: 'auto'\n        },\n        children: [combatSpells.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: '#666',\n            fontStyle: 'italic',\n            padding: '10px',\n            gridColumn: '1/-1'\n          },\n          children: \"No combat spells available. Open SpellBook to learn spells.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 457,\n          columnNumber: 13\n        }, this), combatSpells.map(spell => {\n          // For Warlocks, use canCastSpell() which checks pact slot level correctly\n          const hasSlotsOrCantrip = spell.level === 0 || (isWarlock ? canCastSpell(caster, spell) : (currentSlots[spell.level - 1] || 0) > 0);\n          const isSelected = (selectedSpell === null || selectedSpell === void 0 ? void 0 : selectedSpell.key) === spell.key;\n          const isConc = isConcentrationSpell(spell);\n          const isActiveConc = activeConc === spell.name;\n          return /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              setSelectedSpell(spell);\n              setUpcastLevel(spell.level);\n              setCastResult(null);\n            },\n            disabled: !hasSlotsOrCantrip,\n            style: {\n              padding: '8px 10px',\n              backgroundColor: isSelected ? '#3a0a5a' : '#1a0a2e',\n              border: `2px solid ${isActiveConc ? '#9C27B0' : isSelected ? '#CE93D8' : hasSlotsOrCantrip ? spellLevelColor(spell.level) : '#333'}`,\n              borderRadius: '6px',\n              cursor: hasSlotsOrCantrip ? 'pointer' : 'not-allowed',\n              opacity: hasSlotsOrCantrip ? 1 : 0.4,\n              textAlign: 'left',\n              transition: 'all 0.15s',\n              boxShadow: isActiveConc ? '0 0 8px rgba(156,39,176,0.6)' : 'none'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '13px',\n                fontWeight: 'bold',\n                color: spellLevelColor(spell.level),\n                marginBottom: '3px'\n              },\n              children: spell.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 484,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '10px',\n                color: '#888'\n              },\n              children: [spell.level === 0 ? 'Cantrip' : `Lvl ${spell.level}`, spell.damage && ` â€¢ ${spell.damage} ${spell.damageType}`, spell.healing && ` â€¢ Heals ${spell.healing}`, isConc && /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  color: '#9C27B0'\n                },\n                children: \" \\u2022 \\uD83D\\uDD2E Conc.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 491,\n                columnNumber: 30\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 487,\n              columnNumber: 17\n            }, this)]\n          }, spell.key, true, {\n            fileName: _jsxFileName,\n            lineNumber: 468,\n            columnNumber: 15\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 455,\n        columnNumber: 9\n      }, this), selectedSpell && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          backgroundColor: '#0a0018',\n          borderRadius: '8px',\n          padding: '12px',\n          border: `1px solid ${spellLevelColor(selectedSpell.level)}`\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '8px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              fontWeight: 'bold',\n              color: spellLevelColor(selectedSpell.level)\n            },\n            children: selectedSpell.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 507,\n            columnNumber: 15\n          }, this), isConcentrationSpell(selectedSpell) && /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              marginLeft: '8px',\n              fontSize: '11px',\n              color: '#CE93D8',\n              backgroundColor: 'rgba(156,39,176,0.2)',\n              padding: '2px 6px',\n              borderRadius: '4px',\n              border: '1px solid #6A1B9A'\n            },\n            children: \"\\uD83D\\uDD2E Concentration\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 509,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: '#888',\n              fontSize: '12px',\n              marginLeft: '10px'\n            },\n            children: [selectedSpell.castingTime, \" \\u2022 \", selectedSpell.range]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 519,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '13px',\n            color: '#ccc',\n            marginBottom: '10px'\n          },\n          children: selectedSpell.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 521,\n          columnNumber: 13\n        }, this), isConcentrationSpell(selectedSpell) && activeConc && activeConc !== selectedSpell.name && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '8px 10px',\n            backgroundColor: 'rgba(255,152,0,0.1)',\n            border: '1px solid #ff9800',\n            borderRadius: '6px',\n            marginBottom: '10px',\n            fontSize: '12px',\n            color: '#ffb74d'\n          },\n          children: [\"\\u26A0\\uFE0F Casting this will drop \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: activeConc\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 534,\n            columnNumber: 43\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 525,\n          columnNumber: 15\n        }, this), !isWarlock && selectedSpell.level > 0 && selectedSpell.upcastBonus && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '10px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '11px',\n              color: '#888',\n              marginBottom: '6px'\n            },\n            children: \"Cast at level:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 541,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: '6px',\n              flexWrap: 'wrap'\n            },\n            children: Array.from({\n              length: 10 - selectedSpell.level\n            }, (_, i) => selectedSpell.level + i).map(lvl => {\n              const slotsLeft = currentSlots[lvl - 1] || 0;\n              if (getSpellSlots(caster)[lvl - 1] === 0) return null;\n              return /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setUpcastLevel(lvl),\n                disabled: slotsLeft === 0,\n                style: {\n                  padding: '4px 10px',\n                  backgroundColor: upcastLevel === lvl ? spellLevelColor(lvl) : '#1a0a2e',\n                  color: upcastLevel === lvl ? '#000' : slotsLeft > 0 ? '#eee' : '#555',\n                  border: 'none',\n                  borderRadius: '4px',\n                  cursor: slotsLeft > 0 ? 'pointer' : 'not-allowed',\n                  fontSize: '12px',\n                  opacity: slotsLeft > 0 ? 1 : 0.4\n                },\n                children: [\"L\", lvl, \" (\", slotsLeft, \")\"]\n              }, lvl, true, {\n                fileName: _jsxFileName,\n                lineNumber: 547,\n                columnNumber: 23\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 542,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 540,\n          columnNumber: 15\n        }, this), isWarlock && selectedSpell.level > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '10px',\n            padding: '6px 10px',\n            backgroundColor: 'rgba(156,39,176,0.1)',\n            border: '1px solid #6A1B9A',\n            borderRadius: '6px',\n            fontSize: '11px',\n            color: '#CE93D8'\n          },\n          children: [\"\\uD83D\\uDD2E Pact Magic: always casts at level \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: pactSlotInfo.slotLevel\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 580,\n            columnNumber: 54\n          }, this), \" \\u2014 no slot choice needed\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 571,\n          columnNumber: 15\n        }, this), !selectedTarget && selectedSpell.damage && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: '#ff9800',\n            fontSize: '12px',\n            marginBottom: '8px'\n          },\n          children: \"\\u26A0\\uFE0F Select a target enemy above before casting this spell\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 585,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleCast,\n          disabled: !!(selectedSpell.damage && !selectedTarget),\n          style: {\n            width: '100%',\n            padding: '10px',\n            backgroundColor: selectedSpell.damage && !selectedTarget ? '#333' : '#7B1FA2',\n            color: 'white',\n            border: 'none',\n            borderRadius: '6px',\n            cursor: selectedSpell.damage && !selectedTarget ? 'not-allowed' : 'pointer',\n            fontWeight: 'bold',\n            fontSize: '15px',\n            transition: 'background 0.2s'\n          },\n          children: [\"\\u2728 Cast \", selectedSpell.name, isWarlock && selectedSpell.level > 0 ? ` (Pact Lvl ${pactSlotInfo.slotLevel})` : upcastLevel && upcastLevel > selectedSpell.level ? ` (Lvl ${upcastLevel})` : '']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 590,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 500,\n        columnNumber: 11\n      }, this), castResult && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '10px',\n          padding: '10px',\n          backgroundColor: castResult.hit === false ? '#1a0a0a' : '#0a1a0a',\n          borderRadius: '6px',\n          border: `1px solid ${castResult.hit === false ? '#f44336' : '#4CAF50'}`,\n          fontSize: '13px',\n          color: '#eee'\n        },\n        children: castResult.log\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 613,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 362,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  MAIN COMBAT TRACKER\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n_s(SpellCastPanel, \"Kf8N/u5IBMRSMkWLC3VK8SqsLA8=\");\n_c2 = SpellCastPanel;\nexport default function CombatTracker({\n  combat,\n  onUpdate,\n  onEnd,\n  party = [],\n  updateParty\n}) {\n  _s2();\n  var _currentCombatant$att;\n  const [selectedTarget, setSelectedTarget] = useState(null);\n  const [combatLog, setCombatLog] = useState([]);\n  const [showSpellPanel, setShowSpellPanel] = useState(false);\n  if (!combat || !combat.isActive) return null;\n  const currentCombatant = getCurrentCombatant(combat);\n  const isPlayerTurn = !(currentCombatant !== null && currentCombatant !== void 0 && currentCombatant.isEnemy);\n\n  // Find the full party character for the current combatant (so we have spell data)\n  const partyCharacter = party.find(p => p.name === (currentCombatant === null || currentCombatant === void 0 ? void 0 : currentCombatant.name)) || currentCombatant;\n  const isSpellcaster = SPELLCASTING_CLASSES[partyCharacter === null || partyCharacter === void 0 ? void 0 : partyCharacter.class];\n  const combatSpells = isSpellcaster ? getCombatSpells(partyCharacter) : [];\n  const addLog = (entry, prevLog = combatLog) => {\n    setCombatLog([entry, ...prevLog]);\n    return [entry, ...prevLog];\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  SHORT REST â€” Warlocks recover all Pact Magic slots\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleShortRest = () => {\n    if (!updateParty) return;\n    let anyRecovered = false;\n    const updatedParty = party.map(p => {\n      if (!isWarlockPactMagic(p)) return p;\n      const recovered = shortRest(p);\n      const pact = getWarlockPactSlots(p);\n      addLog(`ðŸ”® ${p.name} takes a short rest and recovers ${pact.slotCount} Pact Magic slot${pact.slotCount > 1 ? 's' : ''} (level ${pact.slotLevel})!`);\n      anyRecovered = true;\n      return recovered;\n    });\n    if (!anyRecovered) {\n      addLog('â›º Short rest taken. (Only Warlocks recover spell slots on a short rest.)');\n    }\n    updateParty(updatedParty);\n    console.log('[ShortRest] Party updated after short rest.');\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  Helper: clear concentration from a character\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const clearConcentration = (character, reason = '') => {\n    if (!character.concentrationSpell) return character;\n    console.log(`[Concentration] ${character.name} lost concentration on ${character.concentrationSpell}${reason ? ': ' + reason : ''}`);\n    return {\n      ...character,\n      concentrationSpell: null\n    };\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  Helper: run a concentration check after taking damage\n  //  Returns { character (possibly cleared), log entry or null }\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleConcentrationCheck = (character, damageTaken) => {\n    if (!character.concentrationSpell) return {\n      character,\n      logEntry: null\n    };\n    const check = rollConcentrationCheck(damageTaken);\n    if (check.passed) {\n      return {\n        character,\n        logEntry: `ðŸ”® ${character.name} passes concentration check (rolled ${check.roll} vs DC ${check.dc}) â€” still concentrating on ${character.concentrationSpell}.`\n      };\n    } else {\n      const cleared = clearConcentration(character, 'failed concentration check');\n      return {\n        character: cleared,\n        logEntry: `ðŸ’” ${character.name} FAILS concentration check (rolled ${check.roll} vs DC ${check.dc}) â€” ${character.concentrationSpell} ends!`\n      };\n    }\n  };\n\n  // â”€â”€ ATTACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleAttack = (attackIndex = 0) => {\n    if (!selectedTarget) {\n      alert('Select a target first!');\n      return;\n    }\n    const result = executeAttack(currentCombatant, selectedTarget, attackIndex);\n    const logEntry = result.attackRoll.isCritical ? `ðŸ’¥ CRITICAL HIT! ${result.attacker} hits ${result.target} with ${result.attack} for ${result.damage} ${result.damageType} damage!` : result.attackRoll.isFumble ? `âŒ FUMBLE! ${result.attacker} misses ${result.target}!` : result.attackRoll.isHit ? `âš”ï¸ ${result.attacker} hits ${result.target} with ${result.attack} for ${result.damage} ${result.damageType} damage!` : `ðŸ›¡ï¸ ${result.attacker} misses ${result.target}!`;\n    let newLog = addLog(logEntry);\n    if (result.attackRoll.isHit && result.damage > 0) {\n      const damagedTarget = applyDamage(selectedTarget, result.damage);\n      const updatedCombat = updateCombatant(combat, selectedTarget.id || selectedTarget.name, damagedTarget);\n      if (damagedTarget.isDead) addLog(`ðŸ’€ ${damagedTarget.name} has been defeated!`, newLog);\n      onUpdate(updatedCombat);\n\n      // Concentration check if target is a party member concentrating\n      if (updateParty) {\n        const partyTarget = party.find(p => p.name === selectedTarget.name);\n        if (partyTarget !== null && partyTarget !== void 0 && partyTarget.concentrationSpell) {\n          const {\n            character: afterCheck,\n            logEntry: checkLog\n          } = handleConcentrationCheck(partyTarget, result.damage);\n          if (checkLog) addLog(checkLog);\n          const updatedParty = party.map(p => p.name === afterCheck.name ? afterCheck : p);\n          updateParty(updatedParty);\n        }\n      }\n      const endCheck = checkCombatEnd(updatedCombat);\n      if (endCheck.ended) {\n        setTimeout(() => onEnd(endCheck), 1000);\n        return;\n      }\n    }\n    handleEndTurn();\n  };\n\n  // â”€â”€ SPELL RESULT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleSpellResult = result => {\n    setShowSpellPanel(false);\n    addLog(result.log);\n    let currentCombatState = {\n      ...combat\n    };\n\n    // 1. Update caster's spell slots (and concentration state) in the party store\n    if (updateParty && result.updatedCaster) {\n      const updatedParty = party.map(p => p.name === result.updatedCaster.name ? result.updatedCaster : p);\n      updateParty(updatedParty);\n    }\n\n    // 2. Apply damage to target\n    if (result.damage > 0 && result.hit && selectedTarget) {\n      const damagedTarget = applyDamage(selectedTarget, result.damage, result.damageType);\n      currentCombatState = updateCombatant(currentCombatState, selectedTarget.id || selectedTarget.name, damagedTarget);\n      if (damagedTarget.isDead) addLog(`ðŸ’€ ${damagedTarget.name} has been defeated!`);\n      onUpdate(currentCombatState);\n\n      // Concentration check for the damaged target if they're a party member concentrating\n      if (updateParty) {\n        const partyTarget = party.find(p => p.name === selectedTarget.name);\n        if (partyTarget !== null && partyTarget !== void 0 && partyTarget.concentrationSpell) {\n          const {\n            character: afterCheck,\n            logEntry: checkLog\n          } = handleConcentrationCheck(partyTarget, result.damage);\n          if (checkLog) addLog(checkLog);\n          const updatedParty = party.map(p => p.name === afterCheck.name ? afterCheck : p);\n          updateParty(updatedParty);\n        }\n      }\n      const endCheck = checkCombatEnd(currentCombatState);\n      if (endCheck.ended) {\n        setTimeout(() => onEnd(endCheck), 1000);\n        return;\n      }\n    }\n\n    // 3. Apply healing\n    if (result.healing > 0 && updateParty) {\n      const healedCaster = {\n        ...result.updatedCaster,\n        hp: Math.min(result.updatedCaster.maxHp, (result.updatedCaster.hp || 0) + result.healing)\n      };\n      const updatedParty = party.map(p => p.name === healedCaster.name ? healedCaster : p);\n      updateParty(updatedParty);\n    }\n\n    // 4. Apply status effect to target\n    if (result.statusApplied && selectedTarget && updateParty) {\n      const effect = createStatusEffect({\n        type: result.statusApplied.type,\n        duration: result.statusApplied.duration || 1,\n        durationType: result.statusApplied.durationType || DURATION_TYPES.ROUNDS,\n        saveDC: result.statusApplied.saveDC,\n        spellName: result.statusApplied.spellName,\n        source: result.casterName\n      });\n      if (effect) {\n        const partyTarget = party.find(p => p.name === selectedTarget.name);\n        if (partyTarget && updateParty) {\n          let withEffect = applyStatusEffect(partyTarget, effect);\n          // Auto-break concentration if a concentration-ending condition was applied\n          if (CONCENTRATION_BREAKING_CONDITIONS.has(result.statusApplied.type) && withEffect.concentrationSpell) {\n            const dropped = withEffect.concentrationSpell;\n            withEffect = clearConcentration(withEffect, `gained ${effect.name} condition`);\n            addLog(`ðŸ’” ${selectedTarget.name} loses concentration on ${dropped} (gained ${effect.name})!`);\n          }\n          const updatedParty = party.map(p => p.name === withEffect.name ? withEffect : p);\n          updateParty(updatedParty);\n          addLog(`ðŸŒ€ ${selectedTarget.name} is now ${effect.name}!`);\n        }\n      }\n    }\n    handleEndTurn();\n  };\n\n  // â”€â”€ END TURN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleEndTurn = () => {\n    setSelectedTarget(null);\n    setShowSpellPanel(false);\n    const newCombat = nextTurn(combat);\n    onUpdate(newCombat);\n    setTimeout(() => {\n      var _newCombat$combatants;\n      if ((_newCombat$combatants = newCombat.combatants[newCombat.currentTurn]) !== null && _newCombat$combatants !== void 0 && _newCombat$combatants.isEnemy) {\n        handleEnemyTurn(newCombat);\n      }\n    }, 500);\n  };\n\n  // â”€â”€ ENEMY TURN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleEnemyTurn = currentCombat => {\n    const enemy = getCurrentCombatant(currentCombat);\n    if (!enemy || enemy.isDead) {\n      handleEndTurn();\n      return;\n    }\n    const aliveParty = currentCombat.combatants.filter(c => !c.isEnemy && !c.isDead);\n    if (aliveParty.length === 0) return;\n    const target = aliveParty[Math.floor(Math.random() * aliveParty.length)];\n    const result = executeAttack(enemy, target, 0);\n    const logEntry = result.attackRoll.isCritical ? `ðŸ’¥ CRITICAL! ${result.attacker} critically hits ${result.target} for ${result.damage} damage!` : result.attackRoll.isHit ? `âš”ï¸ ${result.attacker} hits ${result.target} for ${result.damage} damage!` : `ðŸ›¡ï¸ ${result.attacker} misses ${result.target}!`;\n    addLog(logEntry);\n    if (result.attackRoll.isHit && result.damage > 0) {\n      const damagedTarget = applyDamage(target, result.damage);\n      let updatedCombat = updateCombatant(currentCombat, target.id || target.name, damagedTarget);\n      if (damagedTarget.isDead) addLog(`ðŸ’€ ${damagedTarget.name} has fallen!`);\n      onUpdate(updatedCombat);\n\n      // Concentration check for attacked party member\n      if (updateParty) {\n        const partyTarget = party.find(p => p.name === target.name);\n        if (partyTarget !== null && partyTarget !== void 0 && partyTarget.concentrationSpell) {\n          const {\n            character: afterCheck,\n            logEntry: checkLog\n          } = handleConcentrationCheck(partyTarget, result.damage);\n          if (checkLog) addLog(checkLog);\n          const updatedParty = party.map(p => p.name === afterCheck.name ? afterCheck : p);\n          updateParty(updatedParty);\n        }\n      }\n      const endCheck = checkCombatEnd(updatedCombat);\n      if (endCheck.ended) {\n        setTimeout(() => onEnd(endCheck), 1000);\n        return;\n      }\n    }\n    setTimeout(() => handleEndTurn(), 1500);\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  RENDER\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: 'fixed',\n      bottom: 0,\n      left: 0,\n      right: 0,\n      backgroundColor: '#120808',\n      border: '3px solid #d32f2f',\n      borderBottom: 'none',\n      padding: '20px',\n      maxHeight: '65vh',\n      overflowY: 'auto',\n      zIndex: 1000,\n      boxShadow: '0 -4px 20px rgba(211,47,47,0.4)'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        marginBottom: '15px',\n        paddingBottom: '15px',\n        borderBottom: '2px solid #2a2a2a'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          margin: 0,\n          color: '#d32f2f',\n          fontSize: '24px'\n        },\n        children: [\"\\u2694\\uFE0F Combat \\u2014 Round \", combat.round]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 901,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: '8px',\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleShortRest,\n          title: \"Short Rest: Warlocks recover all Pact Magic slots\",\n          style: {\n            padding: '8px 14px',\n            backgroundColor: '#1a0a2e',\n            color: '#9C27B0',\n            border: '1px solid #6A1B9A',\n            borderRadius: '5px',\n            cursor: 'pointer',\n            fontSize: '13px'\n          },\n          children: \"\\u26FA Short Rest\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 906,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => onEnd({\n            ended: true,\n            result: 'flee',\n            message: 'Combat ended'\n          }),\n          style: {\n            padding: '8px 16px',\n            backgroundColor: '#333',\n            color: '#aaa',\n            border: '1px solid #555',\n            borderRadius: '5px',\n            cursor: 'pointer'\n          },\n          children: \"End Combat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 921,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 904,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 900,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        gap: '10px',\n        marginBottom: '15px',\n        overflowX: 'auto',\n        paddingBottom: '10px'\n      },\n      children: combat.combatants.map((combatant, index) => {\n        var _combatant$conditions;\n        // Find this combatant's party entry to check concentration\n        const partyEntry = party.find(p => p.name === combatant.name);\n        const isConcentrating = partyEntry === null || partyEntry === void 0 ? void 0 : partyEntry.concentrationSpell;\n        const isActive = index === combat.currentTurn;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            minWidth: '120px',\n            padding: '10px',\n            backgroundColor: isActive ? '#2a0000' : '#1a1a1a',\n            border: isActive ? '2px solid #ffd700' : '2px solid #333',\n            borderRadius: '8px',\n            opacity: combatant.isDead ? 0.3 : 1,\n            position: 'relative',\n            flexShrink: 0,\n            // Purple glow for concentrating characters\n            boxShadow: isConcentrating ? '0 0 12px rgba(156,39,176,0.7), inset 0 0 8px rgba(156,39,176,0.2)' : 'none'\n          },\n          children: [isActive && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: 'absolute',\n              top: '-18px',\n              left: '50%',\n              transform: 'translateX(-50%)',\n              fontSize: '18px'\n            },\n            children: \"\\u2B07\\uFE0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 955,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '11px',\n              color: combatant.isEnemy ? '#ff6b6b' : '#4CAF50',\n              marginBottom: '4px'\n            },\n            children: [combatant.isEnemy ? 'ðŸ‘¹' : 'ðŸ›¡ï¸', \" Init: \", combatant.initiative]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 957,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontWeight: 'bold',\n              fontSize: '13px',\n              marginBottom: '4px',\n              whiteSpace: 'nowrap',\n              overflow: 'hidden',\n              textOverflow: 'ellipsis'\n            },\n            children: combatant.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 960,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '11px',\n              color: '#888'\n            },\n            children: [combatant.hp, \"/\", combatant.maxHp, \" HP\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 963,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '100%',\n              height: '5px',\n              backgroundColor: '#0a0a0a',\n              borderRadius: '3px',\n              marginTop: '5px',\n              overflow: 'hidden'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                width: `${Math.max(0, combatant.hp / combatant.maxHp * 100)}%`,\n                height: '100%',\n                backgroundColor: combatant.hp > combatant.maxHp * 0.5 ? '#4CAF50' : combatant.hp > combatant.maxHp * 0.25 ? '#ff9800' : '#f44336',\n                transition: 'width 0.3s'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 967,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 966,\n            columnNumber: 15\n          }, this), isConcentrating && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: '5px',\n              fontSize: '10px',\n              color: '#CE93D8',\n              display: 'flex',\n              alignItems: 'center',\n              gap: '3px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\uD83D\\uDD2E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 985,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                overflow: 'hidden',\n                textOverflow: 'ellipsis',\n                whiteSpace: 'nowrap',\n                maxWidth: '85px'\n              },\n              children: isConcentrating\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 986,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 977,\n            columnNumber: 17\n          }, this), ((_combatant$conditions = combatant.conditions) === null || _combatant$conditions === void 0 ? void 0 : _combatant$conditions.length) > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: '4px',\n              fontSize: '12px',\n              display: 'flex',\n              gap: '2px',\n              flexWrap: 'wrap'\n            },\n            children: [combatant.conditions.slice(0, 3).map(c => /*#__PURE__*/_jsxDEV(\"span\", {\n              title: c.name,\n              children: c.icon\n            }, c.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 996,\n              columnNumber: 21\n            }, this)), combatant.conditions.length > 3 && /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                color: '#888'\n              },\n              children: [\"+\", combatant.conditions.length - 3]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 998,\n              columnNumber: 55\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 994,\n            columnNumber: 17\n          }, this), combatant.isDead && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: 'absolute',\n              inset: 0,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              fontSize: '36px',\n              backgroundColor: 'rgba(0,0,0,0.5)',\n              borderRadius: '8px'\n            },\n            children: \"\\uD83D\\uDC80\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1003,\n            columnNumber: 17\n          }, this)]\n        }, combatant.id || combatant.name, true, {\n          fileName: _jsxFileName,\n          lineNumber: 939,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 931,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#0a0a0a',\n        padding: '10px',\n        borderRadius: '8px',\n        marginBottom: '15px',\n        maxHeight: '100px',\n        overflowY: 'auto',\n        border: '1px solid #222'\n      },\n      children: combatLog.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          margin: 0,\n          color: '#444',\n          fontStyle: 'italic',\n          fontSize: '13px'\n        },\n        children: \"Combat begins\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1013,\n        columnNumber: 13\n      }, this) : combatLog.map((log, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '3px 5px',\n          color: i === 0 ? '#eee' : '#777',\n          fontSize: '13px',\n          borderBottom: i < combatLog.length - 1 ? '1px solid #111' : 'none'\n        },\n        children: log\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1015,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1011,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#1a1a1a',\n        padding: '15px',\n        borderRadius: '8px',\n        border: '2px solid #333'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          margin: '0 0 12px 0',\n          color: '#ffd700',\n          fontSize: '16px'\n        },\n        children: [currentCombatant === null || currentCombatant === void 0 ? void 0 : currentCombatant.name, \"'s Turn\", isPlayerTurn && isSpellcaster && /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            marginLeft: '10px',\n            fontSize: '12px',\n            color: '#CE93D8'\n          },\n          children: \"\\u2728 Spellcaster\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1027,\n          columnNumber: 13\n        }, this), isPlayerTurn && (partyCharacter === null || partyCharacter === void 0 ? void 0 : partyCharacter.concentrationSpell) && /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            marginLeft: '10px',\n            fontSize: '11px',\n            color: '#CE93D8',\n            backgroundColor: 'rgba(156,39,176,0.2)',\n            padding: '2px 8px',\n            borderRadius: '10px',\n            border: '1px solid #6A1B9A'\n          },\n          children: [\"\\uD83D\\uDD2E \", partyCharacter.concentrationSpell]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1030,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1024,\n        columnNumber: 9\n      }, this), isPlayerTurn && !(currentCombatant !== null && currentCombatant !== void 0 && currentCombatant.isDead) && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '12px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '12px',\n              color: '#888',\n              marginBottom: '6px',\n              textTransform: 'uppercase',\n              letterSpacing: '0.5px'\n            },\n            children: \"Select Target\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1048,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: '8px',\n              flexWrap: 'wrap'\n            },\n            children: [combat.combatants.filter(c => c.isEnemy && !c.isDead).map(enemy => /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setSelectedTarget(enemy),\n              style: {\n                padding: '8px 14px',\n                backgroundColor: (selectedTarget === null || selectedTarget === void 0 ? void 0 : selectedTarget.name) === enemy.name ? '#3a0000' : '#2a1010',\n                color: (selectedTarget === null || selectedTarget === void 0 ? void 0 : selectedTarget.name) === enemy.name ? '#ff6b6b' : '#ccc',\n                border: `2px solid ${(selectedTarget === null || selectedTarget === void 0 ? void 0 : selectedTarget.name) === enemy.name ? '#d32f2f' : '#333'}`,\n                borderRadius: '6px',\n                cursor: 'pointer',\n                fontSize: '13px',\n                transition: 'all 0.15s'\n              },\n              children: [\"\\uD83D\\uDC79 \", enemy.name, /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  color: '#666',\n                  marginLeft: '6px',\n                  fontSize: '11px'\n                },\n                children: [enemy.hp, \"/\", enemy.maxHp, \" HP\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1068,\n                columnNumber: 21\n              }, this)]\n            }, enemy.id || enemy.name, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1053,\n              columnNumber: 19\n            }, this)), combat.combatants.filter(c => c.isEnemy && !c.isDead).length === 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                color: '#888',\n                fontStyle: 'italic',\n                fontSize: '13px'\n              },\n              children: \"No living enemies\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1074,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1051,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1047,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '10px',\n            flexWrap: 'wrap',\n            marginBottom: '10px',\n            alignItems: 'flex-start'\n          },\n          children: [(_currentCombatant$att = currentCombatant.attacks) === null || _currentCombatant$att === void 0 ? void 0 : _currentCombatant$att.map((attack, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleAttack(index),\n            disabled: !selectedTarget,\n            style: {\n              padding: '10px 18px',\n              backgroundColor: selectedTarget ? '#1a3a1a' : '#1a1a1a',\n              color: selectedTarget ? '#4CAF50' : '#555',\n              border: `2px solid ${selectedTarget ? '#4CAF50' : '#333'}`,\n              borderRadius: '8px',\n              cursor: selectedTarget ? 'pointer' : 'not-allowed',\n              fontSize: '14px',\n              fontWeight: 'bold',\n              transition: 'all 0.15s'\n            },\n            children: [\"\\u2694\\uFE0F \", attack.name, /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                display: 'block',\n                fontSize: '10px',\n                color: selectedTarget ? '#81C784' : '#444',\n                fontWeight: 'normal'\n              },\n              children: [\"+\", attack.bonus, \" to hit \\u2022 \", attack.damage]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1100,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1083,\n            columnNumber: 17\n          }, this)), isSpellcaster && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowSpellPanel(p => !p),\n            style: {\n              padding: '10px 18px',\n              backgroundColor: showSpellPanel ? '#2a0a3a' : '#1a0a2a',\n              color: showSpellPanel ? '#CE93D8' : '#9C27B0',\n              border: `2px solid ${showSpellPanel ? '#CE93D8' : '#6A1B9A'}`,\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontSize: '14px',\n              fontWeight: 'bold',\n              transition: 'all 0.15s',\n              position: 'relative'\n            },\n            children: [\"\\u2728 Cast Spell\", /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                display: 'block',\n                fontSize: '10px',\n                color: '#888',\n                fontWeight: 'normal'\n              },\n              children: [combatSpells.length, \" available\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1124,\n              columnNumber: 19\n            }, this), (partyCharacter === null || partyCharacter === void 0 ? void 0 : partyCharacter.concentrationSpell) && /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                position: 'absolute',\n                top: '-8px',\n                right: '-8px',\n                width: '16px',\n                height: '16px',\n                backgroundColor: '#9C27B0',\n                borderRadius: '50%',\n                fontSize: '10px',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center'\n              },\n              children: \"\\uD83D\\uDD2E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1128,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1108,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleEndTurn,\n            style: {\n              padding: '10px 18px',\n              backgroundColor: '#1a1a1a',\n              color: '#888',\n              border: '2px solid #333',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontSize: '14px',\n              marginLeft: 'auto',\n              transition: 'all 0.15s'\n            },\n            children: \"End Turn \\u2192\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1146,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1080,\n          columnNumber: 13\n        }, this), showSpellPanel && isSpellcaster && /*#__PURE__*/_jsxDEV(SpellCastPanel, {\n          caster: partyCharacter,\n          combatSpells: combatSpells,\n          selectedTarget: selectedTarget,\n          onSpellResult: handleSpellResult,\n          onClose: () => setShowSpellPanel(false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1166,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1045,\n        columnNumber: 11\n      }, this), !isPlayerTurn && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          margin: 0,\n          color: '#ff6b6b',\n          fontStyle: 'italic',\n          fontSize: '14px'\n        },\n        children: \"\\u2694\\uFE0F Enemy is acting\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1178,\n        columnNumber: 11\n      }, this), (currentCombatant === null || currentCombatant === void 0 ? void 0 : currentCombatant.isDead) && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          margin: 0,\n          color: '#555',\n          fontSize: '14px'\n        },\n        children: \"This combatant has been defeated. Advance the turn.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1184,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1023,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 885,\n    columnNumber: 5\n  }, this);\n}\n_s2(CombatTracker, \"rH3G6Vn15+yPvr8yNjlmhkYCTaA=\");\n_c3 = CombatTracker;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"ConcentrationWarningModal\");\n$RefreshReg$(_c2, \"SpellCastPanel\");\n$RefreshReg$(_c3, \"CombatTracker\");","map":{"version":3,"names":["useState","executeAttack","nextTurn","checkCombatEnd","getCurrentCombatant","updateCombatant","applyDamage","SPELL_DATABASE","getSpellSlots","canCastSpell","castSpell","shortRest","getSpellAttackBonus","getSpellSaveDC","calculateSpellDamage","rollSpellDamage","SPELLCASTING_CLASSES","isWarlockPactMagic","getWarlockPactSlots","createStatusEffect","applyStatusEffect","STATUS_EFFECTS","DURATION_TYPES","jsxDEV","_jsxDEV","Fragment","_Fragment","rollD20","Math","floor","random","CONCENTRATION_SPELLS","Set","CONCENTRATION_BREAKING_CONDITIONS","INCAPACITATED","STUNNED","PARALYZED","UNCONSCIOUS","PETRIFIED","SPELL_STATUS_EFFECTS","hold_person","type","duration","durationType","SAVE_ENDS","saveDC","sleep","MINUTES","haste","HASTED","ROUNDS","invisibility","INVISIBLE","greater_invisibility","spellLevelColor","level","c","getCombatSpells","character","_character$spells","_character$spells2","_character$spells3","cantrips","spells","map","k","key","filter","s","name","prepared","known","all","forEach","find","a","push","damage","healing","includes","isConcentrationSpell","spell","concentration","has","rollConcentrationCheck","damageTaken","dc","max","roll","passed","ConcentrationWarningModal","currentSpell","newSpell","onDropAndCast","onCancel","style","position","inset","backgroundColor","display","alignItems","justifyContent","zIndex","children","border","borderRadius","padding","maxWidth","width","boxShadow","fontSize","textAlign","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","margin","color","gap","onClick","flex","cursor","fontWeight","_c","SpellCastPanel","caster","combatSpells","selectedTarget","onSpellResult","onClose","_s","_caster$spellSlots","selectedSpell","setSelectedSpell","upcastLevel","setUpcastLevel","castResult","setCastResult","concWarning","setConcWarning","currentSlots","spellSlots","current","spellAttack","spellSaveDC","isWarlock","pactSlotInfo","pactSlotsLeft","slotLevel","activeConc","concentrationSpell","executeCast","castOutcome","success","alert","message","updatedCaster","isConc","result","spellName","casterName","targetName","hit","critical","statusApplied","isConcentration","droppedConcentration","log","dmgStr","rolled","total","saveRoll","targetSave","dex","saved","targetDex","damageType","d20","crit","ac","armorClass","replace","_","n","parseInt","scAbil","Cleric","Druid","Paladin","Bard","Ranger","abilKey","class","mod","abilities","_effectDef$saveDC","effectDef","handleCast","pendingCast","marginTop","background","slotCount","marginLeft","Array","from","length","i","height","flexWrap","cur","gridTemplateColumns","maxHeight","overflowY","fontStyle","gridColumn","hasSlotsOrCantrip","isSelected","isActiveConc","disabled","opacity","transition","castingTime","range","description","upcastBonus","lvl","slotsLeft","_c2","CombatTracker","combat","onUpdate","onEnd","party","updateParty","_s2","_currentCombatant$att","setSelectedTarget","combatLog","setCombatLog","showSpellPanel","setShowSpellPanel","isActive","currentCombatant","isPlayerTurn","isEnemy","partyCharacter","p","isSpellcaster","addLog","entry","prevLog","handleShortRest","anyRecovered","updatedParty","recovered","pact","console","clearConcentration","reason","handleConcentrationCheck","logEntry","check","cleared","handleAttack","attackIndex","attackRoll","isCritical","attacker","target","attack","isFumble","isHit","newLog","damagedTarget","updatedCombat","id","isDead","partyTarget","afterCheck","checkLog","endCheck","ended","setTimeout","handleEndTurn","handleSpellResult","currentCombatState","healedCaster","hp","min","maxHp","effect","source","withEffect","dropped","newCombat","_newCombat$combatants","combatants","currentTurn","handleEnemyTurn","currentCombat","enemy","aliveParty","bottom","left","right","borderBottom","paddingBottom","round","title","overflowX","combatant","index","_combatant$conditions","partyEntry","isConcentrating","minWidth","flexShrink","top","transform","initiative","whiteSpace","overflow","textOverflow","conditions","slice","icon","textTransform","letterSpacing","attacks","bonus","_c3","$RefreshReg$"],"sources":["C:/Users/Hakty/Desktop/AI-Dungeon-Master/frontend/src/components/CombatTracker.jsx"],"sourcesContent":["// frontend/src/components/CombatTracker.jsx - WITH SPELL DAMAGE + CONCENTRATION TRACKING\nimport { useState } from 'react';\nimport {\n  executeAttack,\n  nextTurn,\n  checkCombatEnd,\n  getCurrentCombatant,\n  updateCombatant,\n  applyDamage\n} from '../utils/combatSystem';\nimport {\n  SPELL_DATABASE,\n  getSpellSlots,\n  canCastSpell,\n  castSpell,\n  shortRest,\n  getSpellAttackBonus,\n  getSpellSaveDC,\n  calculateSpellDamage,\n  rollSpellDamage,\n  SPELLCASTING_CLASSES,\n  isWarlockPactMagic,\n  getWarlockPactSlots\n} from '../utils/spellSystem';\nimport {\n  createStatusEffect,\n  applyStatusEffect,\n  STATUS_EFFECTS,\n  DURATION_TYPES\n} from '../utils/statusEffectSystem';\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  HELPERS\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\nfunction rollD20() {\n  return Math.floor(Math.random() * 20) + 1;\n}\n\n/** Spells that require concentration */\nconst CONCENTRATION_SPELLS = new Set([\n  'bless','bane','faerie_fire','fog_cloud','guiding_bolt','hold_person',\n  'invisibility','magic_weapon','mirror_image','misty_step','prayer_of_healing',\n  'silence','spider_climb','spiritual_weapon','arcane_eye','banishment',\n  'black_tentacles','confusion','conjure_animals','conjure_woodland_beings',\n  'control_water','dimension_door','dominate_beast','evards_black_tentacles',\n  'faithful_hound','fire_shield','freedom_of_movement','giant_insect',\n  'greater_invisibility','guardian_of_faith','hallucinatory_terrain','ice_storm',\n  'locate_creature','phantasmal_killer','polymorph','resilient_sphere',\n  'stone_skin','wall_of_fire','animate_objects','antilife_shell',\n  'arcane_hand','cloudkill','conjure_elemental','contact_other_plane',\n  'control_winds','danse_macabre','dawn','destructive_wave','dominate_person',\n  'far_step','grappling_vine','haste','hold_monster','insect_plague',\n  'legend_lore','maelstrom','mass_cure_wounds','mislead','modify_memory',\n  'passwall','planar_binding','seeming','synaptic_static','teleportation_circle',\n  'wall_of_force','wall_of_stone','wind_walk','witch_bolt','call_lightning',\n  'conjure_barrage','conjure_volley','sleet_storm','slow','speak_with_dead',\n  'summon_lesser_demons','thunder_step','tidal_wave','vitriolic_sphere',\n  'web','wind_wall','wrathful_smite','locate_object','darkvision',\n  'enhance_ability','enlarge_reduce','flame_blade','heat_metal','hold_person',\n  'levitate','melf_acid_arrow','mind_spike','moonbeam','pass_without_trace',\n  'protection_from_energy','rope_trick','see_invisibility','shatter',\n  'blindness_deafness','blur','crown_of_madness','darkness','detect_thoughts',\n  'enthrall','flaming_sphere','gust_of_wind','hold_person','magic_mouth',\n  'maximilian_earthen_grasp','mirror_image','nystul_magic_aura',\n  'phantasmal_force','ray_of_enfeeblement','shadow_blade',\n]);\n\n/** Conditions that break concentration */\nconst CONCENTRATION_BREAKING_CONDITIONS = new Set([\n  STATUS_EFFECTS.INCAPACITATED,\n  STATUS_EFFECTS.STUNNED,\n  STATUS_EFFECTS.PARALYZED,\n  STATUS_EFFECTS.UNCONSCIOUS,\n  STATUS_EFFECTS.PETRIFIED,\n]);\n\n/** Map spell types that apply status effects */\nconst SPELL_STATUS_EFFECTS = {\n  hold_person:         { type: STATUS_EFFECTS.PARALYZED,    duration: 10, durationType: DURATION_TYPES.SAVE_ENDS, saveDC: null },\n  sleep:               { type: STATUS_EFFECTS.UNCONSCIOUS,  duration: 1,  durationType: DURATION_TYPES.MINUTES },\n  haste:               { type: STATUS_EFFECTS.HASTED,       duration: 10, durationType: DURATION_TYPES.ROUNDS },\n  invisibility:        { type: STATUS_EFFECTS.INVISIBLE,    duration: 60, durationType: DURATION_TYPES.MINUTES },\n  greater_invisibility:{ type: STATUS_EFFECTS.INVISIBLE,    duration: 10, durationType: DURATION_TYPES.ROUNDS },\n};\n\n/** Colour band per spell level */\nfunction spellLevelColor(level) {\n  const c = ['#4CAF50','#2196F3','#03A9F4','#00BCD4','#009688','#8BC34A','#CDDC39','#FFEB3B','#FFC107','#FF9800'];\n  return c[level] || '#888';\n}\n\n/** Get accessible spells for combat (cantrips + prepared/known) */\nfunction getCombatSpells(character) {\n  const cantrips = (character.spells?.cantrips || []).map(k => ({ key: k, ...SPELL_DATABASE[k] })).filter(s => s.name);\n  const prepared = (character.spells?.prepared || []).map(k => ({ key: k, ...SPELL_DATABASE[k] })).filter(s => s.name);\n  const known    = (character.spells?.known    || []).map(k => ({ key: k, ...SPELL_DATABASE[k] })).filter(s => s.name);\n\n  const all = [...cantrips];\n  [...prepared, ...known].forEach(s => {\n    if (!all.find(a => a.key === s.key)) all.push(s);\n  });\n\n  return all.filter(s =>\n    s.damage || s.healing || SPELL_STATUS_EFFECTS[s.key] ||\n    ['shield','misty_step','counterspell','fly','haste','hold_person','sleep',\n     'invisibility','greater_invisibility','spiritual_weapon'].includes(s.key)\n  );\n}\n\n/** Check if a spell requires concentration */\nfunction isConcentrationSpell(spell) {\n  return spell.concentration === true || CONCENTRATION_SPELLS.has(spell.key);\n}\n\n/** Roll a concentration saving throw. Returns { passed, roll, dc } */\nfunction rollConcentrationCheck(damageTaken) {\n  const dc = Math.max(10, Math.floor(damageTaken / 2));\n  const roll = rollD20();\n  return { passed: roll >= dc, roll, dc };\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  CONCENTRATION WARNING MODAL\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nfunction ConcentrationWarningModal({ currentSpell, newSpell, onDropAndCast, onCancel }) {\n  return (\n    <div style={{\n      position: 'fixed', inset: 0,\n      backgroundColor: 'rgba(0,0,0,0.85)',\n      display: 'flex', alignItems: 'center', justifyContent: 'center',\n      zIndex: 2000\n    }}>\n      <div style={{\n        backgroundColor: '#1a0a2e',\n        border: '2px solid #9C27B0',\n        borderRadius: '12px',\n        padding: '24px',\n        maxWidth: '400px',\n        width: '90%',\n        boxShadow: '0 0 30px rgba(156,39,176,0.5)'\n      }}>\n        <div style={{ fontSize: '24px', textAlign: 'center', marginBottom: '12px' }}>ðŸ”®</div>\n        <h3 style={{ margin: '0 0 12px 0', color: '#CE93D8', textAlign: 'center' }}>\n          Concentration Conflict\n        </h3>\n        <p style={{ color: '#ccc', fontSize: '14px', textAlign: 'center', marginBottom: '8px' }}>\n          You are already concentrating on <strong style={{ color: '#CE93D8' }}>{currentSpell}</strong>.\n        </p>\n        <p style={{ color: '#aaa', fontSize: '13px', textAlign: 'center', marginBottom: '20px' }}>\n          Casting <strong style={{ color: '#CE93D8' }}>{newSpell}</strong> will end your current concentration.\n          Do you want to drop <strong>{currentSpell}</strong> and cast <strong>{newSpell}</strong>?\n        </p>\n        <div style={{ display: 'flex', gap: '10px' }}>\n          <button\n            onClick={onDropAndCast}\n            style={{\n              flex: 1,\n              padding: '10px',\n              backgroundColor: '#6A1B9A',\n              color: 'white',\n              border: 'none',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontWeight: 'bold',\n              fontSize: '14px'\n            }}\n          >\n            Drop & Cast\n          </button>\n          <button\n            onClick={onCancel}\n            style={{\n              flex: 1,\n              padding: '10px',\n              backgroundColor: '#333',\n              color: '#aaa',\n              border: '1px solid #555',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontSize: '14px'\n            }}\n          >\n            Cancel\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  SPELL CAST PANEL (sub-component)\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nfunction SpellCastPanel({ caster, combatSpells, selectedTarget, onSpellResult, onClose }) {\n  const [selectedSpell, setSelectedSpell] = useState(null);\n  const [upcastLevel,   setUpcastLevel]   = useState(null);\n  const [castResult,    setCastResult]    = useState(null);\n  const [concWarning,   setConcWarning]   = useState(null); // { currentSpell, newSpell, pendingCast }\n\n  const currentSlots  = caster.spellSlots?.current || getSpellSlots(caster);\n  const spellAttack   = getSpellAttackBonus(caster);\n  const spellSaveDC   = getSpellSaveDC(caster);\n  const isWarlock     = isWarlockPactMagic(caster);\n  const pactSlotInfo  = isWarlock ? getWarlockPactSlots(caster) : null;\n  // For Warlocks, remaining pact slots live at index (pactLevel - 1)\n  const pactSlotsLeft = isWarlock\n    ? (currentSlots[pactSlotInfo.slotLevel - 1] || 0)\n    : null;\n\n  // Current concentration spell on this caster\n  const activeConc = caster.concentrationSpell || null;\n\n  const executeCast = (spell, slotLevel) => {\n    const castOutcome = castSpell(caster, spell, slotLevel > 0 ? slotLevel : null);\n    if (!castOutcome.success) {\n      alert(castOutcome.message);\n      return;\n    }\n    const updatedCaster = castOutcome.character;\n\n    // Track concentration on character\n    const isConc = isConcentrationSpell(spell);\n    if (isConc) {\n      updatedCaster.concentrationSpell = spell.name;\n    }\n\n    let result = {\n      spellName: spell.name,\n      casterName: caster.name,\n      targetName: selectedTarget?.name || 'ally',\n      slotLevel,\n      updatedCaster,\n      damage: 0,\n      healing: 0,\n      hit: null,\n      critical: false,\n      statusApplied: null,\n      isConcentration: isConc,\n      droppedConcentration: activeConc,\n      log: ''\n    };\n\n    // â”€â”€ DAMAGE spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    if (spell.damage && selectedTarget) {\n      if (spell.key === 'magic_missile') {\n        const dmgStr = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.damage;\n        const rolled = rollSpellDamage(dmgStr);\n        result.damage = rolled.total;\n        result.hit    = true;\n        result.log    = `âœ¨ ${caster.name} fires Magic Missile at ${selectedTarget.name} for ${rolled.total} force damage! (auto-hit)`;\n      } else if (spell.key === 'sacred_flame') {\n        const saveRoll   = rollD20();\n        const targetSave = selectedTarget.dex ? Math.floor((selectedTarget.dex - 10) / 2) : 0;\n        const saved      = (saveRoll + targetSave) >= spellSaveDC;\n        if (!saved) {\n          const dmgStr = calculateSpellDamage(spell, caster.level) || spell.damage;\n          const rolled  = rollSpellDamage(dmgStr);\n          result.damage = rolled.total;\n          result.hit    = true;\n          result.log    = `ðŸ”¥ Sacred Flame hits ${selectedTarget.name} for ${rolled.total} radiant damage! (DEX save ${saveRoll} failed vs DC ${spellSaveDC})`;\n        } else {\n          result.hit = false;\n          result.log = `ðŸ”¥ ${selectedTarget.name} saves against Sacred Flame! (rolled ${saveRoll} vs DC ${spellSaveDC})`;\n        }\n      } else if (['fireball','lightning_bolt','thunderwave','burning_hands','ice_storm','cone_of_cold',\n                  'chain_lightning','disintegrate','finger_of_death','meteor_swarm'].includes(spell.key)) {\n        const saveRoll  = rollD20();\n        const targetDex = selectedTarget.dex ? Math.floor((selectedTarget.dex - 10) / 2) : 0;\n        const saved     = (saveRoll + targetDex) >= spellSaveDC;\n        const dmgStr    = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.damage;\n        const rolled    = rollSpellDamage(dmgStr);\n        result.damage   = saved ? Math.floor(rolled.total / 2) : rolled.total;\n        result.hit      = true;\n        result.log      = saved\n          ? `ðŸ’¥ ${caster.name} casts ${spell.name}! ${selectedTarget.name} saves (${saveRoll} vs DC ${spellSaveDC}) â€” takes ${result.damage} ${spell.damageType} damage (half).`\n          : `ðŸ’¥ ${caster.name} casts ${spell.name}! ${selectedTarget.name} fails save (${saveRoll} vs DC ${spellSaveDC}) â€” takes ${result.damage} ${spell.damageType} damage!`;\n      } else {\n        const d20   = rollD20();\n        const total = d20 + spellAttack;\n        const crit  = d20 === 20;\n        const hit   = crit || total >= (selectedTarget.ac || selectedTarget.armorClass || 12);\n        if (hit) {\n          const dmgStr  = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.damage;\n          const rolled  = rollSpellDamage(crit ? dmgStr.replace(/(\\d+)d/, (_, n) => `${parseInt(n)*2}d`) : dmgStr);\n          result.damage   = rolled.total;\n          result.hit      = true;\n          result.critical = crit;\n          result.log      = crit\n            ? `ðŸ’¥ CRITICAL! ${caster.name}'s ${spell.name} hits ${selectedTarget.name} for ${rolled.total} ${spell.damageType} damage!`\n            : `âœ¨ ${caster.name}'s ${spell.name} hits ${selectedTarget.name} for ${rolled.total} ${spell.damageType} damage! (rolled ${total} vs AC ${selectedTarget.ac || selectedTarget.armorClass || '?'})`;\n        } else {\n          result.hit = false;\n          result.log = `âŒ ${caster.name}'s ${spell.name} misses ${selectedTarget.name}! (rolled ${total} vs AC ${selectedTarget.ac || selectedTarget.armorClass || '?'})`;\n        }\n      }\n    }\n    // â”€â”€ HEALING spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    else if (spell.healing) {\n      const dmgStr    = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.healing;\n      const rolled    = rollSpellDamage(dmgStr);\n      const scAbil    = { Cleric:'WIS', Druid:'WIS', Paladin:'CHA', Bard:'CHA', Ranger:'WIS' };\n      const abilKey   = scAbil[caster.class] || 'INT';\n      const mod       = caster.abilities ? Math.floor((caster.abilities[abilKey] - 10) / 2) : 0;\n      result.healing  = rolled.total + mod;\n      result.log      = `ðŸ’š ${caster.name} casts ${spell.name} and heals for ${result.healing} HP!`;\n    }\n    // â”€â”€ STATUS EFFECT spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    else if (SPELL_STATUS_EFFECTS[spell.key]) {\n      const effectDef      = SPELL_STATUS_EFFECTS[spell.key];\n      const dc             = effectDef.saveDC ?? spellSaveDC;\n      result.statusApplied = { ...effectDef, saveDC: dc, spellName: spell.name };\n      result.log           = `ðŸŒ€ ${caster.name} casts ${spell.name}${selectedTarget ? ` on ${selectedTarget.name}` : ''}!`;\n    }\n    // â”€â”€ UTILITY spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    else {\n      result.log = `âœ¨ ${caster.name} casts ${spell.name}!`;\n    }\n\n    // Append concentration note\n    if (isConc) {\n      result.log += ` [Concentrating]`;\n      if (activeConc) result.log = `[Dropped ${activeConc}] ` + result.log;\n    }\n\n    setCastResult(result);\n    onSpellResult(result);\n  };\n\n  const handleCast = () => {\n    if (!selectedSpell) return;\n    const spell     = selectedSpell;\n    const slotLevel = upcastLevel ?? (spell.level || 0);\n\n    // Check concentration conflict\n    if (isConcentrationSpell(spell) && activeConc && activeConc !== spell.name) {\n      setConcWarning({\n        currentSpell: activeConc,\n        newSpell: spell.name,\n        pendingCast: () => executeCast(spell, slotLevel)\n      });\n      return;\n    }\n\n    executeCast(spell, slotLevel);\n  };\n\n  return (\n    <>\n      {concWarning && (\n        <ConcentrationWarningModal\n          currentSpell={concWarning.currentSpell}\n          newSpell={concWarning.newSpell}\n          onDropAndCast={() => {\n            concWarning.pendingCast();\n            setConcWarning(null);\n          }}\n          onCancel={() => setConcWarning(null)}\n        />\n      )}\n\n      <div style={{\n        backgroundColor: '#12012a',\n        border: '2px solid #9C27B0',\n        borderRadius: '10px',\n        padding: '15px',\n        marginTop: '10px'\n      }}>\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px' }}>\n          <h4 style={{ margin: 0, color: '#CE93D8' }}>âœ¨ Cast a Spell</h4>\n          <button onClick={onClose} style={{ background: 'none', border: 'none', color: '#888', cursor: 'pointer', fontSize: '18px' }}>âœ•</button>\n        </div>\n\n        {/* Active concentration indicator */}\n        {activeConc && (\n          <div style={{\n            padding: '6px 10px',\n            backgroundColor: 'rgba(156,39,176,0.15)',\n            border: '1px solid #9C27B0',\n            borderRadius: '6px',\n            marginBottom: '10px',\n            fontSize: '12px',\n            color: '#CE93D8',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '6px'\n          }}>\n            <span>ðŸ”®</span>\n            <span>Concentrating on <strong>{activeConc}</strong> â€” casting another concentration spell will end this.</span>\n          </div>\n        )}\n\n        <div style={{ fontSize: '12px', color: '#888', marginBottom: '10px' }}>\n          Spell Attack: <span style={{ color: '#CE93D8' }}>+{spellAttack}</span> &nbsp;|&nbsp;\n          Save DC: <span style={{ color: '#CE93D8' }}>{spellSaveDC}</span>\n        </div>\n\n        {/* Spell slot display â€” Warlock gets a distinct pact slot banner */}\n        {isWarlock ? (\n          <div style={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: '10px',\n            marginBottom: '12px',\n            padding: '8px 12px',\n            backgroundColor: pactSlotsLeft > 0 ? '#1a0a2e' : '#1a1a1a',\n            border: `2px solid ${pactSlotsLeft > 0 ? '#9C27B0' : '#333'}`,\n            borderRadius: '8px'\n          }}>\n            <span style={{ fontSize: '18px' }}>ðŸ”®</span>\n            <div>\n              <div style={{ fontSize: '13px', fontWeight: 'bold', color: pactSlotsLeft > 0 ? '#CE93D8' : '#555' }}>\n                Pact Magic Slots â€” Level {pactSlotInfo.slotLevel}\n              </div>\n              <div style={{ fontSize: '11px', color: '#888' }}>\n                {pactSlotsLeft} / {pactSlotInfo.slotCount} remaining\n                {pactSlotsLeft === 0 && ' â€” Short rest to recover!'}\n              </div>\n            </div>\n            {/* Slot pips */}\n            <div style={{ display: 'flex', gap: '4px', marginLeft: 'auto' }}>\n              {Array.from({ length: pactSlotInfo.slotCount }).map((_, i) => (\n                <div key={i} style={{\n                  width: '12px',\n                  height: '12px',\n                  borderRadius: '50%',\n                  backgroundColor: i < pactSlotsLeft ? '#9C27B0' : '#333',\n                  border: '1px solid #555'\n                }} />\n              ))}\n            </div>\n          </div>\n        ) : (\n          <div style={{ display: 'flex', gap: '6px', flexWrap: 'wrap', marginBottom: '12px' }}>\n            {getSpellSlots(caster).map((max, i) => {\n              if (max === 0) return null;\n              const cur = currentSlots[i] || 0;\n              return (\n                <div key={i} style={{\n                  padding: '4px 8px',\n                  backgroundColor: cur > 0 ? '#1a0a2e' : '#1a1a1a',\n                  border: `1px solid ${cur > 0 ? spellLevelColor(i+1) : '#333'}`,\n                  borderRadius: '4px',\n                  fontSize: '11px',\n                  color: cur > 0 ? spellLevelColor(i+1) : '#555'\n                }}>\n                  L{i+1}: {cur}/{max}\n                </div>\n              );\n            })}\n          </div>\n        )}\n\n        {/* Spell grid */}\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(160px, 1fr))', gap: '8px', marginBottom: '12px', maxHeight: '200px', overflowY: 'auto' }}>\n          {combatSpells.length === 0 && (\n            <div style={{ color: '#666', fontStyle: 'italic', padding: '10px', gridColumn: '1/-1' }}>\n              No combat spells available. Open SpellBook to learn spells.\n            </div>\n          )}\n          {combatSpells.map(spell => {\n            // For Warlocks, use canCastSpell() which checks pact slot level correctly\n            const hasSlotsOrCantrip = spell.level === 0 || (isWarlock ? canCastSpell(caster, spell) : (currentSlots[spell.level - 1] || 0) > 0);\n            const isSelected        = selectedSpell?.key === spell.key;\n            const isConc            = isConcentrationSpell(spell);\n            const isActiveConc      = activeConc === spell.name;\n            return (\n              <button\n                key={spell.key}\n                onClick={() => { setSelectedSpell(spell); setUpcastLevel(spell.level); setCastResult(null); }}\n                disabled={!hasSlotsOrCantrip}\n                style={{\n                  padding: '8px 10px',\n                  backgroundColor: isSelected ? '#3a0a5a' : '#1a0a2e',\n                  border: `2px solid ${isActiveConc ? '#9C27B0' : isSelected ? '#CE93D8' : hasSlotsOrCantrip ? spellLevelColor(spell.level) : '#333'}`,\n                  borderRadius: '6px',\n                  cursor: hasSlotsOrCantrip ? 'pointer' : 'not-allowed',\n                  opacity: hasSlotsOrCantrip ? 1 : 0.4,\n                  textAlign: 'left',\n                  transition: 'all 0.15s',\n                  boxShadow: isActiveConc ? '0 0 8px rgba(156,39,176,0.6)' : 'none'\n                }}\n              >\n                <div style={{ fontSize: '13px', fontWeight: 'bold', color: spellLevelColor(spell.level), marginBottom: '3px' }}>\n                  {spell.name}\n                </div>\n                <div style={{ fontSize: '10px', color: '#888' }}>\n                  {spell.level === 0 ? 'Cantrip' : `Lvl ${spell.level}`}\n                  {spell.damage && ` â€¢ ${spell.damage} ${spell.damageType}`}\n                  {spell.healing && ` â€¢ Heals ${spell.healing}`}\n                  {isConc && <span style={{ color: '#9C27B0' }}> â€¢ ðŸ”® Conc.</span>}\n                </div>\n              </button>\n            );\n          })}\n        </div>\n\n        {/* Selected spell details + upcast + cast button */}\n        {selectedSpell && (\n          <div style={{\n            backgroundColor: '#0a0018',\n            borderRadius: '8px',\n            padding: '12px',\n            border: `1px solid ${spellLevelColor(selectedSpell.level)}`\n          }}>\n            <div style={{ marginBottom: '8px' }}>\n              <span style={{ fontWeight: 'bold', color: spellLevelColor(selectedSpell.level) }}>{selectedSpell.name}</span>\n              {isConcentrationSpell(selectedSpell) && (\n                <span style={{\n                  marginLeft: '8px',\n                  fontSize: '11px',\n                  color: '#CE93D8',\n                  backgroundColor: 'rgba(156,39,176,0.2)',\n                  padding: '2px 6px',\n                  borderRadius: '4px',\n                  border: '1px solid #6A1B9A'\n                }}>ðŸ”® Concentration</span>\n              )}\n              <span style={{ color: '#888', fontSize: '12px', marginLeft: '10px' }}>{selectedSpell.castingTime} â€¢ {selectedSpell.range}</span>\n            </div>\n            <div style={{ fontSize: '13px', color: '#ccc', marginBottom: '10px' }}>{selectedSpell.description}</div>\n\n            {/* Concentration conflict warning in detail panel */}\n            {isConcentrationSpell(selectedSpell) && activeConc && activeConc !== selectedSpell.name && (\n              <div style={{\n                padding: '8px 10px',\n                backgroundColor: 'rgba(255,152,0,0.1)',\n                border: '1px solid #ff9800',\n                borderRadius: '6px',\n                marginBottom: '10px',\n                fontSize: '12px',\n                color: '#ffb74d'\n              }}>\n                âš ï¸ Casting this will drop <strong>{activeConc}</strong>\n              </div>\n            )}\n\n            {/* Upcast selector â€” hidden for Warlocks (no slot level choice) */}\n            {!isWarlock && selectedSpell.level > 0 && selectedSpell.upcastBonus && (\n              <div style={{ marginBottom: '10px' }}>\n                <div style={{ fontSize: '11px', color: '#888', marginBottom: '6px' }}>Cast at level:</div>\n                <div style={{ display: 'flex', gap: '6px', flexWrap: 'wrap' }}>\n                  {Array.from({ length: 10 - selectedSpell.level }, (_, i) => selectedSpell.level + i).map(lvl => {\n                    const slotsLeft = currentSlots[lvl - 1] || 0;\n                    if (getSpellSlots(caster)[lvl - 1] === 0) return null;\n                    return (\n                      <button\n                        key={lvl}\n                        onClick={() => setUpcastLevel(lvl)}\n                        disabled={slotsLeft === 0}\n                        style={{\n                          padding: '4px 10px',\n                          backgroundColor: upcastLevel === lvl ? spellLevelColor(lvl) : '#1a0a2e',\n                          color: upcastLevel === lvl ? '#000' : slotsLeft > 0 ? '#eee' : '#555',\n                          border: 'none',\n                          borderRadius: '4px',\n                          cursor: slotsLeft > 0 ? 'pointer' : 'not-allowed',\n                          fontSize: '12px',\n                          opacity: slotsLeft > 0 ? 1 : 0.4\n                        }}\n                      >\n                        L{lvl} ({slotsLeft})\n                      </button>\n                    );\n                  })}\n                </div>\n              </div>\n            )}\n            {/* Warlock auto-cast info â€” shows pact slot level, no choice needed */}\n            {isWarlock && selectedSpell.level > 0 && (\n              <div style={{\n                marginBottom: '10px',\n                padding: '6px 10px',\n                backgroundColor: 'rgba(156,39,176,0.1)',\n                border: '1px solid #6A1B9A',\n                borderRadius: '6px',\n                fontSize: '11px',\n                color: '#CE93D8'\n              }}>\n                ðŸ”® Pact Magic: always casts at level <strong>{pactSlotInfo.slotLevel}</strong> â€” no slot choice needed\n              </div>\n            )}\n\n            {!selectedTarget && selectedSpell.damage && (\n              <div style={{ color: '#ff9800', fontSize: '12px', marginBottom: '8px' }}>\n                âš ï¸ Select a target enemy above before casting this spell\n              </div>\n            )}\n\n            <button\n              onClick={handleCast}\n              disabled={!!(selectedSpell.damage && !selectedTarget)}\n              style={{\n                width: '100%',\n                padding: '10px',\n                backgroundColor: (selectedSpell.damage && !selectedTarget) ? '#333' : '#7B1FA2',\n                color: 'white',\n                border: 'none',\n                borderRadius: '6px',\n                cursor: (selectedSpell.damage && !selectedTarget) ? 'not-allowed' : 'pointer',\n                fontWeight: 'bold',\n                fontSize: '15px',\n                transition: 'background 0.2s'\n              }}\n            >\n              âœ¨ Cast {selectedSpell.name}{isWarlock && selectedSpell.level > 0 ? ` (Pact Lvl ${pactSlotInfo.slotLevel})` : upcastLevel && upcastLevel > selectedSpell.level ? ` (Lvl ${upcastLevel})` : ''}\n            </button>\n          </div>\n        )}\n\n        {/* Cast result */}\n        {castResult && (\n          <div style={{\n            marginTop: '10px',\n            padding: '10px',\n            backgroundColor: castResult.hit === false ? '#1a0a0a' : '#0a1a0a',\n            borderRadius: '6px',\n            border: `1px solid ${castResult.hit === false ? '#f44336' : '#4CAF50'}`,\n            fontSize: '13px',\n            color: '#eee'\n          }}>\n            {castResult.log}\n          </div>\n        )}\n      </div>\n    </>\n  );\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  MAIN COMBAT TRACKER\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nexport default function CombatTracker({ combat, onUpdate, onEnd, party = [], updateParty }) {\n  const [selectedTarget, setSelectedTarget] = useState(null);\n  const [combatLog,      setCombatLog]      = useState([]);\n  const [showSpellPanel, setShowSpellPanel] = useState(false);\n\n  if (!combat || !combat.isActive) return null;\n\n  const currentCombatant = getCurrentCombatant(combat);\n  const isPlayerTurn     = !currentCombatant?.isEnemy;\n\n  // Find the full party character for the current combatant (so we have spell data)\n  const partyCharacter = party.find(p => p.name === currentCombatant?.name) || currentCombatant;\n  const isSpellcaster  = SPELLCASTING_CLASSES[partyCharacter?.class];\n  const combatSpells   = isSpellcaster ? getCombatSpells(partyCharacter) : [];\n\n  const addLog = (entry, prevLog = combatLog) => {\n    setCombatLog([entry, ...prevLog]);\n    return [entry, ...prevLog];\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  SHORT REST â€” Warlocks recover all Pact Magic slots\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleShortRest = () => {\n    if (!updateParty) return;\n    let anyRecovered = false;\n\n    const updatedParty = party.map(p => {\n      if (!isWarlockPactMagic(p)) return p;\n      const recovered = shortRest(p);\n      const pact = getWarlockPactSlots(p);\n      addLog(`ðŸ”® ${p.name} takes a short rest and recovers ${pact.slotCount} Pact Magic slot${pact.slotCount > 1 ? 's' : ''} (level ${pact.slotLevel})!`);\n      anyRecovered = true;\n      return recovered;\n    });\n\n    if (!anyRecovered) {\n      addLog('â›º Short rest taken. (Only Warlocks recover spell slots on a short rest.)');\n    }\n\n    updateParty(updatedParty);\n    console.log('[ShortRest] Party updated after short rest.');\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  Helper: clear concentration from a character\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const clearConcentration = (character, reason = '') => {\n    if (!character.concentrationSpell) return character;\n    console.log(`[Concentration] ${character.name} lost concentration on ${character.concentrationSpell}${reason ? ': ' + reason : ''}`);\n    return { ...character, concentrationSpell: null };\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  Helper: run a concentration check after taking damage\n  //  Returns { character (possibly cleared), log entry or null }\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleConcentrationCheck = (character, damageTaken) => {\n    if (!character.concentrationSpell) return { character, logEntry: null };\n    const check = rollConcentrationCheck(damageTaken);\n    if (check.passed) {\n      return {\n        character,\n        logEntry: `ðŸ”® ${character.name} passes concentration check (rolled ${check.roll} vs DC ${check.dc}) â€” still concentrating on ${character.concentrationSpell}.`\n      };\n    } else {\n      const cleared = clearConcentration(character, 'failed concentration check');\n      return {\n        character: cleared,\n        logEntry: `ðŸ’” ${character.name} FAILS concentration check (rolled ${check.roll} vs DC ${check.dc}) â€” ${character.concentrationSpell} ends!`\n      };\n    }\n  };\n\n  // â”€â”€ ATTACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleAttack = (attackIndex = 0) => {\n    if (!selectedTarget) { alert('Select a target first!'); return; }\n\n    const result = executeAttack(currentCombatant, selectedTarget, attackIndex);\n    const logEntry = result.attackRoll.isCritical\n      ? `ðŸ’¥ CRITICAL HIT! ${result.attacker} hits ${result.target} with ${result.attack} for ${result.damage} ${result.damageType} damage!`\n      : result.attackRoll.isFumble\n      ? `âŒ FUMBLE! ${result.attacker} misses ${result.target}!`\n      : result.attackRoll.isHit\n      ? `âš”ï¸ ${result.attacker} hits ${result.target} with ${result.attack} for ${result.damage} ${result.damageType} damage!`\n      : `ðŸ›¡ï¸ ${result.attacker} misses ${result.target}!`;\n\n    let newLog = addLog(logEntry);\n\n    if (result.attackRoll.isHit && result.damage > 0) {\n      const damagedTarget = applyDamage(selectedTarget, result.damage);\n      const updatedCombat = updateCombatant(combat, selectedTarget.id || selectedTarget.name, damagedTarget);\n\n      if (damagedTarget.isDead) addLog(`ðŸ’€ ${damagedTarget.name} has been defeated!`, newLog);\n      onUpdate(updatedCombat);\n\n      // Concentration check if target is a party member concentrating\n      if (updateParty) {\n        const partyTarget = party.find(p => p.name === selectedTarget.name);\n        if (partyTarget?.concentrationSpell) {\n          const { character: afterCheck, logEntry: checkLog } = handleConcentrationCheck(partyTarget, result.damage);\n          if (checkLog) addLog(checkLog);\n          const updatedParty = party.map(p => p.name === afterCheck.name ? afterCheck : p);\n          updateParty(updatedParty);\n        }\n      }\n\n      const endCheck = checkCombatEnd(updatedCombat);\n      if (endCheck.ended) { setTimeout(() => onEnd(endCheck), 1000); return; }\n    }\n\n    handleEndTurn();\n  };\n\n  // â”€â”€ SPELL RESULT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleSpellResult = (result) => {\n    setShowSpellPanel(false);\n    addLog(result.log);\n\n    let currentCombatState = { ...combat };\n\n    // 1. Update caster's spell slots (and concentration state) in the party store\n    if (updateParty && result.updatedCaster) {\n      const updatedParty = party.map(p =>\n        p.name === result.updatedCaster.name ? result.updatedCaster : p\n      );\n      updateParty(updatedParty);\n    }\n\n    // 2. Apply damage to target\n    if (result.damage > 0 && result.hit && selectedTarget) {\n      const damagedTarget = applyDamage(selectedTarget, result.damage, result.damageType);\n      currentCombatState  = updateCombatant(currentCombatState, selectedTarget.id || selectedTarget.name, damagedTarget);\n      if (damagedTarget.isDead) addLog(`ðŸ’€ ${damagedTarget.name} has been defeated!`);\n      onUpdate(currentCombatState);\n\n      // Concentration check for the damaged target if they're a party member concentrating\n      if (updateParty) {\n        const partyTarget = party.find(p => p.name === selectedTarget.name);\n        if (partyTarget?.concentrationSpell) {\n          const { character: afterCheck, logEntry: checkLog } = handleConcentrationCheck(partyTarget, result.damage);\n          if (checkLog) addLog(checkLog);\n          const updatedParty = party.map(p => p.name === afterCheck.name ? afterCheck : p);\n          updateParty(updatedParty);\n        }\n      }\n\n      const endCheck = checkCombatEnd(currentCombatState);\n      if (endCheck.ended) { setTimeout(() => onEnd(endCheck), 1000); return; }\n    }\n\n    // 3. Apply healing\n    if (result.healing > 0 && updateParty) {\n      const healedCaster = {\n        ...result.updatedCaster,\n        hp: Math.min(result.updatedCaster.maxHp, (result.updatedCaster.hp || 0) + result.healing)\n      };\n      const updatedParty = party.map(p => p.name === healedCaster.name ? healedCaster : p);\n      updateParty(updatedParty);\n    }\n\n    // 4. Apply status effect to target\n    if (result.statusApplied && selectedTarget && updateParty) {\n      const effect = createStatusEffect({\n        type: result.statusApplied.type,\n        duration: result.statusApplied.duration || 1,\n        durationType: result.statusApplied.durationType || DURATION_TYPES.ROUNDS,\n        saveDC: result.statusApplied.saveDC,\n        spellName: result.statusApplied.spellName,\n        source: result.casterName\n      });\n      if (effect) {\n        const partyTarget = party.find(p => p.name === selectedTarget.name);\n        if (partyTarget && updateParty) {\n          let withEffect = applyStatusEffect(partyTarget, effect);\n          // Auto-break concentration if a concentration-ending condition was applied\n          if (CONCENTRATION_BREAKING_CONDITIONS.has(result.statusApplied.type) && withEffect.concentrationSpell) {\n            const dropped = withEffect.concentrationSpell;\n            withEffect = clearConcentration(withEffect, `gained ${effect.name} condition`);\n            addLog(`ðŸ’” ${selectedTarget.name} loses concentration on ${dropped} (gained ${effect.name})!`);\n          }\n          const updatedParty = party.map(p => p.name === withEffect.name ? withEffect : p);\n          updateParty(updatedParty);\n          addLog(`ðŸŒ€ ${selectedTarget.name} is now ${effect.name}!`);\n        }\n      }\n    }\n\n    handleEndTurn();\n  };\n\n  // â”€â”€ END TURN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleEndTurn = () => {\n    setSelectedTarget(null);\n    setShowSpellPanel(false);\n    const newCombat = nextTurn(combat);\n    onUpdate(newCombat);\n\n    setTimeout(() => {\n      if (newCombat.combatants[newCombat.currentTurn]?.isEnemy) {\n        handleEnemyTurn(newCombat);\n      }\n    }, 500);\n  };\n\n  // â”€â”€ ENEMY TURN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleEnemyTurn = (currentCombat) => {\n    const enemy = getCurrentCombatant(currentCombat);\n    if (!enemy || enemy.isDead) { handleEndTurn(); return; }\n\n    const aliveParty = currentCombat.combatants.filter(c => !c.isEnemy && !c.isDead);\n    if (aliveParty.length === 0) return;\n\n    const target = aliveParty[Math.floor(Math.random() * aliveParty.length)];\n    const result = executeAttack(enemy, target, 0);\n\n    const logEntry = result.attackRoll.isCritical\n      ? `ðŸ’¥ CRITICAL! ${result.attacker} critically hits ${result.target} for ${result.damage} damage!`\n      : result.attackRoll.isHit\n      ? `âš”ï¸ ${result.attacker} hits ${result.target} for ${result.damage} damage!`\n      : `ðŸ›¡ï¸ ${result.attacker} misses ${result.target}!`;\n\n    addLog(logEntry);\n\n    if (result.attackRoll.isHit && result.damage > 0) {\n      const damagedTarget = applyDamage(target, result.damage);\n      let updatedCombat   = updateCombatant(currentCombat, target.id || target.name, damagedTarget);\n      if (damagedTarget.isDead) addLog(`ðŸ’€ ${damagedTarget.name} has fallen!`);\n      onUpdate(updatedCombat);\n\n      // Concentration check for attacked party member\n      if (updateParty) {\n        const partyTarget = party.find(p => p.name === target.name);\n        if (partyTarget?.concentrationSpell) {\n          const { character: afterCheck, logEntry: checkLog } = handleConcentrationCheck(partyTarget, result.damage);\n          if (checkLog) addLog(checkLog);\n          const updatedParty = party.map(p => p.name === afterCheck.name ? afterCheck : p);\n          updateParty(updatedParty);\n        }\n      }\n\n      const endCheck = checkCombatEnd(updatedCombat);\n      if (endCheck.ended) { setTimeout(() => onEnd(endCheck), 1000); return; }\n    }\n\n    setTimeout(() => handleEndTurn(), 1500);\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  RENDER\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  return (\n    <div style={{\n      position: 'fixed',\n      bottom: 0,\n      left: 0,\n      right: 0,\n      backgroundColor: '#120808',\n      border: '3px solid #d32f2f',\n      borderBottom: 'none',\n      padding: '20px',\n      maxHeight: '65vh',\n      overflowY: 'auto',\n      zIndex: 1000,\n      boxShadow: '0 -4px 20px rgba(211,47,47,0.4)'\n    }}>\n      {/* Header row */}\n      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '15px', paddingBottom: '15px', borderBottom: '2px solid #2a2a2a' }}>\n        <h2 style={{ margin: 0, color: '#d32f2f', fontSize: '24px' }}>\n          âš”ï¸ Combat â€” Round {combat.round}\n        </h2>\n        <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>\n          {/* Short rest â€” always visible; especially important for Warlocks */}\n          <button\n            onClick={handleShortRest}\n            title=\"Short Rest: Warlocks recover all Pact Magic slots\"\n            style={{\n              padding: '8px 14px',\n              backgroundColor: '#1a0a2e',\n              color: '#9C27B0',\n              border: '1px solid #6A1B9A',\n              borderRadius: '5px',\n              cursor: 'pointer',\n              fontSize: '13px'\n            }}\n          >\n            â›º Short Rest\n          </button>\n          <button\n            onClick={() => onEnd({ ended: true, result: 'flee', message: 'Combat ended' })}\n            style={{ padding: '8px 16px', backgroundColor: '#333', color: '#aaa', border: '1px solid #555', borderRadius: '5px', cursor: 'pointer' }}\n          >\n            End Combat\n          </button>\n        </div>\n      </div>\n\n      {/* Initiative track */}\n      <div style={{ display: 'flex', gap: '10px', marginBottom: '15px', overflowX: 'auto', paddingBottom: '10px' }}>\n        {combat.combatants.map((combatant, index) => {\n          // Find this combatant's party entry to check concentration\n          const partyEntry  = party.find(p => p.name === combatant.name);\n          const isConcentrating = partyEntry?.concentrationSpell;\n          const isActive    = index === combat.currentTurn;\n\n          return (\n            <div\n              key={combatant.id || combatant.name}\n              style={{\n                minWidth: '120px',\n                padding: '10px',\n                backgroundColor: isActive ? '#2a0000' : '#1a1a1a',\n                border: isActive ? '2px solid #ffd700' : '2px solid #333',\n                borderRadius: '8px',\n                opacity: combatant.isDead ? 0.3 : 1,\n                position: 'relative',\n                flexShrink: 0,\n                // Purple glow for concentrating characters\n                boxShadow: isConcentrating ? '0 0 12px rgba(156,39,176,0.7), inset 0 0 8px rgba(156,39,176,0.2)' : 'none'\n              }}\n            >\n              {isActive && (\n                <div style={{ position: 'absolute', top: '-18px', left: '50%', transform: 'translateX(-50%)', fontSize: '18px' }}>â¬‡ï¸</div>\n              )}\n              <div style={{ fontSize: '11px', color: combatant.isEnemy ? '#ff6b6b' : '#4CAF50', marginBottom: '4px' }}>\n                {combatant.isEnemy ? 'ðŸ‘¹' : 'ðŸ›¡ï¸'} Init: {combatant.initiative}\n              </div>\n              <div style={{ fontWeight: 'bold', fontSize: '13px', marginBottom: '4px', whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>\n                {combatant.name}\n              </div>\n              <div style={{ fontSize: '11px', color: '#888' }}>\n                {combatant.hp}/{combatant.maxHp} HP\n              </div>\n              <div style={{ width: '100%', height: '5px', backgroundColor: '#0a0a0a', borderRadius: '3px', marginTop: '5px', overflow: 'hidden' }}>\n                <div style={{\n                  width: `${Math.max(0, (combatant.hp / combatant.maxHp) * 100)}%`,\n                  height: '100%',\n                  backgroundColor: combatant.hp > combatant.maxHp * 0.5 ? '#4CAF50' : combatant.hp > combatant.maxHp * 0.25 ? '#ff9800' : '#f44336',\n                  transition: 'width 0.3s'\n                }} />\n              </div>\n\n              {/* Concentration indicator */}\n              {isConcentrating && (\n                <div style={{\n                  marginTop: '5px',\n                  fontSize: '10px',\n                  color: '#CE93D8',\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: '3px'\n                }}>\n                  <span>ðŸ”®</span>\n                  <span style={{ overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap', maxWidth: '85px' }}>\n                    {isConcentrating}\n                  </span>\n                </div>\n              )}\n\n              {/* Status effect icons */}\n              {(combatant.conditions?.length > 0) && (\n                <div style={{ marginTop: '4px', fontSize: '12px', display: 'flex', gap: '2px', flexWrap: 'wrap' }}>\n                  {combatant.conditions.slice(0, 3).map(c => (\n                    <span key={c.id} title={c.name}>{c.icon}</span>\n                  ))}\n                  {combatant.conditions.length > 3 && <span style={{ color: '#888' }}>+{combatant.conditions.length - 3}</span>}\n                </div>\n              )}\n\n              {combatant.isDead && (\n                <div style={{ position: 'absolute', inset: 0, display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '36px', backgroundColor: 'rgba(0,0,0,0.5)', borderRadius: '8px' }}>ðŸ’€</div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n\n      {/* Combat Log */}\n      <div style={{ backgroundColor: '#0a0a0a', padding: '10px', borderRadius: '8px', marginBottom: '15px', maxHeight: '100px', overflowY: 'auto', border: '1px solid #222' }}>\n        {combatLog.length === 0\n          ? <p style={{ margin: 0, color: '#444', fontStyle: 'italic', fontSize: '13px' }}>Combat beginsâ€¦</p>\n          : combatLog.map((log, i) => (\n            <div key={i} style={{ padding: '3px 5px', color: i === 0 ? '#eee' : '#777', fontSize: '13px', borderBottom: i < combatLog.length - 1 ? '1px solid #111' : 'none' }}>\n              {log}\n            </div>\n          ))\n        }\n      </div>\n\n      {/* Action Panel */}\n      <div style={{ backgroundColor: '#1a1a1a', padding: '15px', borderRadius: '8px', border: '2px solid #333' }}>\n        <h3 style={{ margin: '0 0 12px 0', color: '#ffd700', fontSize: '16px' }}>\n          {currentCombatant?.name}'s Turn\n          {isPlayerTurn && isSpellcaster && (\n            <span style={{ marginLeft: '10px', fontSize: '12px', color: '#CE93D8' }}>âœ¨ Spellcaster</span>\n          )}\n          {isPlayerTurn && partyCharacter?.concentrationSpell && (\n            <span style={{\n              marginLeft: '10px',\n              fontSize: '11px',\n              color: '#CE93D8',\n              backgroundColor: 'rgba(156,39,176,0.2)',\n              padding: '2px 8px',\n              borderRadius: '10px',\n              border: '1px solid #6A1B9A'\n            }}>\n              ðŸ”® {partyCharacter.concentrationSpell}\n            </span>\n          )}\n        </h3>\n\n        {isPlayerTurn && !currentCombatant?.isDead && (\n          <div>\n            {/* Target Selection */}\n            <div style={{ marginBottom: '12px' }}>\n              <div style={{ fontSize: '12px', color: '#888', marginBottom: '6px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>\n                Select Target\n              </div>\n              <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>\n                {combat.combatants.filter(c => c.isEnemy && !c.isDead).map(enemy => (\n                  <button\n                    key={enemy.id || enemy.name}\n                    onClick={() => setSelectedTarget(enemy)}\n                    style={{\n                      padding: '8px 14px',\n                      backgroundColor: selectedTarget?.name === enemy.name ? '#3a0000' : '#2a1010',\n                      color: selectedTarget?.name === enemy.name ? '#ff6b6b' : '#ccc',\n                      border: `2px solid ${selectedTarget?.name === enemy.name ? '#d32f2f' : '#333'}`,\n                      borderRadius: '6px',\n                      cursor: 'pointer',\n                      fontSize: '13px',\n                      transition: 'all 0.15s'\n                    }}\n                  >\n                    ðŸ‘¹ {enemy.name}\n                    <span style={{ color: '#666', marginLeft: '6px', fontSize: '11px' }}>\n                      {enemy.hp}/{enemy.maxHp} HP\n                    </span>\n                  </button>\n                ))}\n                {combat.combatants.filter(c => c.isEnemy && !c.isDead).length === 0 && (\n                  <span style={{ color: '#888', fontStyle: 'italic', fontSize: '13px' }}>No living enemies</span>\n                )}\n              </div>\n            </div>\n\n            {/* Action Buttons Row */}\n            <div style={{ display: 'flex', gap: '10px', flexWrap: 'wrap', marginBottom: '10px', alignItems: 'flex-start' }}>\n              {/* Attack buttons */}\n              {currentCombatant.attacks?.map((attack, index) => (\n                <button\n                  key={index}\n                  onClick={() => handleAttack(index)}\n                  disabled={!selectedTarget}\n                  style={{\n                    padding: '10px 18px',\n                    backgroundColor: selectedTarget ? '#1a3a1a' : '#1a1a1a',\n                    color: selectedTarget ? '#4CAF50' : '#555',\n                    border: `2px solid ${selectedTarget ? '#4CAF50' : '#333'}`,\n                    borderRadius: '8px',\n                    cursor: selectedTarget ? 'pointer' : 'not-allowed',\n                    fontSize: '14px',\n                    fontWeight: 'bold',\n                    transition: 'all 0.15s'\n                  }}\n                >\n                  âš”ï¸ {attack.name}\n                  <span style={{ display: 'block', fontSize: '10px', color: selectedTarget ? '#81C784' : '#444', fontWeight: 'normal' }}>\n                    +{attack.bonus} to hit â€¢ {attack.damage}\n                  </span>\n                </button>\n              ))}\n\n              {/* Cast Spell button */}\n              {isSpellcaster && (\n                <button\n                  onClick={() => setShowSpellPanel(p => !p)}\n                  style={{\n                    padding: '10px 18px',\n                    backgroundColor: showSpellPanel ? '#2a0a3a' : '#1a0a2a',\n                    color: showSpellPanel ? '#CE93D8' : '#9C27B0',\n                    border: `2px solid ${showSpellPanel ? '#CE93D8' : '#6A1B9A'}`,\n                    borderRadius: '8px',\n                    cursor: 'pointer',\n                    fontSize: '14px',\n                    fontWeight: 'bold',\n                    transition: 'all 0.15s',\n                    position: 'relative'\n                  }}\n                >\n                  âœ¨ Cast Spell\n                  <span style={{ display: 'block', fontSize: '10px', color: '#888', fontWeight: 'normal' }}>\n                    {combatSpells.length} available\n                  </span>\n                  {partyCharacter?.concentrationSpell && (\n                    <span style={{\n                      position: 'absolute',\n                      top: '-8px',\n                      right: '-8px',\n                      width: '16px',\n                      height: '16px',\n                      backgroundColor: '#9C27B0',\n                      borderRadius: '50%',\n                      fontSize: '10px',\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center'\n                    }}>ðŸ”®</span>\n                  )}\n                </button>\n              )}\n\n              {/* End Turn */}\n              <button\n                onClick={handleEndTurn}\n                style={{\n                  padding: '10px 18px',\n                  backgroundColor: '#1a1a1a',\n                  color: '#888',\n                  border: '2px solid #333',\n                  borderRadius: '8px',\n                  cursor: 'pointer',\n                  fontSize: '14px',\n                  marginLeft: 'auto',\n                  transition: 'all 0.15s'\n                }}\n              >\n                End Turn â†’\n              </button>\n            </div>\n\n            {/* Spell Panel */}\n            {showSpellPanel && isSpellcaster && (\n              <SpellCastPanel\n                caster={partyCharacter}\n                combatSpells={combatSpells}\n                selectedTarget={selectedTarget}\n                onSpellResult={handleSpellResult}\n                onClose={() => setShowSpellPanel(false)}\n              />\n            )}\n          </div>\n        )}\n\n        {!isPlayerTurn && (\n          <p style={{ margin: 0, color: '#ff6b6b', fontStyle: 'italic', fontSize: '14px' }}>\n            âš”ï¸ Enemy is actingâ€¦\n          </p>\n        )}\n\n        {currentCombatant?.isDead && (\n          <p style={{ margin: 0, color: '#555', fontSize: '14px' }}>\n            This combatant has been defeated. Advance the turn.\n          </p>\n        )}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}