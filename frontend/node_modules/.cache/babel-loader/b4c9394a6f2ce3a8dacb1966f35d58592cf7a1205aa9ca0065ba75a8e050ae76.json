{"ast":null,"code":"// frontend/src/utils/inventorySystem.js\n\n/**\n * D&D 5e Inventory System\n * Items, equipment, potions, loot detection\n */\n\n// Item types\nexport const ITEM_TYPES = {\n  WEAPON: 'weapon',\n  ARMOR: 'armor',\n  SHIELD: 'shield',\n  POTION: 'potion',\n  SCROLL: 'scroll',\n  QUEST: 'quest',\n  MISC: 'misc',\n  ACCESSORY: 'accessory'\n};\n\n// Item rarity\nexport const ITEM_RARITY = {\n  COMMON: {\n    name: 'Common',\n    color: '#888'\n  },\n  UNCOMMON: {\n    name: 'Uncommon',\n    color: '#4CAF50'\n  },\n  RARE: {\n    name: 'Rare',\n    color: '#2196F3'\n  },\n  EPIC: {\n    name: 'Epic',\n    color: '#9C27B0'\n  },\n  LEGENDARY: {\n    name: 'Legendary',\n    color: '#ffd700'\n  }\n};\n\n// Weapon templates\nexport const WEAPON_TEMPLATES = {\n  shortsword: {\n    id: 'shortsword',\n    name: 'Shortsword',\n    type: ITEM_TYPES.WEAPON,\n    rarity: ITEM_RARITY.COMMON,\n    damage: '1d6',\n    damageType: 'piercing',\n    properties: ['light', 'finesse'],\n    weight: 2,\n    value: 10,\n    description: 'A simple but effective blade.'\n  },\n  longsword: {\n    id: 'longsword',\n    name: 'Longsword',\n    type: ITEM_TYPES.WEAPON,\n    rarity: ITEM_RARITY.COMMON,\n    damage: '1d8',\n    damageType: 'slashing',\n    properties: ['versatile (1d10)'],\n    weight: 3,\n    value: 15,\n    description: 'A versatile weapon favored by knights.'\n  },\n  greataxe: {\n    id: 'greataxe',\n    name: 'Greataxe',\n    type: ITEM_TYPES.WEAPON,\n    rarity: ITEM_RARITY.COMMON,\n    damage: '1d12',\n    damageType: 'slashing',\n    properties: ['heavy', 'two-handed'],\n    weight: 7,\n    value: 30,\n    description: 'A massive axe that cleaves through foes.'\n  },\n  dagger: {\n    id: 'dagger',\n    name: 'Dagger',\n    type: ITEM_TYPES.WEAPON,\n    rarity: ITEM_RARITY.COMMON,\n    damage: '1d4',\n    damageType: 'piercing',\n    properties: ['light', 'finesse', 'thrown (20/60)'],\n    weight: 1,\n    value: 2,\n    description: 'A small blade useful in close quarters.'\n  },\n  staff: {\n    id: 'staff',\n    name: 'Quarterstaff',\n    type: ITEM_TYPES.WEAPON,\n    rarity: ITEM_RARITY.COMMON,\n    damage: '1d6',\n    damageType: 'bludgeoning',\n    properties: ['versatile (1d8)'],\n    weight: 4,\n    value: 2,\n    description: 'A simple wooden staff.'\n  },\n  bow: {\n    id: 'bow',\n    name: 'Longbow',\n    type: ITEM_TYPES.WEAPON,\n    rarity: ITEM_RARITY.COMMON,\n    damage: '1d8',\n    damageType: 'piercing',\n    properties: ['ammunition (80/320)', 'heavy', 'two-handed'],\n    weight: 2,\n    value: 50,\n    description: 'A powerful ranged weapon.'\n  }\n};\n\n// Armor templates\nexport const ARMOR_TEMPLATES = {\n  leather: {\n    id: 'leather',\n    name: 'Leather Armor',\n    type: ITEM_TYPES.ARMOR,\n    rarity: ITEM_RARITY.COMMON,\n    ac: 11,\n    acBonus: 'DEX',\n    weight: 10,\n    value: 10,\n    description: 'Light and flexible protection.'\n  },\n  chainmail: {\n    id: 'chainmail',\n    name: 'Chainmail',\n    type: ITEM_TYPES.ARMOR,\n    rarity: ITEM_RARITY.COMMON,\n    ac: 16,\n    acBonus: null,\n    weight: 55,\n    value: 75,\n    description: 'Heavy metal armor that clinks with each step.'\n  },\n  plate: {\n    id: 'plate',\n    name: 'Plate Armor',\n    type: ITEM_TYPES.ARMOR,\n    rarity: ITEM_RARITY.UNCOMMON,\n    ac: 18,\n    acBonus: null,\n    weight: 65,\n    value: 1500,\n    description: 'The finest protection money can buy.'\n  }\n};\n\n// Potion templates\nexport const POTION_TEMPLATES = {\n  healing: {\n    id: 'healing',\n    name: 'Potion of Healing',\n    type: ITEM_TYPES.POTION,\n    rarity: ITEM_RARITY.COMMON,\n    effect: 'heal',\n    power: '2d4+2',\n    weight: 0.5,\n    value: 50,\n    description: 'A red liquid that restores vitality.',\n    consumable: true\n  },\n  greater_healing: {\n    id: 'greater_healing',\n    name: 'Potion of Greater Healing',\n    type: ITEM_TYPES.POTION,\n    rarity: ITEM_RARITY.UNCOMMON,\n    effect: 'heal',\n    power: '4d4+4',\n    weight: 0.5,\n    value: 150,\n    description: 'A vibrant red potion of exceptional quality.',\n    consumable: true\n  },\n  mana: {\n    id: 'mana',\n    name: 'Potion of Magic',\n    type: ITEM_TYPES.POTION,\n    rarity: ITEM_RARITY.UNCOMMON,\n    effect: 'restore_spell_slot',\n    power: 1,\n    weight: 0.5,\n    value: 100,\n    description: 'A shimmering blue liquid that restores magical energy.',\n    consumable: true\n  }\n};\n\n// Misc item templates\nexport const MISC_TEMPLATES = {\n  gold: {\n    id: 'gold',\n    name: 'Gold Coins',\n    type: ITEM_TYPES.MISC,\n    rarity: ITEM_RARITY.COMMON,\n    weight: 0,\n    value: 1,\n    description: 'Shiny gold coins.',\n    stackable: true\n  },\n  rope: {\n    id: 'rope',\n    name: 'Rope (50 ft)',\n    type: ITEM_TYPES.MISC,\n    rarity: ITEM_RARITY.COMMON,\n    weight: 10,\n    value: 1,\n    description: 'Hempen rope, useful for climbing.'\n  },\n  torch: {\n    id: 'torch',\n    name: 'Torch',\n    type: ITEM_TYPES.MISC,\n    rarity: ITEM_RARITY.COMMON,\n    weight: 1,\n    value: 1,\n    description: 'Provides light in darkness.',\n    stackable: true\n  }\n};\n\n// All item templates combined\nexport const ALL_ITEMS = {\n  ...WEAPON_TEMPLATES,\n  ...ARMOR_TEMPLATES,\n  ...POTION_TEMPLATES,\n  ...MISC_TEMPLATES\n};\n\n/**\n * Create an item instance from template\n */\nexport function createItem(templateId, quantity = 1) {\n  const template = ALL_ITEMS[templateId];\n  if (!template) {\n    console.error('Unknown item template:', templateId);\n    return null;\n  }\n  return {\n    ...template,\n    instanceId: `${templateId}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n    quantity: template.stackable ? quantity : 1,\n    equipped: false\n  };\n}\n\n/**\n * Add item to inventory\n */\nexport function addItemToInventory(inventory, item) {\n  if (!item) return inventory;\n\n  // Check if stackable item already exists\n  if (item.stackable) {\n    const existingIndex = inventory.findIndex(i => i.id === item.id);\n    if (existingIndex !== -1) {\n      const updated = [...inventory];\n      updated[existingIndex] = {\n        ...updated[existingIndex],\n        quantity: updated[existingIndex].quantity + item.quantity\n      };\n      return updated;\n    }\n  }\n  return [...inventory, item];\n}\n\n/**\n * Remove item from inventory\n */\nexport function removeItemFromInventory(inventory, instanceId, quantity = 1) {\n  const itemIndex = inventory.findIndex(i => i.instanceId === instanceId);\n  if (itemIndex === -1) return inventory;\n  const item = inventory[itemIndex];\n  if (item.stackable && item.quantity > quantity) {\n    const updated = [...inventory];\n    updated[itemIndex] = {\n      ...item,\n      quantity: item.quantity - quantity\n    };\n    return updated;\n  }\n  return inventory.filter(i => i.instanceId !== instanceId);\n}\n\n/**\n * Use/consume an item\n */\nexport function useItem(item, character) {\n  if (item.type === ITEM_TYPES.POTION && item.effect === 'heal') {\n    // Roll healing dice\n    const diceMatch = item.power.match(/(\\d+)d(\\d+)\\+(\\d+)/);\n    if (diceMatch) {\n      const [, numDice, dieSize, bonus] = diceMatch;\n      let healing = parseInt(bonus);\n      for (let i = 0; i < parseInt(numDice); i++) {\n        healing += Math.floor(Math.random() * parseInt(dieSize)) + 1;\n      }\n      const newHp = Math.min(character.maxHp, character.hp + healing);\n      return {\n        success: true,\n        message: `${character.name} heals for ${healing} HP!`,\n        healing,\n        newHp\n      };\n    }\n  }\n  return {\n    success: false,\n    message: 'Cannot use this item.'\n  };\n}\n\n/**\n * Equip an item\n */\nexport function equipItem(character, item) {\n  if (item.type === ITEM_TYPES.WEAPON) {\n    return {\n      ...character,\n      equippedItems: {\n        ...character.equippedItems,\n        weapon: item\n      }\n    };\n  }\n  if (item.type === ITEM_TYPES.ARMOR) {\n    return {\n      ...character,\n      equippedItems: {\n        ...character.equippedItems,\n        armor: item\n      },\n      armorClass: item.ac + (item.acBonus === 'DEX' ? Math.floor((character.abilities.DEX - 10) / 2) : 0)\n    };\n  }\n  if (item.type === ITEM_TYPES.SHIELD) {\n    return {\n      ...character,\n      equippedItems: {\n        ...character.equippedItems,\n        shield: item\n      },\n      armorClass: character.armorClass + 2\n    };\n  }\n  return character;\n}\n\n/**\n * Unequip an item\n */\nexport function unequipItem(character, slot) {\n  const newEquipped = {\n    ...character.equippedItems\n  };\n  const item = newEquipped[slot];\n  newEquipped[slot] = null;\n  let newAC = character.armorClass;\n  if (slot === 'shield' && item) {\n    newAC -= 2;\n  }\n  return {\n    ...character,\n    equippedItems: newEquipped,\n    armorClass: newAC\n  };\n}\n\n/**\n * Calculate total inventory weight\n */\nexport function getTotalWeight(inventory) {\n  return inventory.reduce((total, item) => {\n    return total + item.weight * item.quantity;\n  }, 0);\n}\n\n/**\n * Get carrying capacity based on STR\n */\nexport function getCarryingCapacity(character) {\n  return character.abilities.STR * 15; // D&D 5e rule\n}\n\n/**\n * Check if over encumbered\n */\nexport function isEncumbered(character, inventory) {\n  const weight = getTotalWeight(inventory);\n  const capacity = getCarryingCapacity(character);\n  return weight > capacity;\n}\n\n/**\n * Detect items in DM narration\n */\nexport function detectLootInNarration(narration) {\n  const lowerText = narration.toLowerCase();\n  const foundItems = [];\n\n  // Weapon detection\n  const weaponKeywords = {\n    sword: ['sword', 'blade', 'longsword', 'shortsword'],\n    dagger: ['dagger', 'knife'],\n    axe: ['axe', 'greataxe'],\n    bow: ['bow', 'longbow'],\n    staff: ['staff', 'quarterstaff']\n  };\n  Object.entries(weaponKeywords).forEach(([weapon, keywords]) => {\n    if (keywords.some(kw => lowerText.includes(kw))) {\n      foundItems.push(weapon);\n    }\n  });\n\n  // Potion detection\n  if (lowerText.includes('potion') || lowerText.includes('healing')) {\n    foundItems.push('healing');\n  }\n\n  // Gold detection\n  const goldMatch = lowerText.match(/(\\d+)\\s*gold/);\n  if (goldMatch) {\n    foundItems.push({\n      type: 'gold',\n      amount: parseInt(goldMatch[1])\n    });\n  }\n\n  // Armor detection\n  if (lowerText.includes('armor') || lowerText.includes('armour')) {\n    if (lowerText.includes('leather')) foundItems.push('leather');\n    if (lowerText.includes('chain')) foundItems.push('chainmail');\n    if (lowerText.includes('plate')) foundItems.push('plate');\n  }\n  return foundItems.map(item => {\n    if (typeof item === 'object') {\n      return createItem('gold', item.amount);\n    }\n    return createItem(item);\n  }).filter(Boolean);\n}","map":{"version":3,"names":["ITEM_TYPES","WEAPON","ARMOR","SHIELD","POTION","SCROLL","QUEST","MISC","ACCESSORY","ITEM_RARITY","COMMON","name","color","UNCOMMON","RARE","EPIC","LEGENDARY","WEAPON_TEMPLATES","shortsword","id","type","rarity","damage","damageType","properties","weight","value","description","longsword","greataxe","dagger","staff","bow","ARMOR_TEMPLATES","leather","ac","acBonus","chainmail","plate","POTION_TEMPLATES","healing","effect","power","consumable","greater_healing","mana","MISC_TEMPLATES","gold","stackable","rope","torch","ALL_ITEMS","createItem","templateId","quantity","template","console","error","instanceId","Date","now","Math","random","toString","substr","equipped","addItemToInventory","inventory","item","existingIndex","findIndex","i","updated","removeItemFromInventory","itemIndex","filter","useItem","character","diceMatch","match","numDice","dieSize","bonus","parseInt","floor","newHp","min","maxHp","hp","success","message","equipItem","equippedItems","weapon","armor","armorClass","abilities","DEX","shield","unequipItem","slot","newEquipped","newAC","getTotalWeight","reduce","total","getCarryingCapacity","STR","isEncumbered","capacity","detectLootInNarration","narration","lowerText","toLowerCase","foundItems","weaponKeywords","sword","axe","Object","entries","forEach","keywords","some","kw","includes","push","goldMatch","amount","map","Boolean"],"sources":["C:/Users/Hakty/Desktop/AI-Dungeon-Master/frontend/src/utils/inventorySystem.js"],"sourcesContent":["// frontend/src/utils/inventorySystem.js\n\n/**\n * D&D 5e Inventory System\n * Items, equipment, potions, loot detection\n */\n\n// Item types\nexport const ITEM_TYPES = {\n  WEAPON: 'weapon',\n  ARMOR: 'armor',\n  SHIELD: 'shield',\n  POTION: 'potion',\n  SCROLL: 'scroll',\n  QUEST: 'quest',\n  MISC: 'misc',\n  ACCESSORY: 'accessory'\n};\n\n// Item rarity\nexport const ITEM_RARITY = {\n  COMMON: { name: 'Common', color: '#888' },\n  UNCOMMON: { name: 'Uncommon', color: '#4CAF50' },\n  RARE: { name: 'Rare', color: '#2196F3' },\n  EPIC: { name: 'Epic', color: '#9C27B0' },\n  LEGENDARY: { name: 'Legendary', color: '#ffd700' }\n};\n\n// Weapon templates\nexport const WEAPON_TEMPLATES = {\n  shortsword: {\n    id: 'shortsword',\n    name: 'Shortsword',\n    type: ITEM_TYPES.WEAPON,\n    rarity: ITEM_RARITY.COMMON,\n    damage: '1d6',\n    damageType: 'piercing',\n    properties: ['light', 'finesse'],\n    weight: 2,\n    value: 10,\n    description: 'A simple but effective blade.'\n  },\n  longsword: {\n    id: 'longsword',\n    name: 'Longsword',\n    type: ITEM_TYPES.WEAPON,\n    rarity: ITEM_RARITY.COMMON,\n    damage: '1d8',\n    damageType: 'slashing',\n    properties: ['versatile (1d10)'],\n    weight: 3,\n    value: 15,\n    description: 'A versatile weapon favored by knights.'\n  },\n  greataxe: {\n    id: 'greataxe',\n    name: 'Greataxe',\n    type: ITEM_TYPES.WEAPON,\n    rarity: ITEM_RARITY.COMMON,\n    damage: '1d12',\n    damageType: 'slashing',\n    properties: ['heavy', 'two-handed'],\n    weight: 7,\n    value: 30,\n    description: 'A massive axe that cleaves through foes.'\n  },\n  dagger: {\n    id: 'dagger',\n    name: 'Dagger',\n    type: ITEM_TYPES.WEAPON,\n    rarity: ITEM_RARITY.COMMON,\n    damage: '1d4',\n    damageType: 'piercing',\n    properties: ['light', 'finesse', 'thrown (20/60)'],\n    weight: 1,\n    value: 2,\n    description: 'A small blade useful in close quarters.'\n  },\n  staff: {\n    id: 'staff',\n    name: 'Quarterstaff',\n    type: ITEM_TYPES.WEAPON,\n    rarity: ITEM_RARITY.COMMON,\n    damage: '1d6',\n    damageType: 'bludgeoning',\n    properties: ['versatile (1d8)'],\n    weight: 4,\n    value: 2,\n    description: 'A simple wooden staff.'\n  },\n  bow: {\n    id: 'bow',\n    name: 'Longbow',\n    type: ITEM_TYPES.WEAPON,\n    rarity: ITEM_RARITY.COMMON,\n    damage: '1d8',\n    damageType: 'piercing',\n    properties: ['ammunition (80/320)', 'heavy', 'two-handed'],\n    weight: 2,\n    value: 50,\n    description: 'A powerful ranged weapon.'\n  }\n};\n\n// Armor templates\nexport const ARMOR_TEMPLATES = {\n  leather: {\n    id: 'leather',\n    name: 'Leather Armor',\n    type: ITEM_TYPES.ARMOR,\n    rarity: ITEM_RARITY.COMMON,\n    ac: 11,\n    acBonus: 'DEX',\n    weight: 10,\n    value: 10,\n    description: 'Light and flexible protection.'\n  },\n  chainmail: {\n    id: 'chainmail',\n    name: 'Chainmail',\n    type: ITEM_TYPES.ARMOR,\n    rarity: ITEM_RARITY.COMMON,\n    ac: 16,\n    acBonus: null,\n    weight: 55,\n    value: 75,\n    description: 'Heavy metal armor that clinks with each step.'\n  },\n  plate: {\n    id: 'plate',\n    name: 'Plate Armor',\n    type: ITEM_TYPES.ARMOR,\n    rarity: ITEM_RARITY.UNCOMMON,\n    ac: 18,\n    acBonus: null,\n    weight: 65,\n    value: 1500,\n    description: 'The finest protection money can buy.'\n  }\n};\n\n// Potion templates\nexport const POTION_TEMPLATES = {\n  healing: {\n    id: 'healing',\n    name: 'Potion of Healing',\n    type: ITEM_TYPES.POTION,\n    rarity: ITEM_RARITY.COMMON,\n    effect: 'heal',\n    power: '2d4+2',\n    weight: 0.5,\n    value: 50,\n    description: 'A red liquid that restores vitality.',\n    consumable: true\n  },\n  greater_healing: {\n    id: 'greater_healing',\n    name: 'Potion of Greater Healing',\n    type: ITEM_TYPES.POTION,\n    rarity: ITEM_RARITY.UNCOMMON,\n    effect: 'heal',\n    power: '4d4+4',\n    weight: 0.5,\n    value: 150,\n    description: 'A vibrant red potion of exceptional quality.',\n    consumable: true\n  },\n  mana: {\n    id: 'mana',\n    name: 'Potion of Magic',\n    type: ITEM_TYPES.POTION,\n    rarity: ITEM_RARITY.UNCOMMON,\n    effect: 'restore_spell_slot',\n    power: 1,\n    weight: 0.5,\n    value: 100,\n    description: 'A shimmering blue liquid that restores magical energy.',\n    consumable: true\n  }\n};\n\n// Misc item templates\nexport const MISC_TEMPLATES = {\n  gold: {\n    id: 'gold',\n    name: 'Gold Coins',\n    type: ITEM_TYPES.MISC,\n    rarity: ITEM_RARITY.COMMON,\n    weight: 0,\n    value: 1,\n    description: 'Shiny gold coins.',\n    stackable: true\n  },\n  rope: {\n    id: 'rope',\n    name: 'Rope (50 ft)',\n    type: ITEM_TYPES.MISC,\n    rarity: ITEM_RARITY.COMMON,\n    weight: 10,\n    value: 1,\n    description: 'Hempen rope, useful for climbing.'\n  },\n  torch: {\n    id: 'torch',\n    name: 'Torch',\n    type: ITEM_TYPES.MISC,\n    rarity: ITEM_RARITY.COMMON,\n    weight: 1,\n    value: 1,\n    description: 'Provides light in darkness.',\n    stackable: true\n  }\n};\n\n// All item templates combined\nexport const ALL_ITEMS = {\n  ...WEAPON_TEMPLATES,\n  ...ARMOR_TEMPLATES,\n  ...POTION_TEMPLATES,\n  ...MISC_TEMPLATES\n};\n\n/**\n * Create an item instance from template\n */\nexport function createItem(templateId, quantity = 1) {\n  const template = ALL_ITEMS[templateId];\n  if (!template) {\n    console.error('Unknown item template:', templateId);\n    return null;\n  }\n\n  return {\n    ...template,\n    instanceId: `${templateId}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n    quantity: template.stackable ? quantity : 1,\n    equipped: false\n  };\n}\n\n/**\n * Add item to inventory\n */\nexport function addItemToInventory(inventory, item) {\n  if (!item) return inventory;\n\n  // Check if stackable item already exists\n  if (item.stackable) {\n    const existingIndex = inventory.findIndex(i => i.id === item.id);\n    if (existingIndex !== -1) {\n      const updated = [...inventory];\n      updated[existingIndex] = {\n        ...updated[existingIndex],\n        quantity: updated[existingIndex].quantity + item.quantity\n      };\n      return updated;\n    }\n  }\n\n  return [...inventory, item];\n}\n\n/**\n * Remove item from inventory\n */\nexport function removeItemFromInventory(inventory, instanceId, quantity = 1) {\n  const itemIndex = inventory.findIndex(i => i.instanceId === instanceId);\n  if (itemIndex === -1) return inventory;\n\n  const item = inventory[itemIndex];\n  \n  if (item.stackable && item.quantity > quantity) {\n    const updated = [...inventory];\n    updated[itemIndex] = {\n      ...item,\n      quantity: item.quantity - quantity\n    };\n    return updated;\n  }\n\n  return inventory.filter(i => i.instanceId !== instanceId);\n}\n\n/**\n * Use/consume an item\n */\nexport function useItem(item, character) {\n  if (item.type === ITEM_TYPES.POTION && item.effect === 'heal') {\n    // Roll healing dice\n    const diceMatch = item.power.match(/(\\d+)d(\\d+)\\+(\\d+)/);\n    if (diceMatch) {\n      const [, numDice, dieSize, bonus] = diceMatch;\n      let healing = parseInt(bonus);\n      for (let i = 0; i < parseInt(numDice); i++) {\n        healing += Math.floor(Math.random() * parseInt(dieSize)) + 1;\n      }\n      \n      const newHp = Math.min(character.maxHp, character.hp + healing);\n      return {\n        success: true,\n        message: `${character.name} heals for ${healing} HP!`,\n        healing,\n        newHp\n      };\n    }\n  }\n\n  return {\n    success: false,\n    message: 'Cannot use this item.'\n  };\n}\n\n/**\n * Equip an item\n */\nexport function equipItem(character, item) {\n  if (item.type === ITEM_TYPES.WEAPON) {\n    return {\n      ...character,\n      equippedItems: {\n        ...character.equippedItems,\n        weapon: item\n      }\n    };\n  }\n\n  if (item.type === ITEM_TYPES.ARMOR) {\n    return {\n      ...character,\n      equippedItems: {\n        ...character.equippedItems,\n        armor: item\n      },\n      armorClass: item.ac + (item.acBonus === 'DEX' ? Math.floor((character.abilities.DEX - 10) / 2) : 0)\n    };\n  }\n\n  if (item.type === ITEM_TYPES.SHIELD) {\n    return {\n      ...character,\n      equippedItems: {\n        ...character.equippedItems,\n        shield: item\n      },\n      armorClass: character.armorClass + 2\n    };\n  }\n\n  return character;\n}\n\n/**\n * Unequip an item\n */\nexport function unequipItem(character, slot) {\n  const newEquipped = { ...character.equippedItems };\n  const item = newEquipped[slot];\n  newEquipped[slot] = null;\n\n  let newAC = character.armorClass;\n  if (slot === 'shield' && item) {\n    newAC -= 2;\n  }\n\n  return {\n    ...character,\n    equippedItems: newEquipped,\n    armorClass: newAC\n  };\n}\n\n/**\n * Calculate total inventory weight\n */\nexport function getTotalWeight(inventory) {\n  return inventory.reduce((total, item) => {\n    return total + (item.weight * item.quantity);\n  }, 0);\n}\n\n/**\n * Get carrying capacity based on STR\n */\nexport function getCarryingCapacity(character) {\n  return character.abilities.STR * 15; // D&D 5e rule\n}\n\n/**\n * Check if over encumbered\n */\nexport function isEncumbered(character, inventory) {\n  const weight = getTotalWeight(inventory);\n  const capacity = getCarryingCapacity(character);\n  return weight > capacity;\n}\n\n/**\n * Detect items in DM narration\n */\nexport function detectLootInNarration(narration) {\n  const lowerText = narration.toLowerCase();\n  const foundItems = [];\n\n  // Weapon detection\n  const weaponKeywords = {\n    sword: ['sword', 'blade', 'longsword', 'shortsword'],\n    dagger: ['dagger', 'knife'],\n    axe: ['axe', 'greataxe'],\n    bow: ['bow', 'longbow'],\n    staff: ['staff', 'quarterstaff']\n  };\n\n  Object.entries(weaponKeywords).forEach(([weapon, keywords]) => {\n    if (keywords.some(kw => lowerText.includes(kw))) {\n      foundItems.push(weapon);\n    }\n  });\n\n  // Potion detection\n  if (lowerText.includes('potion') || lowerText.includes('healing')) {\n    foundItems.push('healing');\n  }\n\n  // Gold detection\n  const goldMatch = lowerText.match(/(\\d+)\\s*gold/);\n  if (goldMatch) {\n    foundItems.push({ type: 'gold', amount: parseInt(goldMatch[1]) });\n  }\n\n  // Armor detection\n  if (lowerText.includes('armor') || lowerText.includes('armour')) {\n    if (lowerText.includes('leather')) foundItems.push('leather');\n    if (lowerText.includes('chain')) foundItems.push('chainmail');\n    if (lowerText.includes('plate')) foundItems.push('plate');\n  }\n\n  return foundItems.map(item => {\n    if (typeof item === 'object') {\n      return createItem('gold', item.amount);\n    }\n    return createItem(item);\n  }).filter(Boolean);\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}