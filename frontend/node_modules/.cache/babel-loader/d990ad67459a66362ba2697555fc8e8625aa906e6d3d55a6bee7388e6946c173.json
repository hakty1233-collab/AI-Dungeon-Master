{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Hakty\\\\Desktop\\\\AI-Dungeon-Master\\\\frontend\\\\src\\\\components\\\\CombatTracker.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// frontend/src/components/CombatTracker.jsx - WITH SPELL DAMAGE + CONCENTRATION TRACKING\nimport { useState } from 'react';\nimport { executeAttack, nextTurn, checkCombatEnd, getCurrentCombatant, updateCombatant, applyDamage } from '../utils/combatSystem';\nimport { SPELL_DATABASE, getSpellSlots, canCastSpell, castSpell, getSpellAttackBonus, getSpellSaveDC, calculateSpellDamage, rollSpellDamage, SPELLCASTING_CLASSES } from '../utils/spellSystem';\nimport { createStatusEffect, applyStatusEffect, STATUS_EFFECTS, DURATION_TYPES } from '../utils/statusEffectSystem';\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  HELPERS\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction rollD20() {\n  return Math.floor(Math.random() * 20) + 1;\n}\n\n/** Spells that require concentration */\nconst CONCENTRATION_SPELLS = new Set(['bless', 'bane', 'faerie_fire', 'fog_cloud', 'guiding_bolt', 'hold_person', 'invisibility', 'magic_weapon', 'mirror_image', 'misty_step', 'prayer_of_healing', 'silence', 'spider_climb', 'spiritual_weapon', 'arcane_eye', 'banishment', 'black_tentacles', 'confusion', 'conjure_animals', 'conjure_woodland_beings', 'control_water', 'dimension_door', 'dominate_beast', 'evards_black_tentacles', 'faithful_hound', 'fire_shield', 'freedom_of_movement', 'giant_insect', 'greater_invisibility', 'guardian_of_faith', 'hallucinatory_terrain', 'ice_storm', 'locate_creature', 'phantasmal_killer', 'polymorph', 'resilient_sphere', 'stone_skin', 'wall_of_fire', 'animate_objects', 'antilife_shell', 'arcane_hand', 'cloudkill', 'conjure_elemental', 'contact_other_plane', 'control_winds', 'danse_macabre', 'dawn', 'destructive_wave', 'dominate_person', 'far_step', 'grappling_vine', 'haste', 'hold_monster', 'insect_plague', 'legend_lore', 'maelstrom', 'mass_cure_wounds', 'mislead', 'modify_memory', 'passwall', 'planar_binding', 'seeming', 'synaptic_static', 'teleportation_circle', 'wall_of_force', 'wall_of_stone', 'wind_walk', 'witch_bolt', 'call_lightning', 'conjure_barrage', 'conjure_volley', 'sleet_storm', 'slow', 'speak_with_dead', 'summon_lesser_demons', 'thunder_step', 'tidal_wave', 'vitriolic_sphere', 'web', 'wind_wall', 'wrathful_smite', 'locate_object', 'darkvision', 'enhance_ability', 'enlarge_reduce', 'flame_blade', 'heat_metal', 'hold_person', 'levitate', 'melf_acid_arrow', 'mind_spike', 'moonbeam', 'pass_without_trace', 'protection_from_energy', 'rope_trick', 'see_invisibility', 'shatter', 'blindness_deafness', 'blur', 'crown_of_madness', 'darkness', 'detect_thoughts', 'enthrall', 'flaming_sphere', 'gust_of_wind', 'hold_person', 'magic_mouth', 'maximilian_earthen_grasp', 'mirror_image', 'nystul_magic_aura', 'phantasmal_force', 'ray_of_enfeeblement', 'shadow_blade']);\n\n/** Conditions that break concentration */\nconst CONCENTRATION_BREAKING_CONDITIONS = new Set([STATUS_EFFECTS.INCAPACITATED, STATUS_EFFECTS.STUNNED, STATUS_EFFECTS.PARALYZED, STATUS_EFFECTS.UNCONSCIOUS, STATUS_EFFECTS.PETRIFIED]);\n\n/** Map spell types that apply status effects */\nconst SPELL_STATUS_EFFECTS = {\n  hold_person: {\n    type: STATUS_EFFECTS.PARALYZED,\n    duration: 10,\n    durationType: DURATION_TYPES.SAVE_ENDS,\n    saveDC: null\n  },\n  sleep: {\n    type: STATUS_EFFECTS.UNCONSCIOUS,\n    duration: 1,\n    durationType: DURATION_TYPES.MINUTES\n  },\n  haste: {\n    type: STATUS_EFFECTS.HASTED,\n    duration: 10,\n    durationType: DURATION_TYPES.ROUNDS\n  },\n  invisibility: {\n    type: STATUS_EFFECTS.INVISIBLE,\n    duration: 60,\n    durationType: DURATION_TYPES.MINUTES\n  },\n  greater_invisibility: {\n    type: STATUS_EFFECTS.INVISIBLE,\n    duration: 10,\n    durationType: DURATION_TYPES.ROUNDS\n  }\n};\n\n/** Colour band per spell level */\nfunction spellLevelColor(level) {\n  const c = ['#4CAF50', '#2196F3', '#03A9F4', '#00BCD4', '#009688', '#8BC34A', '#CDDC39', '#FFEB3B', '#FFC107', '#FF9800'];\n  return c[level] || '#888';\n}\n\n/** Get accessible spells for combat (cantrips + prepared/known) */\nfunction getCombatSpells(character) {\n  var _character$spells, _character$spells2, _character$spells3;\n  const cantrips = (((_character$spells = character.spells) === null || _character$spells === void 0 ? void 0 : _character$spells.cantrips) || []).map(k => ({\n    key: k,\n    ...SPELL_DATABASE[k]\n  })).filter(s => s.name);\n  const prepared = (((_character$spells2 = character.spells) === null || _character$spells2 === void 0 ? void 0 : _character$spells2.prepared) || []).map(k => ({\n    key: k,\n    ...SPELL_DATABASE[k]\n  })).filter(s => s.name);\n  const known = (((_character$spells3 = character.spells) === null || _character$spells3 === void 0 ? void 0 : _character$spells3.known) || []).map(k => ({\n    key: k,\n    ...SPELL_DATABASE[k]\n  })).filter(s => s.name);\n  const all = [...cantrips];\n  [...prepared, ...known].forEach(s => {\n    if (!all.find(a => a.key === s.key)) all.push(s);\n  });\n  return all.filter(s => s.damage || s.healing || SPELL_STATUS_EFFECTS[s.key] || ['shield', 'misty_step', 'counterspell', 'fly', 'haste', 'hold_person', 'sleep', 'invisibility', 'greater_invisibility', 'spiritual_weapon'].includes(s.key));\n}\n\n/** Check if a spell requires concentration */\nfunction isConcentrationSpell(spell) {\n  return spell.concentration === true || CONCENTRATION_SPELLS.has(spell.key);\n}\n\n/** Roll a concentration saving throw. Returns { passed, roll, dc } */\nfunction rollConcentrationCheck(damageTaken) {\n  const dc = Math.max(10, Math.floor(damageTaken / 2));\n  const roll = rollD20();\n  return {\n    passed: roll >= dc,\n    roll,\n    dc\n  };\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  CONCENTRATION WARNING MODAL\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nfunction ConcentrationWarningModal({\n  currentSpell,\n  newSpell,\n  onDropAndCast,\n  onCancel\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: 'fixed',\n      inset: 0,\n      backgroundColor: 'rgba(0,0,0,0.85)',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      zIndex: 2000\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#1a0a2e',\n        border: '2px solid #9C27B0',\n        borderRadius: '12px',\n        padding: '24px',\n        maxWidth: '400px',\n        width: '90%',\n        boxShadow: '0 0 30px rgba(156,39,176,0.5)'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: '24px',\n          textAlign: 'center',\n          marginBottom: '12px'\n        },\n        children: \"\\uD83D\\uDD2E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          margin: '0 0 12px 0',\n          color: '#CE93D8',\n          textAlign: 'center'\n        },\n        children: \"Concentration Conflict\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: '#ccc',\n          fontSize: '14px',\n          textAlign: 'center',\n          marginBottom: '8px'\n        },\n        children: [\"You are already concentrating on \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          style: {\n            color: '#CE93D8'\n          },\n          children: currentSpell\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 44\n        }, this), \".\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: '#aaa',\n          fontSize: '13px',\n          textAlign: 'center',\n          marginBottom: '20px'\n        },\n        children: [\"Casting \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          style: {\n            color: '#CE93D8'\n          },\n          children: newSpell\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 19\n        }, this), \" will end your current concentration. Do you want to drop \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: currentSpell\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 31\n        }, this), \" and cast \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: newSpell\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 72\n        }, this), \"?\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: '10px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onDropAndCast,\n          style: {\n            flex: 1,\n            padding: '10px',\n            backgroundColor: '#6A1B9A',\n            color: 'white',\n            border: 'none',\n            borderRadius: '8px',\n            cursor: 'pointer',\n            fontWeight: 'bold',\n            fontSize: '14px'\n          },\n          children: \"Drop & Cast\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onCancel,\n          style: {\n            flex: 1,\n            padding: '10px',\n            backgroundColor: '#333',\n            color: '#aaa',\n            border: '1px solid #555',\n            borderRadius: '8px',\n            cursor: 'pointer',\n            fontSize: '14px'\n          },\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 125,\n    columnNumber: 5\n  }, this);\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  SPELL CAST PANEL (sub-component)\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n_c = ConcentrationWarningModal;\nfunction SpellCastPanel({\n  caster,\n  combatSpells,\n  selectedTarget,\n  onSpellResult,\n  onClose\n}) {\n  _s();\n  var _caster$spellSlots;\n  const [selectedSpell, setSelectedSpell] = useState(null);\n  const [upcastLevel, setUpcastLevel] = useState(null);\n  const [castResult, setCastResult] = useState(null);\n  const [concWarning, setConcWarning] = useState(null); // { currentSpell, newSpell, pendingCast }\n\n  const currentSlots = ((_caster$spellSlots = caster.spellSlots) === null || _caster$spellSlots === void 0 ? void 0 : _caster$spellSlots.current) || getSpellSlots(caster);\n  const spellAttack = getSpellAttackBonus(caster);\n  const spellSaveDC = getSpellSaveDC(caster);\n\n  // Current concentration spell on this caster\n  const activeConc = caster.concentrationSpell || null;\n  const executeCast = (spell, slotLevel) => {\n    const castOutcome = castSpell(caster, spell, slotLevel > 0 ? slotLevel : null);\n    if (!castOutcome.success) {\n      alert(castOutcome.message);\n      return;\n    }\n    const updatedCaster = castOutcome.character;\n\n    // Track concentration on character\n    const isConc = isConcentrationSpell(spell);\n    if (isConc) {\n      updatedCaster.concentrationSpell = spell.name;\n    }\n    let result = {\n      spellName: spell.name,\n      casterName: caster.name,\n      targetName: (selectedTarget === null || selectedTarget === void 0 ? void 0 : selectedTarget.name) || 'ally',\n      slotLevel,\n      updatedCaster,\n      damage: 0,\n      healing: 0,\n      hit: null,\n      critical: false,\n      statusApplied: null,\n      isConcentration: isConc,\n      droppedConcentration: activeConc,\n      log: ''\n    };\n\n    // â”€â”€ DAMAGE spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    if (spell.damage && selectedTarget) {\n      if (spell.key === 'magic_missile') {\n        const dmgStr = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.damage;\n        const rolled = rollSpellDamage(dmgStr);\n        result.damage = rolled.total;\n        result.hit = true;\n        result.log = `âœ¨ ${caster.name} fires Magic Missile at ${selectedTarget.name} for ${rolled.total} force damage! (auto-hit)`;\n      } else if (spell.key === 'sacred_flame') {\n        const saveRoll = rollD20();\n        const targetSave = selectedTarget.dex ? Math.floor((selectedTarget.dex - 10) / 2) : 0;\n        const saved = saveRoll + targetSave >= spellSaveDC;\n        if (!saved) {\n          const dmgStr = calculateSpellDamage(spell, caster.level) || spell.damage;\n          const rolled = rollSpellDamage(dmgStr);\n          result.damage = rolled.total;\n          result.hit = true;\n          result.log = `ğŸ”¥ Sacred Flame hits ${selectedTarget.name} for ${rolled.total} radiant damage! (DEX save ${saveRoll} failed vs DC ${spellSaveDC})`;\n        } else {\n          result.hit = false;\n          result.log = `ğŸ”¥ ${selectedTarget.name} saves against Sacred Flame! (rolled ${saveRoll} vs DC ${spellSaveDC})`;\n        }\n      } else if (['fireball', 'lightning_bolt', 'thunderwave', 'burning_hands', 'ice_storm', 'cone_of_cold', 'chain_lightning', 'disintegrate', 'finger_of_death', 'meteor_swarm'].includes(spell.key)) {\n        const saveRoll = rollD20();\n        const targetDex = selectedTarget.dex ? Math.floor((selectedTarget.dex - 10) / 2) : 0;\n        const saved = saveRoll + targetDex >= spellSaveDC;\n        const dmgStr = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.damage;\n        const rolled = rollSpellDamage(dmgStr);\n        result.damage = saved ? Math.floor(rolled.total / 2) : rolled.total;\n        result.hit = true;\n        result.log = saved ? `ğŸ’¥ ${caster.name} casts ${spell.name}! ${selectedTarget.name} saves (${saveRoll} vs DC ${spellSaveDC}) â€” takes ${result.damage} ${spell.damageType} damage (half).` : `ğŸ’¥ ${caster.name} casts ${spell.name}! ${selectedTarget.name} fails save (${saveRoll} vs DC ${spellSaveDC}) â€” takes ${result.damage} ${spell.damageType} damage!`;\n      } else {\n        const d20 = rollD20();\n        const total = d20 + spellAttack;\n        const crit = d20 === 20;\n        const hit = crit || total >= (selectedTarget.ac || selectedTarget.armorClass || 12);\n        if (hit) {\n          const dmgStr = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.damage;\n          const rolled = rollSpellDamage(crit ? dmgStr.replace(/(\\d+)d/, (_, n) => `${parseInt(n) * 2}d`) : dmgStr);\n          result.damage = rolled.total;\n          result.hit = true;\n          result.critical = crit;\n          result.log = crit ? `ğŸ’¥ CRITICAL! ${caster.name}'s ${spell.name} hits ${selectedTarget.name} for ${rolled.total} ${spell.damageType} damage!` : `âœ¨ ${caster.name}'s ${spell.name} hits ${selectedTarget.name} for ${rolled.total} ${spell.damageType} damage! (rolled ${total} vs AC ${selectedTarget.ac || selectedTarget.armorClass || '?'})`;\n        } else {\n          result.hit = false;\n          result.log = `âŒ ${caster.name}'s ${spell.name} misses ${selectedTarget.name}! (rolled ${total} vs AC ${selectedTarget.ac || selectedTarget.armorClass || '?'})`;\n        }\n      }\n    }\n    // â”€â”€ HEALING spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    else if (spell.healing) {\n      const dmgStr = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.healing;\n      const rolled = rollSpellDamage(dmgStr);\n      const scAbil = {\n        Cleric: 'WIS',\n        Druid: 'WIS',\n        Paladin: 'CHA',\n        Bard: 'CHA',\n        Ranger: 'WIS'\n      };\n      const abilKey = scAbil[caster.class] || 'INT';\n      const mod = caster.abilities ? Math.floor((caster.abilities[abilKey] - 10) / 2) : 0;\n      result.healing = rolled.total + mod;\n      result.log = `ğŸ’š ${caster.name} casts ${spell.name} and heals for ${result.healing} HP!`;\n    }\n    // â”€â”€ STATUS EFFECT spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    else if (SPELL_STATUS_EFFECTS[spell.key]) {\n      var _effectDef$saveDC;\n      const effectDef = SPELL_STATUS_EFFECTS[spell.key];\n      const dc = (_effectDef$saveDC = effectDef.saveDC) !== null && _effectDef$saveDC !== void 0 ? _effectDef$saveDC : spellSaveDC;\n      result.statusApplied = {\n        ...effectDef,\n        saveDC: dc,\n        spellName: spell.name\n      };\n      result.log = `ğŸŒ€ ${caster.name} casts ${spell.name}${selectedTarget ? ` on ${selectedTarget.name}` : ''}!`;\n    }\n    // â”€â”€ UTILITY spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    else {\n      result.log = `âœ¨ ${caster.name} casts ${spell.name}!`;\n    }\n\n    // Append concentration note\n    if (isConc) {\n      result.log += ` [Concentrating]`;\n      if (activeConc) result.log = `[Dropped ${activeConc}] ` + result.log;\n    }\n    setCastResult(result);\n    onSpellResult(result);\n  };\n  const handleCast = () => {\n    if (!selectedSpell) return;\n    const spell = selectedSpell;\n    const slotLevel = upcastLevel !== null && upcastLevel !== void 0 ? upcastLevel : spell.level || 0;\n\n    // Check concentration conflict\n    if (isConcentrationSpell(spell) && activeConc && activeConc !== spell.name) {\n      setConcWarning({\n        currentSpell: activeConc,\n        newSpell: spell.name,\n        pendingCast: () => executeCast(spell, slotLevel)\n      });\n      return;\n    }\n    executeCast(spell, slotLevel);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [concWarning && /*#__PURE__*/_jsxDEV(ConcentrationWarningModal, {\n      currentSpell: concWarning.currentSpell,\n      newSpell: concWarning.newSpell,\n      onDropAndCast: () => {\n        concWarning.pendingCast();\n        setConcWarning(null);\n      },\n      onCancel: () => setConcWarning(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#12012a',\n        border: '2px solid #9C27B0',\n        borderRadius: '10px',\n        padding: '15px',\n        marginTop: '10px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          marginBottom: '12px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          style: {\n            margin: 0,\n            color: '#CE93D8'\n          },\n          children: \"\\u2728 Cast a Spell\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          style: {\n            background: 'none',\n            border: 'none',\n            color: '#888',\n            cursor: 'pointer',\n            fontSize: '18px'\n          },\n          children: \"\\u2715\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 9\n      }, this), activeConc && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '6px 10px',\n          backgroundColor: 'rgba(156,39,176,0.15)',\n          border: '1px solid #9C27B0',\n          borderRadius: '6px',\n          marginBottom: '10px',\n          fontSize: '12px',\n          color: '#CE93D8',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '6px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uD83D\\uDD2E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 379,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"Concentrating on \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: activeConc\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 380,\n            columnNumber: 36\n          }, this), \" \\u2014 casting another concentration spell will end this.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: '12px',\n          color: '#888',\n          marginBottom: '10px'\n        },\n        children: [\"Spell Attack: \", /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            color: '#CE93D8'\n          },\n          children: [\"+\", spellAttack]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 25\n        }, this), \" \\xA0|\\xA0 Save DC: \", /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            color: '#CE93D8'\n          },\n          children: spellSaveDC\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 20\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: '6px',\n          flexWrap: 'wrap',\n          marginBottom: '12px'\n        },\n        children: getSpellSlots(caster).map((max, i) => {\n          if (max === 0) return null;\n          const cur = currentSlots[i] || 0;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              padding: '4px 8px',\n              backgroundColor: cur > 0 ? '#1a0a2e' : '#1a1a1a',\n              border: `1px solid ${cur > 0 ? spellLevelColor(i + 1) : '#333'}`,\n              borderRadius: '4px',\n              fontSize: '11px',\n              color: cur > 0 ? spellLevelColor(i + 1) : '#555'\n            },\n            children: [\"L\", i + 1, \": \", cur, \"/\", max]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: 'repeat(auto-fill, minmax(160px, 1fr))',\n          gap: '8px',\n          marginBottom: '12px',\n          maxHeight: '200px',\n          overflowY: 'auto'\n        },\n        children: [combatSpells.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: '#666',\n            fontStyle: 'italic',\n            padding: '10px',\n            gridColumn: '1/-1'\n          },\n          children: \"No combat spells available. Open SpellBook to learn spells.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 412,\n          columnNumber: 13\n        }, this), combatSpells.map(spell => {\n          const hasSlotsOrCantrip = spell.level === 0 || (currentSlots[spell.level - 1] || 0) > 0;\n          const isSelected = (selectedSpell === null || selectedSpell === void 0 ? void 0 : selectedSpell.key) === spell.key;\n          const isConc = isConcentrationSpell(spell);\n          const isActiveConc = activeConc === spell.name;\n          return /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              setSelectedSpell(spell);\n              setUpcastLevel(spell.level);\n              setCastResult(null);\n            },\n            disabled: !hasSlotsOrCantrip,\n            style: {\n              padding: '8px 10px',\n              backgroundColor: isSelected ? '#3a0a5a' : '#1a0a2e',\n              border: `2px solid ${isActiveConc ? '#9C27B0' : isSelected ? '#CE93D8' : hasSlotsOrCantrip ? spellLevelColor(spell.level) : '#333'}`,\n              borderRadius: '6px',\n              cursor: hasSlotsOrCantrip ? 'pointer' : 'not-allowed',\n              opacity: hasSlotsOrCantrip ? 1 : 0.4,\n              textAlign: 'left',\n              transition: 'all 0.15s',\n              boxShadow: isActiveConc ? '0 0 8px rgba(156,39,176,0.6)' : 'none'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '13px',\n                fontWeight: 'bold',\n                color: spellLevelColor(spell.level),\n                marginBottom: '3px'\n              },\n              children: spell.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 438,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '10px',\n                color: '#888'\n              },\n              children: [spell.level === 0 ? 'Cantrip' : `Lvl ${spell.level}`, spell.damage && ` â€¢ ${spell.damage} ${spell.damageType}`, spell.healing && ` â€¢ Heals ${spell.healing}`, isConc && /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  color: '#9C27B0'\n                },\n                children: \" \\u2022 \\uD83D\\uDD2E Conc.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 445,\n                columnNumber: 30\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 441,\n              columnNumber: 17\n            }, this)]\n          }, spell.key, true, {\n            fileName: _jsxFileName,\n            lineNumber: 422,\n            columnNumber: 15\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 9\n      }, this), selectedSpell && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          backgroundColor: '#0a0018',\n          borderRadius: '8px',\n          padding: '12px',\n          border: `1px solid ${spellLevelColor(selectedSpell.level)}`\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '8px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              fontWeight: 'bold',\n              color: spellLevelColor(selectedSpell.level)\n            },\n            children: selectedSpell.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 461,\n            columnNumber: 15\n          }, this), isConcentrationSpell(selectedSpell) && /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              marginLeft: '8px',\n              fontSize: '11px',\n              color: '#CE93D8',\n              backgroundColor: 'rgba(156,39,176,0.2)',\n              padding: '2px 6px',\n              borderRadius: '4px',\n              border: '1px solid #6A1B9A'\n            },\n            children: \"\\uD83D\\uDD2E Concentration\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 463,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: '#888',\n              fontSize: '12px',\n              marginLeft: '10px'\n            },\n            children: [selectedSpell.castingTime, \" \\u2022 \", selectedSpell.range]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 460,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '13px',\n            color: '#ccc',\n            marginBottom: '10px'\n          },\n          children: selectedSpell.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 475,\n          columnNumber: 13\n        }, this), isConcentrationSpell(selectedSpell) && activeConc && activeConc !== selectedSpell.name && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '8px 10px',\n            backgroundColor: 'rgba(255,152,0,0.1)',\n            border: '1px solid #ff9800',\n            borderRadius: '6px',\n            marginBottom: '10px',\n            fontSize: '12px',\n            color: '#ffb74d'\n          },\n          children: [\"\\u26A0\\uFE0F Casting this will drop \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: activeConc\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 488,\n            columnNumber: 43\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 479,\n          columnNumber: 15\n        }, this), selectedSpell.level > 0 && selectedSpell.upcastBonus && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '10px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '11px',\n              color: '#888',\n              marginBottom: '6px'\n            },\n            children: \"Cast at level:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 495,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: '6px',\n              flexWrap: 'wrap'\n            },\n            children: Array.from({\n              length: 10 - selectedSpell.level\n            }, (_, i) => selectedSpell.level + i).map(lvl => {\n              const slotsLeft = currentSlots[lvl - 1] || 0;\n              if (getSpellSlots(caster)[lvl - 1] === 0) return null;\n              return /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setUpcastLevel(lvl),\n                disabled: slotsLeft === 0,\n                style: {\n                  padding: '4px 10px',\n                  backgroundColor: upcastLevel === lvl ? spellLevelColor(lvl) : '#1a0a2e',\n                  color: upcastLevel === lvl ? '#000' : slotsLeft > 0 ? '#eee' : '#555',\n                  border: 'none',\n                  borderRadius: '4px',\n                  cursor: slotsLeft > 0 ? 'pointer' : 'not-allowed',\n                  fontSize: '12px',\n                  opacity: slotsLeft > 0 ? 1 : 0.4\n                },\n                children: [\"L\", lvl, \" (\", slotsLeft, \")\"]\n              }, lvl, true, {\n                fileName: _jsxFileName,\n                lineNumber: 501,\n                columnNumber: 23\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 496,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 494,\n          columnNumber: 15\n        }, this), !selectedTarget && selectedSpell.damage && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: '#ff9800',\n            fontSize: '12px',\n            marginBottom: '8px'\n          },\n          children: \"\\u26A0\\uFE0F Select a target enemy above before casting this spell\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 525,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleCast,\n          disabled: !!(selectedSpell.damage && !selectedTarget),\n          style: {\n            width: '100%',\n            padding: '10px',\n            backgroundColor: selectedSpell.damage && !selectedTarget ? '#333' : '#7B1FA2',\n            color: 'white',\n            border: 'none',\n            borderRadius: '6px',\n            cursor: selectedSpell.damage && !selectedTarget ? 'not-allowed' : 'pointer',\n            fontWeight: 'bold',\n            fontSize: '15px',\n            transition: 'background 0.2s'\n          },\n          children: [\"\\u2728 Cast \", selectedSpell.name, upcastLevel && upcastLevel > selectedSpell.level ? ` (Lvl ${upcastLevel})` : '']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 530,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 454,\n        columnNumber: 11\n      }, this), castResult && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '10px',\n          padding: '10px',\n          backgroundColor: castResult.hit === false ? '#1a0a0a' : '#0a1a0a',\n          borderRadius: '6px',\n          border: `1px solid ${castResult.hit === false ? '#f44336' : '#4CAF50'}`,\n          fontSize: '13px',\n          color: '#eee'\n        },\n        children: castResult.log\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 553,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  MAIN COMBAT TRACKER\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n_s(SpellCastPanel, \"Kf8N/u5IBMRSMkWLC3VK8SqsLA8=\");\n_c2 = SpellCastPanel;\nexport default function CombatTracker({\n  combat,\n  onUpdate,\n  onEnd,\n  party = [],\n  updateParty\n}) {\n  _s2();\n  var _currentCombatant$att;\n  const [selectedTarget, setSelectedTarget] = useState(null);\n  const [combatLog, setCombatLog] = useState([]);\n  const [showSpellPanel, setShowSpellPanel] = useState(false);\n  if (!combat || !combat.isActive) return null;\n  const currentCombatant = getCurrentCombatant(combat);\n  const isPlayerTurn = !(currentCombatant !== null && currentCombatant !== void 0 && currentCombatant.isEnemy);\n\n  // Find the full party character for the current combatant (so we have spell data)\n  const partyCharacter = party.find(p => p.name === (currentCombatant === null || currentCombatant === void 0 ? void 0 : currentCombatant.name)) || currentCombatant;\n  const isSpellcaster = SPELLCASTING_CLASSES[partyCharacter === null || partyCharacter === void 0 ? void 0 : partyCharacter.class];\n  const combatSpells = isSpellcaster ? getCombatSpells(partyCharacter) : [];\n  const addLog = (entry, prevLog = combatLog) => {\n    setCombatLog([entry, ...prevLog]);\n    return [entry, ...prevLog];\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  Helper: clear concentration from a character\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const clearConcentration = (character, reason = '') => {\n    if (!character.concentrationSpell) return character;\n    console.log(`[Concentration] ${character.name} lost concentration on ${character.concentrationSpell}${reason ? ': ' + reason : ''}`);\n    return {\n      ...character,\n      concentrationSpell: null\n    };\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  Helper: run a concentration check after taking damage\n  //  Returns { character (possibly cleared), log entry or null }\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleConcentrationCheck = (character, damageTaken) => {\n    if (!character.concentrationSpell) return {\n      character,\n      logEntry: null\n    };\n    const check = rollConcentrationCheck(damageTaken);\n    if (check.passed) {\n      return {\n        character,\n        logEntry: `ğŸ”® ${character.name} passes concentration check (rolled ${check.roll} vs DC ${check.dc}) â€” still concentrating on ${character.concentrationSpell}.`\n      };\n    } else {\n      const cleared = clearConcentration(character, 'failed concentration check');\n      return {\n        character: cleared,\n        logEntry: `ğŸ’” ${character.name} FAILS concentration check (rolled ${check.roll} vs DC ${check.dc}) â€” ${character.concentrationSpell} ends!`\n      };\n    }\n  };\n\n  // â”€â”€ ATTACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleAttack = (attackIndex = 0) => {\n    if (!selectedTarget) {\n      alert('Select a target first!');\n      return;\n    }\n    const result = executeAttack(currentCombatant, selectedTarget, attackIndex);\n    const logEntry = result.attackRoll.isCritical ? `ğŸ’¥ CRITICAL HIT! ${result.attacker} hits ${result.target} with ${result.attack} for ${result.damage} ${result.damageType} damage!` : result.attackRoll.isFumble ? `âŒ FUMBLE! ${result.attacker} misses ${result.target}!` : result.attackRoll.isHit ? `âš”ï¸ ${result.attacker} hits ${result.target} with ${result.attack} for ${result.damage} ${result.damageType} damage!` : `ğŸ›¡ï¸ ${result.attacker} misses ${result.target}!`;\n    let newLog = addLog(logEntry);\n    if (result.attackRoll.isHit && result.damage > 0) {\n      const damagedTarget = applyDamage(selectedTarget, result.damage);\n      const updatedCombat = updateCombatant(combat, selectedTarget.id || selectedTarget.name, damagedTarget);\n      if (damagedTarget.isDead) addLog(`ğŸ’€ ${damagedTarget.name} has been defeated!`, newLog);\n      onUpdate(updatedCombat);\n\n      // Concentration check if target is a party member concentrating\n      if (updateParty) {\n        const partyTarget = party.find(p => p.name === selectedTarget.name);\n        if (partyTarget !== null && partyTarget !== void 0 && partyTarget.concentrationSpell) {\n          const {\n            character: afterCheck,\n            logEntry: checkLog\n          } = handleConcentrationCheck(partyTarget, result.damage);\n          if (checkLog) addLog(checkLog);\n          const updatedParty = party.map(p => p.name === afterCheck.name ? afterCheck : p);\n          updateParty(updatedParty);\n        }\n      }\n      const endCheck = checkCombatEnd(updatedCombat);\n      if (endCheck.ended) {\n        setTimeout(() => onEnd(endCheck), 1000);\n        return;\n      }\n    }\n    handleEndTurn();\n  };\n\n  // â”€â”€ SPELL RESULT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleSpellResult = result => {\n    setShowSpellPanel(false);\n    addLog(result.log);\n    let currentCombatState = {\n      ...combat\n    };\n\n    // 1. Update caster's spell slots (and concentration state) in the party store\n    if (updateParty && result.updatedCaster) {\n      const updatedParty = party.map(p => p.name === result.updatedCaster.name ? result.updatedCaster : p);\n      updateParty(updatedParty);\n    }\n\n    // 2. Apply damage to target\n    if (result.damage > 0 && result.hit && selectedTarget) {\n      const damagedTarget = applyDamage(selectedTarget, result.damage, result.damageType);\n      currentCombatState = updateCombatant(currentCombatState, selectedTarget.id || selectedTarget.name, damagedTarget);\n      if (damagedTarget.isDead) addLog(`ğŸ’€ ${damagedTarget.name} has been defeated!`);\n      onUpdate(currentCombatState);\n\n      // Concentration check for the damaged target if they're a party member concentrating\n      if (updateParty) {\n        const partyTarget = party.find(p => p.name === selectedTarget.name);\n        if (partyTarget !== null && partyTarget !== void 0 && partyTarget.concentrationSpell) {\n          const {\n            character: afterCheck,\n            logEntry: checkLog\n          } = handleConcentrationCheck(partyTarget, result.damage);\n          if (checkLog) addLog(checkLog);\n          const updatedParty = party.map(p => p.name === afterCheck.name ? afterCheck : p);\n          updateParty(updatedParty);\n        }\n      }\n      const endCheck = checkCombatEnd(currentCombatState);\n      if (endCheck.ended) {\n        setTimeout(() => onEnd(endCheck), 1000);\n        return;\n      }\n    }\n\n    // 3. Apply healing\n    if (result.healing > 0 && updateParty) {\n      const healedCaster = {\n        ...result.updatedCaster,\n        hp: Math.min(result.updatedCaster.maxHp, (result.updatedCaster.hp || 0) + result.healing)\n      };\n      const updatedParty = party.map(p => p.name === healedCaster.name ? healedCaster : p);\n      updateParty(updatedParty);\n    }\n\n    // 4. Apply status effect to target\n    if (result.statusApplied && selectedTarget && updateParty) {\n      const effect = createStatusEffect({\n        type: result.statusApplied.type,\n        duration: result.statusApplied.duration || 1,\n        durationType: result.statusApplied.durationType || DURATION_TYPES.ROUNDS,\n        saveDC: result.statusApplied.saveDC,\n        spellName: result.statusApplied.spellName,\n        source: result.casterName\n      });\n      if (effect) {\n        const partyTarget = party.find(p => p.name === selectedTarget.name);\n        if (partyTarget && updateParty) {\n          let withEffect = applyStatusEffect(partyTarget, effect);\n          // Auto-break concentration if a concentration-ending condition was applied\n          if (CONCENTRATION_BREAKING_CONDITIONS.has(result.statusApplied.type) && withEffect.concentrationSpell) {\n            const dropped = withEffect.concentrationSpell;\n            withEffect = clearConcentration(withEffect, `gained ${effect.name} condition`);\n            addLog(`ğŸ’” ${selectedTarget.name} loses concentration on ${dropped} (gained ${effect.name})!`);\n          }\n          const updatedParty = party.map(p => p.name === withEffect.name ? withEffect : p);\n          updateParty(updatedParty);\n          addLog(`ğŸŒ€ ${selectedTarget.name} is now ${effect.name}!`);\n        }\n      }\n    }\n    handleEndTurn();\n  };\n\n  // â”€â”€ END TURN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleEndTurn = () => {\n    setSelectedTarget(null);\n    setShowSpellPanel(false);\n    const newCombat = nextTurn(combat);\n    onUpdate(newCombat);\n    setTimeout(() => {\n      var _newCombat$combatants;\n      if ((_newCombat$combatants = newCombat.combatants[newCombat.currentTurn]) !== null && _newCombat$combatants !== void 0 && _newCombat$combatants.isEnemy) {\n        handleEnemyTurn(newCombat);\n      }\n    }, 500);\n  };\n\n  // â”€â”€ ENEMY TURN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleEnemyTurn = currentCombat => {\n    const enemy = getCurrentCombatant(currentCombat);\n    if (!enemy || enemy.isDead) {\n      handleEndTurn();\n      return;\n    }\n    const aliveParty = currentCombat.combatants.filter(c => !c.isEnemy && !c.isDead);\n    if (aliveParty.length === 0) return;\n    const target = aliveParty[Math.floor(Math.random() * aliveParty.length)];\n    const result = executeAttack(enemy, target, 0);\n    const logEntry = result.attackRoll.isCritical ? `ğŸ’¥ CRITICAL! ${result.attacker} critically hits ${result.target} for ${result.damage} damage!` : result.attackRoll.isHit ? `âš”ï¸ ${result.attacker} hits ${result.target} for ${result.damage} damage!` : `ğŸ›¡ï¸ ${result.attacker} misses ${result.target}!`;\n    addLog(logEntry);\n    if (result.attackRoll.isHit && result.damage > 0) {\n      const damagedTarget = applyDamage(target, result.damage);\n      let updatedCombat = updateCombatant(currentCombat, target.id || target.name, damagedTarget);\n      if (damagedTarget.isDead) addLog(`ğŸ’€ ${damagedTarget.name} has fallen!`);\n      onUpdate(updatedCombat);\n\n      // Concentration check for attacked party member\n      if (updateParty) {\n        const partyTarget = party.find(p => p.name === target.name);\n        if (partyTarget !== null && partyTarget !== void 0 && partyTarget.concentrationSpell) {\n          const {\n            character: afterCheck,\n            logEntry: checkLog\n          } = handleConcentrationCheck(partyTarget, result.damage);\n          if (checkLog) addLog(checkLog);\n          const updatedParty = party.map(p => p.name === afterCheck.name ? afterCheck : p);\n          updateParty(updatedParty);\n        }\n      }\n      const endCheck = checkCombatEnd(updatedCombat);\n      if (endCheck.ended) {\n        setTimeout(() => onEnd(endCheck), 1000);\n        return;\n      }\n    }\n    setTimeout(() => handleEndTurn(), 1500);\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  RENDER\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: 'fixed',\n      bottom: 0,\n      left: 0,\n      right: 0,\n      backgroundColor: '#120808',\n      border: '3px solid #d32f2f',\n      borderBottom: 'none',\n      padding: '20px',\n      maxHeight: '65vh',\n      overflowY: 'auto',\n      zIndex: 1000,\n      boxShadow: '0 -4px 20px rgba(211,47,47,0.4)'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        marginBottom: '15px',\n        paddingBottom: '15px',\n        borderBottom: '2px solid #2a2a2a'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          margin: 0,\n          color: '#d32f2f',\n          fontSize: '24px'\n        },\n        children: [\"\\u2694\\uFE0F Combat \\u2014 Round \", combat.round]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 817,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => onEnd({\n          ended: true,\n          result: 'flee',\n          message: 'Combat ended'\n        }),\n        style: {\n          padding: '8px 16px',\n          backgroundColor: '#333',\n          color: '#aaa',\n          border: '1px solid #555',\n          borderRadius: '5px',\n          cursor: 'pointer'\n        },\n        children: \"End Combat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 820,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 816,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        gap: '10px',\n        marginBottom: '15px',\n        overflowX: 'auto',\n        paddingBottom: '10px'\n      },\n      children: combat.combatants.map((combatant, index) => {\n        var _combatant$conditions;\n        // Find this combatant's party entry to check concentration\n        const partyEntry = party.find(p => p.name === combatant.name);\n        const isConcentrating = partyEntry === null || partyEntry === void 0 ? void 0 : partyEntry.concentrationSpell;\n        const isActive = index === combat.currentTurn;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            minWidth: '120px',\n            padding: '10px',\n            backgroundColor: isActive ? '#2a0000' : '#1a1a1a',\n            border: isActive ? '2px solid #ffd700' : '2px solid #333',\n            borderRadius: '8px',\n            opacity: combatant.isDead ? 0.3 : 1,\n            position: 'relative',\n            flexShrink: 0,\n            // Purple glow for concentrating characters\n            boxShadow: isConcentrating ? '0 0 12px rgba(156,39,176,0.7), inset 0 0 8px rgba(156,39,176,0.2)' : 'none'\n          },\n          children: [isActive && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: 'absolute',\n              top: '-18px',\n              left: '50%',\n              transform: 'translateX(-50%)',\n              fontSize: '18px'\n            },\n            children: \"\\u2B07\\uFE0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 853,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '11px',\n              color: combatant.isEnemy ? '#ff6b6b' : '#4CAF50',\n              marginBottom: '4px'\n            },\n            children: [combatant.isEnemy ? 'ğŸ‘¹' : 'ğŸ›¡ï¸', \" Init: \", combatant.initiative]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 855,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontWeight: 'bold',\n              fontSize: '13px',\n              marginBottom: '4px',\n              whiteSpace: 'nowrap',\n              overflow: 'hidden',\n              textOverflow: 'ellipsis'\n            },\n            children: combatant.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 858,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '11px',\n              color: '#888'\n            },\n            children: [combatant.hp, \"/\", combatant.maxHp, \" HP\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 861,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '100%',\n              height: '5px',\n              backgroundColor: '#0a0a0a',\n              borderRadius: '3px',\n              marginTop: '5px',\n              overflow: 'hidden'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                width: `${Math.max(0, combatant.hp / combatant.maxHp * 100)}%`,\n                height: '100%',\n                backgroundColor: combatant.hp > combatant.maxHp * 0.5 ? '#4CAF50' : combatant.hp > combatant.maxHp * 0.25 ? '#ff9800' : '#f44336',\n                transition: 'width 0.3s'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 865,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 864,\n            columnNumber: 15\n          }, this), isConcentrating && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: '5px',\n              fontSize: '10px',\n              color: '#CE93D8',\n              display: 'flex',\n              alignItems: 'center',\n              gap: '3px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\uD83D\\uDD2E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 883,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                overflow: 'hidden',\n                textOverflow: 'ellipsis',\n                whiteSpace: 'nowrap',\n                maxWidth: '85px'\n              },\n              children: isConcentrating\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 884,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 875,\n            columnNumber: 17\n          }, this), ((_combatant$conditions = combatant.conditions) === null || _combatant$conditions === void 0 ? void 0 : _combatant$conditions.length) > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: '4px',\n              fontSize: '12px',\n              display: 'flex',\n              gap: '2px',\n              flexWrap: 'wrap'\n            },\n            children: [combatant.conditions.slice(0, 3).map(c => /*#__PURE__*/_jsxDEV(\"span\", {\n              title: c.name,\n              children: c.icon\n            }, c.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 894,\n              columnNumber: 21\n            }, this)), combatant.conditions.length > 3 && /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                color: '#888'\n              },\n              children: [\"+\", combatant.conditions.length - 3]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 896,\n              columnNumber: 55\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 892,\n            columnNumber: 17\n          }, this), combatant.isDead && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: 'absolute',\n              inset: 0,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              fontSize: '36px',\n              backgroundColor: 'rgba(0,0,0,0.5)',\n              borderRadius: '8px'\n            },\n            children: \"\\uD83D\\uDC80\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 901,\n            columnNumber: 17\n          }, this)]\n        }, combatant.id || combatant.name, true, {\n          fileName: _jsxFileName,\n          lineNumber: 837,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 829,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#0a0a0a',\n        padding: '10px',\n        borderRadius: '8px',\n        marginBottom: '15px',\n        maxHeight: '100px',\n        overflowY: 'auto',\n        border: '1px solid #222'\n      },\n      children: combatLog.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          margin: 0,\n          color: '#444',\n          fontStyle: 'italic',\n          fontSize: '13px'\n        },\n        children: \"Combat begins\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 911,\n        columnNumber: 13\n      }, this) : combatLog.map((log, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '3px 5px',\n          color: i === 0 ? '#eee' : '#777',\n          fontSize: '13px',\n          borderBottom: i < combatLog.length - 1 ? '1px solid #111' : 'none'\n        },\n        children: log\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 913,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 909,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#1a1a1a',\n        padding: '15px',\n        borderRadius: '8px',\n        border: '2px solid #333'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          margin: '0 0 12px 0',\n          color: '#ffd700',\n          fontSize: '16px'\n        },\n        children: [currentCombatant === null || currentCombatant === void 0 ? void 0 : currentCombatant.name, \"'s Turn\", isPlayerTurn && isSpellcaster && /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            marginLeft: '10px',\n            fontSize: '12px',\n            color: '#CE93D8'\n          },\n          children: \"\\u2728 Spellcaster\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 925,\n          columnNumber: 13\n        }, this), isPlayerTurn && (partyCharacter === null || partyCharacter === void 0 ? void 0 : partyCharacter.concentrationSpell) && /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            marginLeft: '10px',\n            fontSize: '11px',\n            color: '#CE93D8',\n            backgroundColor: 'rgba(156,39,176,0.2)',\n            padding: '2px 8px',\n            borderRadius: '10px',\n            border: '1px solid #6A1B9A'\n          },\n          children: [\"\\uD83D\\uDD2E \", partyCharacter.concentrationSpell]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 928,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 922,\n        columnNumber: 9\n      }, this), isPlayerTurn && !(currentCombatant !== null && currentCombatant !== void 0 && currentCombatant.isDead) && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '12px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '12px',\n              color: '#888',\n              marginBottom: '6px',\n              textTransform: 'uppercase',\n              letterSpacing: '0.5px'\n            },\n            children: \"Select Target\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 946,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: '8px',\n              flexWrap: 'wrap'\n            },\n            children: [combat.combatants.filter(c => c.isEnemy && !c.isDead).map(enemy => /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setSelectedTarget(enemy),\n              style: {\n                padding: '8px 14px',\n                backgroundColor: (selectedTarget === null || selectedTarget === void 0 ? void 0 : selectedTarget.name) === enemy.name ? '#3a0000' : '#2a1010',\n                color: (selectedTarget === null || selectedTarget === void 0 ? void 0 : selectedTarget.name) === enemy.name ? '#ff6b6b' : '#ccc',\n                border: `2px solid ${(selectedTarget === null || selectedTarget === void 0 ? void 0 : selectedTarget.name) === enemy.name ? '#d32f2f' : '#333'}`,\n                borderRadius: '6px',\n                cursor: 'pointer',\n                fontSize: '13px',\n                transition: 'all 0.15s'\n              },\n              children: [\"\\uD83D\\uDC79 \", enemy.name, /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  color: '#666',\n                  marginLeft: '6px',\n                  fontSize: '11px'\n                },\n                children: [enemy.hp, \"/\", enemy.maxHp, \" HP\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 966,\n                columnNumber: 21\n              }, this)]\n            }, enemy.id || enemy.name, true, {\n              fileName: _jsxFileName,\n              lineNumber: 951,\n              columnNumber: 19\n            }, this)), combat.combatants.filter(c => c.isEnemy && !c.isDead).length === 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                color: '#888',\n                fontStyle: 'italic',\n                fontSize: '13px'\n              },\n              children: \"No living enemies\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 972,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 949,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 945,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '10px',\n            flexWrap: 'wrap',\n            marginBottom: '10px',\n            alignItems: 'flex-start'\n          },\n          children: [(_currentCombatant$att = currentCombatant.attacks) === null || _currentCombatant$att === void 0 ? void 0 : _currentCombatant$att.map((attack, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleAttack(index),\n            disabled: !selectedTarget,\n            style: {\n              padding: '10px 18px',\n              backgroundColor: selectedTarget ? '#1a3a1a' : '#1a1a1a',\n              color: selectedTarget ? '#4CAF50' : '#555',\n              border: `2px solid ${selectedTarget ? '#4CAF50' : '#333'}`,\n              borderRadius: '8px',\n              cursor: selectedTarget ? 'pointer' : 'not-allowed',\n              fontSize: '14px',\n              fontWeight: 'bold',\n              transition: 'all 0.15s'\n            },\n            children: [\"\\u2694\\uFE0F \", attack.name, /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                display: 'block',\n                fontSize: '10px',\n                color: selectedTarget ? '#81C784' : '#444',\n                fontWeight: 'normal'\n              },\n              children: [\"+\", attack.bonus, \" to hit \\u2022 \", attack.damage]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 998,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 981,\n            columnNumber: 17\n          }, this)), isSpellcaster && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowSpellPanel(p => !p),\n            style: {\n              padding: '10px 18px',\n              backgroundColor: showSpellPanel ? '#2a0a3a' : '#1a0a2a',\n              color: showSpellPanel ? '#CE93D8' : '#9C27B0',\n              border: `2px solid ${showSpellPanel ? '#CE93D8' : '#6A1B9A'}`,\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontSize: '14px',\n              fontWeight: 'bold',\n              transition: 'all 0.15s',\n              position: 'relative'\n            },\n            children: [\"\\u2728 Cast Spell\", /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                display: 'block',\n                fontSize: '10px',\n                color: '#888',\n                fontWeight: 'normal'\n              },\n              children: [combatSpells.length, \" available\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1022,\n              columnNumber: 19\n            }, this), (partyCharacter === null || partyCharacter === void 0 ? void 0 : partyCharacter.concentrationSpell) && /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                position: 'absolute',\n                top: '-8px',\n                right: '-8px',\n                width: '16px',\n                height: '16px',\n                backgroundColor: '#9C27B0',\n                borderRadius: '50%',\n                fontSize: '10px',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center'\n              },\n              children: \"\\uD83D\\uDD2E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1026,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1006,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleEndTurn,\n            style: {\n              padding: '10px 18px',\n              backgroundColor: '#1a1a1a',\n              color: '#888',\n              border: '2px solid #333',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontSize: '14px',\n              marginLeft: 'auto',\n              transition: 'all 0.15s'\n            },\n            children: \"End Turn \\u2192\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1044,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 978,\n          columnNumber: 13\n        }, this), showSpellPanel && isSpellcaster && /*#__PURE__*/_jsxDEV(SpellCastPanel, {\n          caster: partyCharacter,\n          combatSpells: combatSpells,\n          selectedTarget: selectedTarget,\n          onSpellResult: handleSpellResult,\n          onClose: () => setShowSpellPanel(false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1064,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 943,\n        columnNumber: 11\n      }, this), !isPlayerTurn && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          margin: 0,\n          color: '#ff6b6b',\n          fontStyle: 'italic',\n          fontSize: '14px'\n        },\n        children: \"\\u2694\\uFE0F Enemy is acting\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1076,\n        columnNumber: 11\n      }, this), (currentCombatant === null || currentCombatant === void 0 ? void 0 : currentCombatant.isDead) && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          margin: 0,\n          color: '#555',\n          fontSize: '14px'\n        },\n        children: \"This combatant has been defeated. Advance the turn.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1082,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 921,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 801,\n    columnNumber: 5\n  }, this);\n}\n_s2(CombatTracker, \"rH3G6Vn15+yPvr8yNjlmhkYCTaA=\");\n_c3 = CombatTracker;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"ConcentrationWarningModal\");\n$RefreshReg$(_c2, \"SpellCastPanel\");\n$RefreshReg$(_c3, \"CombatTracker\");","map":{"version":3,"names":["useState","executeAttack","nextTurn","checkCombatEnd","getCurrentCombatant","updateCombatant","applyDamage","SPELL_DATABASE","getSpellSlots","canCastSpell","castSpell","getSpellAttackBonus","getSpellSaveDC","calculateSpellDamage","rollSpellDamage","SPELLCASTING_CLASSES","createStatusEffect","applyStatusEffect","STATUS_EFFECTS","DURATION_TYPES","jsxDEV","_jsxDEV","Fragment","_Fragment","rollD20","Math","floor","random","CONCENTRATION_SPELLS","Set","CONCENTRATION_BREAKING_CONDITIONS","INCAPACITATED","STUNNED","PARALYZED","UNCONSCIOUS","PETRIFIED","SPELL_STATUS_EFFECTS","hold_person","type","duration","durationType","SAVE_ENDS","saveDC","sleep","MINUTES","haste","HASTED","ROUNDS","invisibility","INVISIBLE","greater_invisibility","spellLevelColor","level","c","getCombatSpells","character","_character$spells","_character$spells2","_character$spells3","cantrips","spells","map","k","key","filter","s","name","prepared","known","all","forEach","find","a","push","damage","healing","includes","isConcentrationSpell","spell","concentration","has","rollConcentrationCheck","damageTaken","dc","max","roll","passed","ConcentrationWarningModal","currentSpell","newSpell","onDropAndCast","onCancel","style","position","inset","backgroundColor","display","alignItems","justifyContent","zIndex","children","border","borderRadius","padding","maxWidth","width","boxShadow","fontSize","textAlign","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","margin","color","gap","onClick","flex","cursor","fontWeight","_c","SpellCastPanel","caster","combatSpells","selectedTarget","onSpellResult","onClose","_s","_caster$spellSlots","selectedSpell","setSelectedSpell","upcastLevel","setUpcastLevel","castResult","setCastResult","concWarning","setConcWarning","currentSlots","spellSlots","current","spellAttack","spellSaveDC","activeConc","concentrationSpell","executeCast","slotLevel","castOutcome","success","alert","message","updatedCaster","isConc","result","spellName","casterName","targetName","hit","critical","statusApplied","isConcentration","droppedConcentration","log","dmgStr","rolled","total","saveRoll","targetSave","dex","saved","targetDex","damageType","d20","crit","ac","armorClass","replace","_","n","parseInt","scAbil","Cleric","Druid","Paladin","Bard","Ranger","abilKey","class","mod","abilities","_effectDef$saveDC","effectDef","handleCast","pendingCast","marginTop","background","flexWrap","i","cur","gridTemplateColumns","maxHeight","overflowY","length","fontStyle","gridColumn","hasSlotsOrCantrip","isSelected","isActiveConc","disabled","opacity","transition","marginLeft","castingTime","range","description","upcastBonus","Array","from","lvl","slotsLeft","_c2","CombatTracker","combat","onUpdate","onEnd","party","updateParty","_s2","_currentCombatant$att","setSelectedTarget","combatLog","setCombatLog","showSpellPanel","setShowSpellPanel","isActive","currentCombatant","isPlayerTurn","isEnemy","partyCharacter","p","isSpellcaster","addLog","entry","prevLog","clearConcentration","reason","console","handleConcentrationCheck","logEntry","check","cleared","handleAttack","attackIndex","attackRoll","isCritical","attacker","target","attack","isFumble","isHit","newLog","damagedTarget","updatedCombat","id","isDead","partyTarget","afterCheck","checkLog","updatedParty","endCheck","ended","setTimeout","handleEndTurn","handleSpellResult","currentCombatState","healedCaster","hp","min","maxHp","effect","source","withEffect","dropped","newCombat","_newCombat$combatants","combatants","currentTurn","handleEnemyTurn","currentCombat","enemy","aliveParty","bottom","left","right","borderBottom","paddingBottom","round","overflowX","combatant","index","_combatant$conditions","partyEntry","isConcentrating","minWidth","flexShrink","top","transform","initiative","whiteSpace","overflow","textOverflow","height","conditions","slice","title","icon","textTransform","letterSpacing","attacks","bonus","_c3","$RefreshReg$"],"sources":["C:/Users/Hakty/Desktop/AI-Dungeon-Master/frontend/src/components/CombatTracker.jsx"],"sourcesContent":["// frontend/src/components/CombatTracker.jsx - WITH SPELL DAMAGE + CONCENTRATION TRACKING\nimport { useState } from 'react';\nimport {\n  executeAttack,\n  nextTurn,\n  checkCombatEnd,\n  getCurrentCombatant,\n  updateCombatant,\n  applyDamage\n} from '../utils/combatSystem';\nimport {\n  SPELL_DATABASE,\n  getSpellSlots,\n  canCastSpell,\n  castSpell,\n  getSpellAttackBonus,\n  getSpellSaveDC,\n  calculateSpellDamage,\n  rollSpellDamage,\n  SPELLCASTING_CLASSES\n} from '../utils/spellSystem';\nimport {\n  createStatusEffect,\n  applyStatusEffect,\n  STATUS_EFFECTS,\n  DURATION_TYPES\n} from '../utils/statusEffectSystem';\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  HELPERS\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\nfunction rollD20() {\n  return Math.floor(Math.random() * 20) + 1;\n}\n\n/** Spells that require concentration */\nconst CONCENTRATION_SPELLS = new Set([\n  'bless','bane','faerie_fire','fog_cloud','guiding_bolt','hold_person',\n  'invisibility','magic_weapon','mirror_image','misty_step','prayer_of_healing',\n  'silence','spider_climb','spiritual_weapon','arcane_eye','banishment',\n  'black_tentacles','confusion','conjure_animals','conjure_woodland_beings',\n  'control_water','dimension_door','dominate_beast','evards_black_tentacles',\n  'faithful_hound','fire_shield','freedom_of_movement','giant_insect',\n  'greater_invisibility','guardian_of_faith','hallucinatory_terrain','ice_storm',\n  'locate_creature','phantasmal_killer','polymorph','resilient_sphere',\n  'stone_skin','wall_of_fire','animate_objects','antilife_shell',\n  'arcane_hand','cloudkill','conjure_elemental','contact_other_plane',\n  'control_winds','danse_macabre','dawn','destructive_wave','dominate_person',\n  'far_step','grappling_vine','haste','hold_monster','insect_plague',\n  'legend_lore','maelstrom','mass_cure_wounds','mislead','modify_memory',\n  'passwall','planar_binding','seeming','synaptic_static','teleportation_circle',\n  'wall_of_force','wall_of_stone','wind_walk','witch_bolt','call_lightning',\n  'conjure_barrage','conjure_volley','sleet_storm','slow','speak_with_dead',\n  'summon_lesser_demons','thunder_step','tidal_wave','vitriolic_sphere',\n  'web','wind_wall','wrathful_smite','locate_object','darkvision',\n  'enhance_ability','enlarge_reduce','flame_blade','heat_metal','hold_person',\n  'levitate','melf_acid_arrow','mind_spike','moonbeam','pass_without_trace',\n  'protection_from_energy','rope_trick','see_invisibility','shatter',\n  'blindness_deafness','blur','crown_of_madness','darkness','detect_thoughts',\n  'enthrall','flaming_sphere','gust_of_wind','hold_person','magic_mouth',\n  'maximilian_earthen_grasp','mirror_image','nystul_magic_aura',\n  'phantasmal_force','ray_of_enfeeblement','shadow_blade',\n]);\n\n/** Conditions that break concentration */\nconst CONCENTRATION_BREAKING_CONDITIONS = new Set([\n  STATUS_EFFECTS.INCAPACITATED,\n  STATUS_EFFECTS.STUNNED,\n  STATUS_EFFECTS.PARALYZED,\n  STATUS_EFFECTS.UNCONSCIOUS,\n  STATUS_EFFECTS.PETRIFIED,\n]);\n\n/** Map spell types that apply status effects */\nconst SPELL_STATUS_EFFECTS = {\n  hold_person:         { type: STATUS_EFFECTS.PARALYZED,    duration: 10, durationType: DURATION_TYPES.SAVE_ENDS, saveDC: null },\n  sleep:               { type: STATUS_EFFECTS.UNCONSCIOUS,  duration: 1,  durationType: DURATION_TYPES.MINUTES },\n  haste:               { type: STATUS_EFFECTS.HASTED,       duration: 10, durationType: DURATION_TYPES.ROUNDS },\n  invisibility:        { type: STATUS_EFFECTS.INVISIBLE,    duration: 60, durationType: DURATION_TYPES.MINUTES },\n  greater_invisibility:{ type: STATUS_EFFECTS.INVISIBLE,    duration: 10, durationType: DURATION_TYPES.ROUNDS },\n};\n\n/** Colour band per spell level */\nfunction spellLevelColor(level) {\n  const c = ['#4CAF50','#2196F3','#03A9F4','#00BCD4','#009688','#8BC34A','#CDDC39','#FFEB3B','#FFC107','#FF9800'];\n  return c[level] || '#888';\n}\n\n/** Get accessible spells for combat (cantrips + prepared/known) */\nfunction getCombatSpells(character) {\n  const cantrips = (character.spells?.cantrips || []).map(k => ({ key: k, ...SPELL_DATABASE[k] })).filter(s => s.name);\n  const prepared = (character.spells?.prepared || []).map(k => ({ key: k, ...SPELL_DATABASE[k] })).filter(s => s.name);\n  const known    = (character.spells?.known    || []).map(k => ({ key: k, ...SPELL_DATABASE[k] })).filter(s => s.name);\n\n  const all = [...cantrips];\n  [...prepared, ...known].forEach(s => {\n    if (!all.find(a => a.key === s.key)) all.push(s);\n  });\n\n  return all.filter(s =>\n    s.damage || s.healing || SPELL_STATUS_EFFECTS[s.key] ||\n    ['shield','misty_step','counterspell','fly','haste','hold_person','sleep',\n     'invisibility','greater_invisibility','spiritual_weapon'].includes(s.key)\n  );\n}\n\n/** Check if a spell requires concentration */\nfunction isConcentrationSpell(spell) {\n  return spell.concentration === true || CONCENTRATION_SPELLS.has(spell.key);\n}\n\n/** Roll a concentration saving throw. Returns { passed, roll, dc } */\nfunction rollConcentrationCheck(damageTaken) {\n  const dc = Math.max(10, Math.floor(damageTaken / 2));\n  const roll = rollD20();\n  return { passed: roll >= dc, roll, dc };\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  CONCENTRATION WARNING MODAL\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nfunction ConcentrationWarningModal({ currentSpell, newSpell, onDropAndCast, onCancel }) {\n  return (\n    <div style={{\n      position: 'fixed', inset: 0,\n      backgroundColor: 'rgba(0,0,0,0.85)',\n      display: 'flex', alignItems: 'center', justifyContent: 'center',\n      zIndex: 2000\n    }}>\n      <div style={{\n        backgroundColor: '#1a0a2e',\n        border: '2px solid #9C27B0',\n        borderRadius: '12px',\n        padding: '24px',\n        maxWidth: '400px',\n        width: '90%',\n        boxShadow: '0 0 30px rgba(156,39,176,0.5)'\n      }}>\n        <div style={{ fontSize: '24px', textAlign: 'center', marginBottom: '12px' }}>ğŸ”®</div>\n        <h3 style={{ margin: '0 0 12px 0', color: '#CE93D8', textAlign: 'center' }}>\n          Concentration Conflict\n        </h3>\n        <p style={{ color: '#ccc', fontSize: '14px', textAlign: 'center', marginBottom: '8px' }}>\n          You are already concentrating on <strong style={{ color: '#CE93D8' }}>{currentSpell}</strong>.\n        </p>\n        <p style={{ color: '#aaa', fontSize: '13px', textAlign: 'center', marginBottom: '20px' }}>\n          Casting <strong style={{ color: '#CE93D8' }}>{newSpell}</strong> will end your current concentration.\n          Do you want to drop <strong>{currentSpell}</strong> and cast <strong>{newSpell}</strong>?\n        </p>\n        <div style={{ display: 'flex', gap: '10px' }}>\n          <button\n            onClick={onDropAndCast}\n            style={{\n              flex: 1,\n              padding: '10px',\n              backgroundColor: '#6A1B9A',\n              color: 'white',\n              border: 'none',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontWeight: 'bold',\n              fontSize: '14px'\n            }}\n          >\n            Drop & Cast\n          </button>\n          <button\n            onClick={onCancel}\n            style={{\n              flex: 1,\n              padding: '10px',\n              backgroundColor: '#333',\n              color: '#aaa',\n              border: '1px solid #555',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontSize: '14px'\n            }}\n          >\n            Cancel\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  SPELL CAST PANEL (sub-component)\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nfunction SpellCastPanel({ caster, combatSpells, selectedTarget, onSpellResult, onClose }) {\n  const [selectedSpell, setSelectedSpell] = useState(null);\n  const [upcastLevel,   setUpcastLevel]   = useState(null);\n  const [castResult,    setCastResult]    = useState(null);\n  const [concWarning,   setConcWarning]   = useState(null); // { currentSpell, newSpell, pendingCast }\n\n  const currentSlots = caster.spellSlots?.current || getSpellSlots(caster);\n  const spellAttack  = getSpellAttackBonus(caster);\n  const spellSaveDC  = getSpellSaveDC(caster);\n\n  // Current concentration spell on this caster\n  const activeConc = caster.concentrationSpell || null;\n\n  const executeCast = (spell, slotLevel) => {\n    const castOutcome = castSpell(caster, spell, slotLevel > 0 ? slotLevel : null);\n    if (!castOutcome.success) {\n      alert(castOutcome.message);\n      return;\n    }\n    const updatedCaster = castOutcome.character;\n\n    // Track concentration on character\n    const isConc = isConcentrationSpell(spell);\n    if (isConc) {\n      updatedCaster.concentrationSpell = spell.name;\n    }\n\n    let result = {\n      spellName: spell.name,\n      casterName: caster.name,\n      targetName: selectedTarget?.name || 'ally',\n      slotLevel,\n      updatedCaster,\n      damage: 0,\n      healing: 0,\n      hit: null,\n      critical: false,\n      statusApplied: null,\n      isConcentration: isConc,\n      droppedConcentration: activeConc,\n      log: ''\n    };\n\n    // â”€â”€ DAMAGE spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    if (spell.damage && selectedTarget) {\n      if (spell.key === 'magic_missile') {\n        const dmgStr = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.damage;\n        const rolled = rollSpellDamage(dmgStr);\n        result.damage = rolled.total;\n        result.hit    = true;\n        result.log    = `âœ¨ ${caster.name} fires Magic Missile at ${selectedTarget.name} for ${rolled.total} force damage! (auto-hit)`;\n      } else if (spell.key === 'sacred_flame') {\n        const saveRoll   = rollD20();\n        const targetSave = selectedTarget.dex ? Math.floor((selectedTarget.dex - 10) / 2) : 0;\n        const saved      = (saveRoll + targetSave) >= spellSaveDC;\n        if (!saved) {\n          const dmgStr = calculateSpellDamage(spell, caster.level) || spell.damage;\n          const rolled  = rollSpellDamage(dmgStr);\n          result.damage = rolled.total;\n          result.hit    = true;\n          result.log    = `ğŸ”¥ Sacred Flame hits ${selectedTarget.name} for ${rolled.total} radiant damage! (DEX save ${saveRoll} failed vs DC ${spellSaveDC})`;\n        } else {\n          result.hit = false;\n          result.log = `ğŸ”¥ ${selectedTarget.name} saves against Sacred Flame! (rolled ${saveRoll} vs DC ${spellSaveDC})`;\n        }\n      } else if (['fireball','lightning_bolt','thunderwave','burning_hands','ice_storm','cone_of_cold',\n                  'chain_lightning','disintegrate','finger_of_death','meteor_swarm'].includes(spell.key)) {\n        const saveRoll  = rollD20();\n        const targetDex = selectedTarget.dex ? Math.floor((selectedTarget.dex - 10) / 2) : 0;\n        const saved     = (saveRoll + targetDex) >= spellSaveDC;\n        const dmgStr    = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.damage;\n        const rolled    = rollSpellDamage(dmgStr);\n        result.damage   = saved ? Math.floor(rolled.total / 2) : rolled.total;\n        result.hit      = true;\n        result.log      = saved\n          ? `ğŸ’¥ ${caster.name} casts ${spell.name}! ${selectedTarget.name} saves (${saveRoll} vs DC ${spellSaveDC}) â€” takes ${result.damage} ${spell.damageType} damage (half).`\n          : `ğŸ’¥ ${caster.name} casts ${spell.name}! ${selectedTarget.name} fails save (${saveRoll} vs DC ${spellSaveDC}) â€” takes ${result.damage} ${spell.damageType} damage!`;\n      } else {\n        const d20   = rollD20();\n        const total = d20 + spellAttack;\n        const crit  = d20 === 20;\n        const hit   = crit || total >= (selectedTarget.ac || selectedTarget.armorClass || 12);\n        if (hit) {\n          const dmgStr  = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.damage;\n          const rolled  = rollSpellDamage(crit ? dmgStr.replace(/(\\d+)d/, (_, n) => `${parseInt(n)*2}d`) : dmgStr);\n          result.damage   = rolled.total;\n          result.hit      = true;\n          result.critical = crit;\n          result.log      = crit\n            ? `ğŸ’¥ CRITICAL! ${caster.name}'s ${spell.name} hits ${selectedTarget.name} for ${rolled.total} ${spell.damageType} damage!`\n            : `âœ¨ ${caster.name}'s ${spell.name} hits ${selectedTarget.name} for ${rolled.total} ${spell.damageType} damage! (rolled ${total} vs AC ${selectedTarget.ac || selectedTarget.armorClass || '?'})`;\n        } else {\n          result.hit = false;\n          result.log = `âŒ ${caster.name}'s ${spell.name} misses ${selectedTarget.name}! (rolled ${total} vs AC ${selectedTarget.ac || selectedTarget.armorClass || '?'})`;\n        }\n      }\n    }\n    // â”€â”€ HEALING spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    else if (spell.healing) {\n      const dmgStr    = calculateSpellDamage(spell, caster.level, slotLevel > 0 ? slotLevel : null) || spell.healing;\n      const rolled    = rollSpellDamage(dmgStr);\n      const scAbil    = { Cleric:'WIS', Druid:'WIS', Paladin:'CHA', Bard:'CHA', Ranger:'WIS' };\n      const abilKey   = scAbil[caster.class] || 'INT';\n      const mod       = caster.abilities ? Math.floor((caster.abilities[abilKey] - 10) / 2) : 0;\n      result.healing  = rolled.total + mod;\n      result.log      = `ğŸ’š ${caster.name} casts ${spell.name} and heals for ${result.healing} HP!`;\n    }\n    // â”€â”€ STATUS EFFECT spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    else if (SPELL_STATUS_EFFECTS[spell.key]) {\n      const effectDef      = SPELL_STATUS_EFFECTS[spell.key];\n      const dc             = effectDef.saveDC ?? spellSaveDC;\n      result.statusApplied = { ...effectDef, saveDC: dc, spellName: spell.name };\n      result.log           = `ğŸŒ€ ${caster.name} casts ${spell.name}${selectedTarget ? ` on ${selectedTarget.name}` : ''}!`;\n    }\n    // â”€â”€ UTILITY spells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n    else {\n      result.log = `âœ¨ ${caster.name} casts ${spell.name}!`;\n    }\n\n    // Append concentration note\n    if (isConc) {\n      result.log += ` [Concentrating]`;\n      if (activeConc) result.log = `[Dropped ${activeConc}] ` + result.log;\n    }\n\n    setCastResult(result);\n    onSpellResult(result);\n  };\n\n  const handleCast = () => {\n    if (!selectedSpell) return;\n    const spell     = selectedSpell;\n    const slotLevel = upcastLevel ?? (spell.level || 0);\n\n    // Check concentration conflict\n    if (isConcentrationSpell(spell) && activeConc && activeConc !== spell.name) {\n      setConcWarning({\n        currentSpell: activeConc,\n        newSpell: spell.name,\n        pendingCast: () => executeCast(spell, slotLevel)\n      });\n      return;\n    }\n\n    executeCast(spell, slotLevel);\n  };\n\n  return (\n    <>\n      {concWarning && (\n        <ConcentrationWarningModal\n          currentSpell={concWarning.currentSpell}\n          newSpell={concWarning.newSpell}\n          onDropAndCast={() => {\n            concWarning.pendingCast();\n            setConcWarning(null);\n          }}\n          onCancel={() => setConcWarning(null)}\n        />\n      )}\n\n      <div style={{\n        backgroundColor: '#12012a',\n        border: '2px solid #9C27B0',\n        borderRadius: '10px',\n        padding: '15px',\n        marginTop: '10px'\n      }}>\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px' }}>\n          <h4 style={{ margin: 0, color: '#CE93D8' }}>âœ¨ Cast a Spell</h4>\n          <button onClick={onClose} style={{ background: 'none', border: 'none', color: '#888', cursor: 'pointer', fontSize: '18px' }}>âœ•</button>\n        </div>\n\n        {/* Active concentration indicator */}\n        {activeConc && (\n          <div style={{\n            padding: '6px 10px',\n            backgroundColor: 'rgba(156,39,176,0.15)',\n            border: '1px solid #9C27B0',\n            borderRadius: '6px',\n            marginBottom: '10px',\n            fontSize: '12px',\n            color: '#CE93D8',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '6px'\n          }}>\n            <span>ğŸ”®</span>\n            <span>Concentrating on <strong>{activeConc}</strong> â€” casting another concentration spell will end this.</span>\n          </div>\n        )}\n\n        <div style={{ fontSize: '12px', color: '#888', marginBottom: '10px' }}>\n          Spell Attack: <span style={{ color: '#CE93D8' }}>+{spellAttack}</span> &nbsp;|&nbsp;\n          Save DC: <span style={{ color: '#CE93D8' }}>{spellSaveDC}</span>\n        </div>\n\n        {/* Spell slot display */}\n        <div style={{ display: 'flex', gap: '6px', flexWrap: 'wrap', marginBottom: '12px' }}>\n          {getSpellSlots(caster).map((max, i) => {\n            if (max === 0) return null;\n            const cur = currentSlots[i] || 0;\n            return (\n              <div key={i} style={{\n                padding: '4px 8px',\n                backgroundColor: cur > 0 ? '#1a0a2e' : '#1a1a1a',\n                border: `1px solid ${cur > 0 ? spellLevelColor(i+1) : '#333'}`,\n                borderRadius: '4px',\n                fontSize: '11px',\n                color: cur > 0 ? spellLevelColor(i+1) : '#555'\n              }}>\n                L{i+1}: {cur}/{max}\n              </div>\n            );\n          })}\n        </div>\n\n        {/* Spell grid */}\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(160px, 1fr))', gap: '8px', marginBottom: '12px', maxHeight: '200px', overflowY: 'auto' }}>\n          {combatSpells.length === 0 && (\n            <div style={{ color: '#666', fontStyle: 'italic', padding: '10px', gridColumn: '1/-1' }}>\n              No combat spells available. Open SpellBook to learn spells.\n            </div>\n          )}\n          {combatSpells.map(spell => {\n            const hasSlotsOrCantrip = spell.level === 0 || (currentSlots[spell.level - 1] || 0) > 0;\n            const isSelected        = selectedSpell?.key === spell.key;\n            const isConc            = isConcentrationSpell(spell);\n            const isActiveConc      = activeConc === spell.name;\n            return (\n              <button\n                key={spell.key}\n                onClick={() => { setSelectedSpell(spell); setUpcastLevel(spell.level); setCastResult(null); }}\n                disabled={!hasSlotsOrCantrip}\n                style={{\n                  padding: '8px 10px',\n                  backgroundColor: isSelected ? '#3a0a5a' : '#1a0a2e',\n                  border: `2px solid ${isActiveConc ? '#9C27B0' : isSelected ? '#CE93D8' : hasSlotsOrCantrip ? spellLevelColor(spell.level) : '#333'}`,\n                  borderRadius: '6px',\n                  cursor: hasSlotsOrCantrip ? 'pointer' : 'not-allowed',\n                  opacity: hasSlotsOrCantrip ? 1 : 0.4,\n                  textAlign: 'left',\n                  transition: 'all 0.15s',\n                  boxShadow: isActiveConc ? '0 0 8px rgba(156,39,176,0.6)' : 'none'\n                }}\n              >\n                <div style={{ fontSize: '13px', fontWeight: 'bold', color: spellLevelColor(spell.level), marginBottom: '3px' }}>\n                  {spell.name}\n                </div>\n                <div style={{ fontSize: '10px', color: '#888' }}>\n                  {spell.level === 0 ? 'Cantrip' : `Lvl ${spell.level}`}\n                  {spell.damage && ` â€¢ ${spell.damage} ${spell.damageType}`}\n                  {spell.healing && ` â€¢ Heals ${spell.healing}`}\n                  {isConc && <span style={{ color: '#9C27B0' }}> â€¢ ğŸ”® Conc.</span>}\n                </div>\n              </button>\n            );\n          })}\n        </div>\n\n        {/* Selected spell details + upcast + cast button */}\n        {selectedSpell && (\n          <div style={{\n            backgroundColor: '#0a0018',\n            borderRadius: '8px',\n            padding: '12px',\n            border: `1px solid ${spellLevelColor(selectedSpell.level)}`\n          }}>\n            <div style={{ marginBottom: '8px' }}>\n              <span style={{ fontWeight: 'bold', color: spellLevelColor(selectedSpell.level) }}>{selectedSpell.name}</span>\n              {isConcentrationSpell(selectedSpell) && (\n                <span style={{\n                  marginLeft: '8px',\n                  fontSize: '11px',\n                  color: '#CE93D8',\n                  backgroundColor: 'rgba(156,39,176,0.2)',\n                  padding: '2px 6px',\n                  borderRadius: '4px',\n                  border: '1px solid #6A1B9A'\n                }}>ğŸ”® Concentration</span>\n              )}\n              <span style={{ color: '#888', fontSize: '12px', marginLeft: '10px' }}>{selectedSpell.castingTime} â€¢ {selectedSpell.range}</span>\n            </div>\n            <div style={{ fontSize: '13px', color: '#ccc', marginBottom: '10px' }}>{selectedSpell.description}</div>\n\n            {/* Concentration conflict warning in detail panel */}\n            {isConcentrationSpell(selectedSpell) && activeConc && activeConc !== selectedSpell.name && (\n              <div style={{\n                padding: '8px 10px',\n                backgroundColor: 'rgba(255,152,0,0.1)',\n                border: '1px solid #ff9800',\n                borderRadius: '6px',\n                marginBottom: '10px',\n                fontSize: '12px',\n                color: '#ffb74d'\n              }}>\n                âš ï¸ Casting this will drop <strong>{activeConc}</strong>\n              </div>\n            )}\n\n            {/* Upcast selector */}\n            {selectedSpell.level > 0 && selectedSpell.upcastBonus && (\n              <div style={{ marginBottom: '10px' }}>\n                <div style={{ fontSize: '11px', color: '#888', marginBottom: '6px' }}>Cast at level:</div>\n                <div style={{ display: 'flex', gap: '6px', flexWrap: 'wrap' }}>\n                  {Array.from({ length: 10 - selectedSpell.level }, (_, i) => selectedSpell.level + i).map(lvl => {\n                    const slotsLeft = currentSlots[lvl - 1] || 0;\n                    if (getSpellSlots(caster)[lvl - 1] === 0) return null;\n                    return (\n                      <button\n                        key={lvl}\n                        onClick={() => setUpcastLevel(lvl)}\n                        disabled={slotsLeft === 0}\n                        style={{\n                          padding: '4px 10px',\n                          backgroundColor: upcastLevel === lvl ? spellLevelColor(lvl) : '#1a0a2e',\n                          color: upcastLevel === lvl ? '#000' : slotsLeft > 0 ? '#eee' : '#555',\n                          border: 'none',\n                          borderRadius: '4px',\n                          cursor: slotsLeft > 0 ? 'pointer' : 'not-allowed',\n                          fontSize: '12px',\n                          opacity: slotsLeft > 0 ? 1 : 0.4\n                        }}\n                      >\n                        L{lvl} ({slotsLeft})\n                      </button>\n                    );\n                  })}\n                </div>\n              </div>\n            )}\n\n            {!selectedTarget && selectedSpell.damage && (\n              <div style={{ color: '#ff9800', fontSize: '12px', marginBottom: '8px' }}>\n                âš ï¸ Select a target enemy above before casting this spell\n              </div>\n            )}\n\n            <button\n              onClick={handleCast}\n              disabled={!!(selectedSpell.damage && !selectedTarget)}\n              style={{\n                width: '100%',\n                padding: '10px',\n                backgroundColor: (selectedSpell.damage && !selectedTarget) ? '#333' : '#7B1FA2',\n                color: 'white',\n                border: 'none',\n                borderRadius: '6px',\n                cursor: (selectedSpell.damage && !selectedTarget) ? 'not-allowed' : 'pointer',\n                fontWeight: 'bold',\n                fontSize: '15px',\n                transition: 'background 0.2s'\n              }}\n            >\n              âœ¨ Cast {selectedSpell.name}{upcastLevel && upcastLevel > selectedSpell.level ? ` (Lvl ${upcastLevel})` : ''}\n            </button>\n          </div>\n        )}\n\n        {/* Cast result */}\n        {castResult && (\n          <div style={{\n            marginTop: '10px',\n            padding: '10px',\n            backgroundColor: castResult.hit === false ? '#1a0a0a' : '#0a1a0a',\n            borderRadius: '6px',\n            border: `1px solid ${castResult.hit === false ? '#f44336' : '#4CAF50'}`,\n            fontSize: '13px',\n            color: '#eee'\n          }}>\n            {castResult.log}\n          </div>\n        )}\n      </div>\n    </>\n  );\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n//  MAIN COMBAT TRACKER\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nexport default function CombatTracker({ combat, onUpdate, onEnd, party = [], updateParty }) {\n  const [selectedTarget, setSelectedTarget] = useState(null);\n  const [combatLog,      setCombatLog]      = useState([]);\n  const [showSpellPanel, setShowSpellPanel] = useState(false);\n\n  if (!combat || !combat.isActive) return null;\n\n  const currentCombatant = getCurrentCombatant(combat);\n  const isPlayerTurn     = !currentCombatant?.isEnemy;\n\n  // Find the full party character for the current combatant (so we have spell data)\n  const partyCharacter = party.find(p => p.name === currentCombatant?.name) || currentCombatant;\n  const isSpellcaster  = SPELLCASTING_CLASSES[partyCharacter?.class];\n  const combatSpells   = isSpellcaster ? getCombatSpells(partyCharacter) : [];\n\n  const addLog = (entry, prevLog = combatLog) => {\n    setCombatLog([entry, ...prevLog]);\n    return [entry, ...prevLog];\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  Helper: clear concentration from a character\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const clearConcentration = (character, reason = '') => {\n    if (!character.concentrationSpell) return character;\n    console.log(`[Concentration] ${character.name} lost concentration on ${character.concentrationSpell}${reason ? ': ' + reason : ''}`);\n    return { ...character, concentrationSpell: null };\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  Helper: run a concentration check after taking damage\n  //  Returns { character (possibly cleared), log entry or null }\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleConcentrationCheck = (character, damageTaken) => {\n    if (!character.concentrationSpell) return { character, logEntry: null };\n    const check = rollConcentrationCheck(damageTaken);\n    if (check.passed) {\n      return {\n        character,\n        logEntry: `ğŸ”® ${character.name} passes concentration check (rolled ${check.roll} vs DC ${check.dc}) â€” still concentrating on ${character.concentrationSpell}.`\n      };\n    } else {\n      const cleared = clearConcentration(character, 'failed concentration check');\n      return {\n        character: cleared,\n        logEntry: `ğŸ’” ${character.name} FAILS concentration check (rolled ${check.roll} vs DC ${check.dc}) â€” ${character.concentrationSpell} ends!`\n      };\n    }\n  };\n\n  // â”€â”€ ATTACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleAttack = (attackIndex = 0) => {\n    if (!selectedTarget) { alert('Select a target first!'); return; }\n\n    const result = executeAttack(currentCombatant, selectedTarget, attackIndex);\n    const logEntry = result.attackRoll.isCritical\n      ? `ğŸ’¥ CRITICAL HIT! ${result.attacker} hits ${result.target} with ${result.attack} for ${result.damage} ${result.damageType} damage!`\n      : result.attackRoll.isFumble\n      ? `âŒ FUMBLE! ${result.attacker} misses ${result.target}!`\n      : result.attackRoll.isHit\n      ? `âš”ï¸ ${result.attacker} hits ${result.target} with ${result.attack} for ${result.damage} ${result.damageType} damage!`\n      : `ğŸ›¡ï¸ ${result.attacker} misses ${result.target}!`;\n\n    let newLog = addLog(logEntry);\n\n    if (result.attackRoll.isHit && result.damage > 0) {\n      const damagedTarget = applyDamage(selectedTarget, result.damage);\n      const updatedCombat = updateCombatant(combat, selectedTarget.id || selectedTarget.name, damagedTarget);\n\n      if (damagedTarget.isDead) addLog(`ğŸ’€ ${damagedTarget.name} has been defeated!`, newLog);\n      onUpdate(updatedCombat);\n\n      // Concentration check if target is a party member concentrating\n      if (updateParty) {\n        const partyTarget = party.find(p => p.name === selectedTarget.name);\n        if (partyTarget?.concentrationSpell) {\n          const { character: afterCheck, logEntry: checkLog } = handleConcentrationCheck(partyTarget, result.damage);\n          if (checkLog) addLog(checkLog);\n          const updatedParty = party.map(p => p.name === afterCheck.name ? afterCheck : p);\n          updateParty(updatedParty);\n        }\n      }\n\n      const endCheck = checkCombatEnd(updatedCombat);\n      if (endCheck.ended) { setTimeout(() => onEnd(endCheck), 1000); return; }\n    }\n\n    handleEndTurn();\n  };\n\n  // â”€â”€ SPELL RESULT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleSpellResult = (result) => {\n    setShowSpellPanel(false);\n    addLog(result.log);\n\n    let currentCombatState = { ...combat };\n\n    // 1. Update caster's spell slots (and concentration state) in the party store\n    if (updateParty && result.updatedCaster) {\n      const updatedParty = party.map(p =>\n        p.name === result.updatedCaster.name ? result.updatedCaster : p\n      );\n      updateParty(updatedParty);\n    }\n\n    // 2. Apply damage to target\n    if (result.damage > 0 && result.hit && selectedTarget) {\n      const damagedTarget = applyDamage(selectedTarget, result.damage, result.damageType);\n      currentCombatState  = updateCombatant(currentCombatState, selectedTarget.id || selectedTarget.name, damagedTarget);\n      if (damagedTarget.isDead) addLog(`ğŸ’€ ${damagedTarget.name} has been defeated!`);\n      onUpdate(currentCombatState);\n\n      // Concentration check for the damaged target if they're a party member concentrating\n      if (updateParty) {\n        const partyTarget = party.find(p => p.name === selectedTarget.name);\n        if (partyTarget?.concentrationSpell) {\n          const { character: afterCheck, logEntry: checkLog } = handleConcentrationCheck(partyTarget, result.damage);\n          if (checkLog) addLog(checkLog);\n          const updatedParty = party.map(p => p.name === afterCheck.name ? afterCheck : p);\n          updateParty(updatedParty);\n        }\n      }\n\n      const endCheck = checkCombatEnd(currentCombatState);\n      if (endCheck.ended) { setTimeout(() => onEnd(endCheck), 1000); return; }\n    }\n\n    // 3. Apply healing\n    if (result.healing > 0 && updateParty) {\n      const healedCaster = {\n        ...result.updatedCaster,\n        hp: Math.min(result.updatedCaster.maxHp, (result.updatedCaster.hp || 0) + result.healing)\n      };\n      const updatedParty = party.map(p => p.name === healedCaster.name ? healedCaster : p);\n      updateParty(updatedParty);\n    }\n\n    // 4. Apply status effect to target\n    if (result.statusApplied && selectedTarget && updateParty) {\n      const effect = createStatusEffect({\n        type: result.statusApplied.type,\n        duration: result.statusApplied.duration || 1,\n        durationType: result.statusApplied.durationType || DURATION_TYPES.ROUNDS,\n        saveDC: result.statusApplied.saveDC,\n        spellName: result.statusApplied.spellName,\n        source: result.casterName\n      });\n      if (effect) {\n        const partyTarget = party.find(p => p.name === selectedTarget.name);\n        if (partyTarget && updateParty) {\n          let withEffect = applyStatusEffect(partyTarget, effect);\n          // Auto-break concentration if a concentration-ending condition was applied\n          if (CONCENTRATION_BREAKING_CONDITIONS.has(result.statusApplied.type) && withEffect.concentrationSpell) {\n            const dropped = withEffect.concentrationSpell;\n            withEffect = clearConcentration(withEffect, `gained ${effect.name} condition`);\n            addLog(`ğŸ’” ${selectedTarget.name} loses concentration on ${dropped} (gained ${effect.name})!`);\n          }\n          const updatedParty = party.map(p => p.name === withEffect.name ? withEffect : p);\n          updateParty(updatedParty);\n          addLog(`ğŸŒ€ ${selectedTarget.name} is now ${effect.name}!`);\n        }\n      }\n    }\n\n    handleEndTurn();\n  };\n\n  // â”€â”€ END TURN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleEndTurn = () => {\n    setSelectedTarget(null);\n    setShowSpellPanel(false);\n    const newCombat = nextTurn(combat);\n    onUpdate(newCombat);\n\n    setTimeout(() => {\n      if (newCombat.combatants[newCombat.currentTurn]?.isEnemy) {\n        handleEnemyTurn(newCombat);\n      }\n    }, 500);\n  };\n\n  // â”€â”€ ENEMY TURN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleEnemyTurn = (currentCombat) => {\n    const enemy = getCurrentCombatant(currentCombat);\n    if (!enemy || enemy.isDead) { handleEndTurn(); return; }\n\n    const aliveParty = currentCombat.combatants.filter(c => !c.isEnemy && !c.isDead);\n    if (aliveParty.length === 0) return;\n\n    const target = aliveParty[Math.floor(Math.random() * aliveParty.length)];\n    const result = executeAttack(enemy, target, 0);\n\n    const logEntry = result.attackRoll.isCritical\n      ? `ğŸ’¥ CRITICAL! ${result.attacker} critically hits ${result.target} for ${result.damage} damage!`\n      : result.attackRoll.isHit\n      ? `âš”ï¸ ${result.attacker} hits ${result.target} for ${result.damage} damage!`\n      : `ğŸ›¡ï¸ ${result.attacker} misses ${result.target}!`;\n\n    addLog(logEntry);\n\n    if (result.attackRoll.isHit && result.damage > 0) {\n      const damagedTarget = applyDamage(target, result.damage);\n      let updatedCombat   = updateCombatant(currentCombat, target.id || target.name, damagedTarget);\n      if (damagedTarget.isDead) addLog(`ğŸ’€ ${damagedTarget.name} has fallen!`);\n      onUpdate(updatedCombat);\n\n      // Concentration check for attacked party member\n      if (updateParty) {\n        const partyTarget = party.find(p => p.name === target.name);\n        if (partyTarget?.concentrationSpell) {\n          const { character: afterCheck, logEntry: checkLog } = handleConcentrationCheck(partyTarget, result.damage);\n          if (checkLog) addLog(checkLog);\n          const updatedParty = party.map(p => p.name === afterCheck.name ? afterCheck : p);\n          updateParty(updatedParty);\n        }\n      }\n\n      const endCheck = checkCombatEnd(updatedCombat);\n      if (endCheck.ended) { setTimeout(() => onEnd(endCheck), 1000); return; }\n    }\n\n    setTimeout(() => handleEndTurn(), 1500);\n  };\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  //  RENDER\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  return (\n    <div style={{\n      position: 'fixed',\n      bottom: 0,\n      left: 0,\n      right: 0,\n      backgroundColor: '#120808',\n      border: '3px solid #d32f2f',\n      borderBottom: 'none',\n      padding: '20px',\n      maxHeight: '65vh',\n      overflowY: 'auto',\n      zIndex: 1000,\n      boxShadow: '0 -4px 20px rgba(211,47,47,0.4)'\n    }}>\n      {/* Header row */}\n      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '15px', paddingBottom: '15px', borderBottom: '2px solid #2a2a2a' }}>\n        <h2 style={{ margin: 0, color: '#d32f2f', fontSize: '24px' }}>\n          âš”ï¸ Combat â€” Round {combat.round}\n        </h2>\n        <button\n          onClick={() => onEnd({ ended: true, result: 'flee', message: 'Combat ended' })}\n          style={{ padding: '8px 16px', backgroundColor: '#333', color: '#aaa', border: '1px solid #555', borderRadius: '5px', cursor: 'pointer' }}\n        >\n          End Combat\n        </button>\n      </div>\n\n      {/* Initiative track */}\n      <div style={{ display: 'flex', gap: '10px', marginBottom: '15px', overflowX: 'auto', paddingBottom: '10px' }}>\n        {combat.combatants.map((combatant, index) => {\n          // Find this combatant's party entry to check concentration\n          const partyEntry  = party.find(p => p.name === combatant.name);\n          const isConcentrating = partyEntry?.concentrationSpell;\n          const isActive    = index === combat.currentTurn;\n\n          return (\n            <div\n              key={combatant.id || combatant.name}\n              style={{\n                minWidth: '120px',\n                padding: '10px',\n                backgroundColor: isActive ? '#2a0000' : '#1a1a1a',\n                border: isActive ? '2px solid #ffd700' : '2px solid #333',\n                borderRadius: '8px',\n                opacity: combatant.isDead ? 0.3 : 1,\n                position: 'relative',\n                flexShrink: 0,\n                // Purple glow for concentrating characters\n                boxShadow: isConcentrating ? '0 0 12px rgba(156,39,176,0.7), inset 0 0 8px rgba(156,39,176,0.2)' : 'none'\n              }}\n            >\n              {isActive && (\n                <div style={{ position: 'absolute', top: '-18px', left: '50%', transform: 'translateX(-50%)', fontSize: '18px' }}>â¬‡ï¸</div>\n              )}\n              <div style={{ fontSize: '11px', color: combatant.isEnemy ? '#ff6b6b' : '#4CAF50', marginBottom: '4px' }}>\n                {combatant.isEnemy ? 'ğŸ‘¹' : 'ğŸ›¡ï¸'} Init: {combatant.initiative}\n              </div>\n              <div style={{ fontWeight: 'bold', fontSize: '13px', marginBottom: '4px', whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>\n                {combatant.name}\n              </div>\n              <div style={{ fontSize: '11px', color: '#888' }}>\n                {combatant.hp}/{combatant.maxHp} HP\n              </div>\n              <div style={{ width: '100%', height: '5px', backgroundColor: '#0a0a0a', borderRadius: '3px', marginTop: '5px', overflow: 'hidden' }}>\n                <div style={{\n                  width: `${Math.max(0, (combatant.hp / combatant.maxHp) * 100)}%`,\n                  height: '100%',\n                  backgroundColor: combatant.hp > combatant.maxHp * 0.5 ? '#4CAF50' : combatant.hp > combatant.maxHp * 0.25 ? '#ff9800' : '#f44336',\n                  transition: 'width 0.3s'\n                }} />\n              </div>\n\n              {/* Concentration indicator */}\n              {isConcentrating && (\n                <div style={{\n                  marginTop: '5px',\n                  fontSize: '10px',\n                  color: '#CE93D8',\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: '3px'\n                }}>\n                  <span>ğŸ”®</span>\n                  <span style={{ overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap', maxWidth: '85px' }}>\n                    {isConcentrating}\n                  </span>\n                </div>\n              )}\n\n              {/* Status effect icons */}\n              {(combatant.conditions?.length > 0) && (\n                <div style={{ marginTop: '4px', fontSize: '12px', display: 'flex', gap: '2px', flexWrap: 'wrap' }}>\n                  {combatant.conditions.slice(0, 3).map(c => (\n                    <span key={c.id} title={c.name}>{c.icon}</span>\n                  ))}\n                  {combatant.conditions.length > 3 && <span style={{ color: '#888' }}>+{combatant.conditions.length - 3}</span>}\n                </div>\n              )}\n\n              {combatant.isDead && (\n                <div style={{ position: 'absolute', inset: 0, display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '36px', backgroundColor: 'rgba(0,0,0,0.5)', borderRadius: '8px' }}>ğŸ’€</div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n\n      {/* Combat Log */}\n      <div style={{ backgroundColor: '#0a0a0a', padding: '10px', borderRadius: '8px', marginBottom: '15px', maxHeight: '100px', overflowY: 'auto', border: '1px solid #222' }}>\n        {combatLog.length === 0\n          ? <p style={{ margin: 0, color: '#444', fontStyle: 'italic', fontSize: '13px' }}>Combat beginsâ€¦</p>\n          : combatLog.map((log, i) => (\n            <div key={i} style={{ padding: '3px 5px', color: i === 0 ? '#eee' : '#777', fontSize: '13px', borderBottom: i < combatLog.length - 1 ? '1px solid #111' : 'none' }}>\n              {log}\n            </div>\n          ))\n        }\n      </div>\n\n      {/* Action Panel */}\n      <div style={{ backgroundColor: '#1a1a1a', padding: '15px', borderRadius: '8px', border: '2px solid #333' }}>\n        <h3 style={{ margin: '0 0 12px 0', color: '#ffd700', fontSize: '16px' }}>\n          {currentCombatant?.name}'s Turn\n          {isPlayerTurn && isSpellcaster && (\n            <span style={{ marginLeft: '10px', fontSize: '12px', color: '#CE93D8' }}>âœ¨ Spellcaster</span>\n          )}\n          {isPlayerTurn && partyCharacter?.concentrationSpell && (\n            <span style={{\n              marginLeft: '10px',\n              fontSize: '11px',\n              color: '#CE93D8',\n              backgroundColor: 'rgba(156,39,176,0.2)',\n              padding: '2px 8px',\n              borderRadius: '10px',\n              border: '1px solid #6A1B9A'\n            }}>\n              ğŸ”® {partyCharacter.concentrationSpell}\n            </span>\n          )}\n        </h3>\n\n        {isPlayerTurn && !currentCombatant?.isDead && (\n          <div>\n            {/* Target Selection */}\n            <div style={{ marginBottom: '12px' }}>\n              <div style={{ fontSize: '12px', color: '#888', marginBottom: '6px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>\n                Select Target\n              </div>\n              <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>\n                {combat.combatants.filter(c => c.isEnemy && !c.isDead).map(enemy => (\n                  <button\n                    key={enemy.id || enemy.name}\n                    onClick={() => setSelectedTarget(enemy)}\n                    style={{\n                      padding: '8px 14px',\n                      backgroundColor: selectedTarget?.name === enemy.name ? '#3a0000' : '#2a1010',\n                      color: selectedTarget?.name === enemy.name ? '#ff6b6b' : '#ccc',\n                      border: `2px solid ${selectedTarget?.name === enemy.name ? '#d32f2f' : '#333'}`,\n                      borderRadius: '6px',\n                      cursor: 'pointer',\n                      fontSize: '13px',\n                      transition: 'all 0.15s'\n                    }}\n                  >\n                    ğŸ‘¹ {enemy.name}\n                    <span style={{ color: '#666', marginLeft: '6px', fontSize: '11px' }}>\n                      {enemy.hp}/{enemy.maxHp} HP\n                    </span>\n                  </button>\n                ))}\n                {combat.combatants.filter(c => c.isEnemy && !c.isDead).length === 0 && (\n                  <span style={{ color: '#888', fontStyle: 'italic', fontSize: '13px' }}>No living enemies</span>\n                )}\n              </div>\n            </div>\n\n            {/* Action Buttons Row */}\n            <div style={{ display: 'flex', gap: '10px', flexWrap: 'wrap', marginBottom: '10px', alignItems: 'flex-start' }}>\n              {/* Attack buttons */}\n              {currentCombatant.attacks?.map((attack, index) => (\n                <button\n                  key={index}\n                  onClick={() => handleAttack(index)}\n                  disabled={!selectedTarget}\n                  style={{\n                    padding: '10px 18px',\n                    backgroundColor: selectedTarget ? '#1a3a1a' : '#1a1a1a',\n                    color: selectedTarget ? '#4CAF50' : '#555',\n                    border: `2px solid ${selectedTarget ? '#4CAF50' : '#333'}`,\n                    borderRadius: '8px',\n                    cursor: selectedTarget ? 'pointer' : 'not-allowed',\n                    fontSize: '14px',\n                    fontWeight: 'bold',\n                    transition: 'all 0.15s'\n                  }}\n                >\n                  âš”ï¸ {attack.name}\n                  <span style={{ display: 'block', fontSize: '10px', color: selectedTarget ? '#81C784' : '#444', fontWeight: 'normal' }}>\n                    +{attack.bonus} to hit â€¢ {attack.damage}\n                  </span>\n                </button>\n              ))}\n\n              {/* Cast Spell button */}\n              {isSpellcaster && (\n                <button\n                  onClick={() => setShowSpellPanel(p => !p)}\n                  style={{\n                    padding: '10px 18px',\n                    backgroundColor: showSpellPanel ? '#2a0a3a' : '#1a0a2a',\n                    color: showSpellPanel ? '#CE93D8' : '#9C27B0',\n                    border: `2px solid ${showSpellPanel ? '#CE93D8' : '#6A1B9A'}`,\n                    borderRadius: '8px',\n                    cursor: 'pointer',\n                    fontSize: '14px',\n                    fontWeight: 'bold',\n                    transition: 'all 0.15s',\n                    position: 'relative'\n                  }}\n                >\n                  âœ¨ Cast Spell\n                  <span style={{ display: 'block', fontSize: '10px', color: '#888', fontWeight: 'normal' }}>\n                    {combatSpells.length} available\n                  </span>\n                  {partyCharacter?.concentrationSpell && (\n                    <span style={{\n                      position: 'absolute',\n                      top: '-8px',\n                      right: '-8px',\n                      width: '16px',\n                      height: '16px',\n                      backgroundColor: '#9C27B0',\n                      borderRadius: '50%',\n                      fontSize: '10px',\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center'\n                    }}>ğŸ”®</span>\n                  )}\n                </button>\n              )}\n\n              {/* End Turn */}\n              <button\n                onClick={handleEndTurn}\n                style={{\n                  padding: '10px 18px',\n                  backgroundColor: '#1a1a1a',\n                  color: '#888',\n                  border: '2px solid #333',\n                  borderRadius: '8px',\n                  cursor: 'pointer',\n                  fontSize: '14px',\n                  marginLeft: 'auto',\n                  transition: 'all 0.15s'\n                }}\n              >\n                End Turn â†’\n              </button>\n            </div>\n\n            {/* Spell Panel */}\n            {showSpellPanel && isSpellcaster && (\n              <SpellCastPanel\n                caster={partyCharacter}\n                combatSpells={combatSpells}\n                selectedTarget={selectedTarget}\n                onSpellResult={handleSpellResult}\n                onClose={() => setShowSpellPanel(false)}\n              />\n            )}\n          </div>\n        )}\n\n        {!isPlayerTurn && (\n          <p style={{ margin: 0, color: '#ff6b6b', fontStyle: 'italic', fontSize: '14px' }}>\n            âš”ï¸ Enemy is actingâ€¦\n          </p>\n        )}\n\n        {currentCombatant?.isDead && (\n          <p style={{ margin: 0, color: '#555', fontSize: '14px' }}>\n            This combatant has been defeated. Advance the turn.\n          </p>\n        )}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}