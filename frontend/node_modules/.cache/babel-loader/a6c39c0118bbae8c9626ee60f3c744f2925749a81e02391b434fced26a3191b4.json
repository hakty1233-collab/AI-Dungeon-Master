{"ast":null,"code":"// frontend/src/state/campaignStore.js\nimport { create } from \"zustand\";\nimport { createQuest, detectQuestEvents, completeQuest, updateQuestObjective, addQuestNote, QUEST_STATUS } from \"../utils/questSystem\";\nexport const useCampaignStore = create(set => ({\n  campaign: null,\n  party: [],\n  lastResponse: \"\",\n  // â­ QUEST TRACKER\n  quests: [],\n  // ðŸª ACTIVE MERCHANT (null when no shop is open)\n  activeMerchant: null,\n  // ðŸ§  MEMORY LAYERS\n  worldMemory: [],\n  combatState: null,\n  voiceMode: true,\n  soundEffectsEnabled: true,\n  micListening: false,\n  // ðŸš€ START / LOAD CAMPAIGN\n  setCampaign: campaign => {\n    var _campaign$history, _campaign$history2, _campaign$history2$sl;\n    return set({\n      campaign: {\n        ...campaign,\n        history: (_campaign$history = campaign.history) !== null && _campaign$history !== void 0 && _campaign$history.length ? campaign.history : [{\n          role: \"assistant\",\n          content: \"The air grows still as your adventure begins...\"\n        }]\n      },\n      party: campaign.party || [],\n      lastResponse: ((_campaign$history2 = campaign.history) === null || _campaign$history2 === void 0 ? void 0 : (_campaign$history2$sl = _campaign$history2.slice(-1)[0]) === null || _campaign$history2$sl === void 0 ? void 0 : _campaign$history2$sl.content) || \"\",\n      worldMemory: campaign.worldMemory || [],\n      combatState: campaign.combatState || null,\n      quests: campaign.quests || [],\n      activeMerchant: null\n    });\n  },\n  // ðŸ‘¥ UPDATE PARTY\n  updateParty: updatedParty => set(state => ({\n    party: updatedParty,\n    campaign: state.campaign ? {\n      ...state.campaign,\n      party: updatedParty\n    } : null\n  })),\n  // ðŸŽ­ DM RESPONSE UPDATE\n  updateFromDM: ({\n    aiResponse,\n    campaignState\n  }) => set(state => {\n    var _state$campaign;\n    return {\n      campaign: {\n        ...campaignState,\n        history: [...(((_state$campaign = state.campaign) === null || _state$campaign === void 0 ? void 0 : _state$campaign.history) || []), {\n          role: \"assistant\",\n          content: aiResponse\n        }]\n      },\n      lastResponse: aiResponse,\n      party: campaignState.party || state.party,\n      worldMemory: campaignState.worldMemory !== undefined ? campaignState.worldMemory : state.worldMemory,\n      combatState: campaignState.combatState !== undefined ? campaignState.combatState : state.combatState,\n      quests: campaignState.quests !== undefined ? campaignState.quests : state.quests\n    };\n  }),\n  // ðŸ§ PLAYER ACTION\n  addPlayerMessage: text => set(state => {\n    var _state$campaign2;\n    return {\n      campaign: {\n        ...state.campaign,\n        history: [...(((_state$campaign2 = state.campaign) === null || _state$campaign2 === void 0 ? void 0 : _state$campaign2.history) || []), {\n          role: \"user\",\n          content: text\n        }]\n      }\n    };\n  }),\n  // ðŸŽ² DICE ROLLS\n  addDiceRoll: roll => set(state => {\n    var _state$campaign3;\n    return {\n      campaign: {\n        ...state.campaign,\n        history: [...(((_state$campaign3 = state.campaign) === null || _state$campaign3 === void 0 ? void 0 : _state$campaign3.history) || []), {\n          role: \"system\",\n          content: `ðŸŽ² Rolled d${roll.sides}: ${roll.result}`\n        }]\n      }\n    };\n  }),\n  // â­ QUEST MANAGEMENT\n  addQuest: questData => set(state => ({\n    quests: [...state.quests, createQuest(questData)]\n  })),\n  updateQuest: (questId, updates) => set(state => ({\n    quests: state.quests.map(q => q.id === questId ? {\n      ...q,\n      ...updates\n    } : q)\n  })),\n  completeQuestById: questId => set(state => ({\n    quests: state.quests.map(q => q.id === questId ? completeQuest(q) : q)\n  })),\n  addQuestNoteById: (questId, note) => set(state => ({\n    quests: state.quests.map(q => q.id === questId ? addQuestNote(q, note) : q)\n  })),\n  // ðŸª MERCHANT MANAGEMENT\n  setActiveMerchant: merchant => set({\n    activeMerchant: merchant\n  }),\n  updateActiveMerchant: merchant => set({\n    activeMerchant: merchant\n  }),\n  clearActiveMerchant: () => set({\n    activeMerchant: null\n  }),\n  // ðŸŽ¤ VOICE CONTROLS\n  toggleMic: () => set(s => ({\n    micListening: !s.micListening\n  })),\n  toggleVoice: () => set(s => ({\n    voiceMode: !s.voiceMode\n  })),\n  toggleSoundEffects: () => set(s => ({\n    soundEffectsEnabled: !s.soundEffectsEnabled\n  }))\n}));","map":{"version":3,"names":["create","createQuest","detectQuestEvents","completeQuest","updateQuestObjective","addQuestNote","QUEST_STATUS","useCampaignStore","set","campaign","party","lastResponse","quests","activeMerchant","worldMemory","combatState","voiceMode","soundEffectsEnabled","micListening","setCampaign","_campaign$history","_campaign$history2","_campaign$history2$sl","history","length","role","content","slice","updateParty","updatedParty","state","updateFromDM","aiResponse","campaignState","_state$campaign","undefined","addPlayerMessage","text","_state$campaign2","addDiceRoll","roll","_state$campaign3","sides","result","addQuest","questData","updateQuest","questId","updates","map","q","id","completeQuestById","addQuestNoteById","note","setActiveMerchant","merchant","updateActiveMerchant","clearActiveMerchant","toggleMic","s","toggleVoice","toggleSoundEffects"],"sources":["C:/Users/Hakty/Desktop/AI-Dungeon-Master/frontend/src/state/campaignStore.js"],"sourcesContent":["// frontend/src/state/campaignStore.js\nimport { create } from \"zustand\";\n\nimport { \n  createQuest, \n  detectQuestEvents, \n  completeQuest,\n  updateQuestObjective,\n  addQuestNote,\n  QUEST_STATUS \n} from \"../utils/questSystem\";\n\nexport const useCampaignStore = create((set) => ({\n  campaign: null,\n  party: [],\n  lastResponse: \"\",\n\n  // â­ QUEST TRACKER\n  quests: [],\n\n  // ðŸª ACTIVE MERCHANT (null when no shop is open)\n  activeMerchant: null,\n\n  // ðŸ§  MEMORY LAYERS\n  worldMemory: [],\n  combatState: null,\n\n  voiceMode: true,\n  soundEffectsEnabled: true,\n  micListening: false,\n\n  // ðŸš€ START / LOAD CAMPAIGN\n  setCampaign: (campaign) =>\n    set({\n      campaign: {\n        ...campaign,\n        history: campaign.history?.length\n          ? campaign.history\n          : [{ role: \"assistant\", content: \"The air grows still as your adventure begins...\" }],\n      },\n      party: campaign.party || [],\n      lastResponse: campaign.history?.slice(-1)[0]?.content || \"\",\n      worldMemory: campaign.worldMemory || [],\n      combatState: campaign.combatState || null,\n      quests: campaign.quests || [],\n      activeMerchant: null,\n    }),\n\n  // ðŸ‘¥ UPDATE PARTY\n  updateParty: (updatedParty) =>\n    set((state) => ({\n      party: updatedParty,\n      campaign: state.campaign ? { ...state.campaign, party: updatedParty } : null,\n    })),\n\n  // ðŸŽ­ DM RESPONSE UPDATE\n  updateFromDM: ({ aiResponse, campaignState }) =>\n    set((state) => ({\n      campaign: {\n        ...campaignState,\n        history: [\n          ...(state.campaign?.history || []),\n          { role: \"assistant\", content: aiResponse },\n        ],\n      },\n      lastResponse: aiResponse,\n      party: campaignState.party || state.party,\n      worldMemory: campaignState.worldMemory !== undefined ? campaignState.worldMemory : state.worldMemory,\n      combatState: campaignState.combatState !== undefined ? campaignState.combatState : state.combatState,\n      quests: campaignState.quests !== undefined ? campaignState.quests : state.quests,\n    })),\n\n  // ðŸ§ PLAYER ACTION\n  addPlayerMessage: (text) =>\n    set((state) => ({\n      campaign: {\n        ...state.campaign,\n        history: [\n          ...(state.campaign?.history || []),\n          { role: \"user\", content: text },\n        ],\n      },\n    })),\n\n  // ðŸŽ² DICE ROLLS\n  addDiceRoll: (roll) =>\n    set((state) => ({\n      campaign: {\n        ...state.campaign,\n        history: [\n          ...(state.campaign?.history || []),\n          { role: \"system\", content: `ðŸŽ² Rolled d${roll.sides}: ${roll.result}` },\n        ],\n      },\n    })),\n\n  // â­ QUEST MANAGEMENT\n  addQuest: (questData) =>\n    set((state) => ({\n      quests: [...state.quests, createQuest(questData)],\n    })),\n\n  updateQuest: (questId, updates) =>\n    set((state) => ({\n      quests: state.quests.map((q) => q.id === questId ? { ...q, ...updates } : q),\n    })),\n\n  completeQuestById: (questId) =>\n    set((state) => ({\n      quests: state.quests.map((q) => q.id === questId ? completeQuest(q) : q),\n    })),\n\n  addQuestNoteById: (questId, note) =>\n    set((state) => ({\n      quests: state.quests.map((q) => q.id === questId ? addQuestNote(q, note) : q),\n    })),\n\n  // ðŸª MERCHANT MANAGEMENT\n  setActiveMerchant: (merchant) =>\n    set({ activeMerchant: merchant }),\n\n  updateActiveMerchant: (merchant) =>\n    set({ activeMerchant: merchant }),\n\n  clearActiveMerchant: () =>\n    set({ activeMerchant: null }),\n\n  // ðŸŽ¤ VOICE CONTROLS\n  toggleMic: () => set((s) => ({ micListening: !s.micListening })),\n  toggleVoice: () => set((s) => ({ voiceMode: !s.voiceMode })),\n  toggleSoundEffects: () => set((s) => ({ soundEffectsEnabled: !s.soundEffectsEnabled })),\n}));"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}